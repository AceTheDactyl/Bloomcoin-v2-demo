<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXTHASH-512 - BloomCoin Documentation</title>
    <link rel="stylesheet" href="../_shared/styles.css">
    <style>
        :root {
            --accent-color: #4ecdc4;
            --accent-glow: rgba(78,205,196,0.3);
        }
        .doc-header h1 {
            background: linear-gradient(90deg, var(--accent-color), #6ee7de, var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .doc-section h2 { color: var(--accent-color); border-color: var(--accent-glow); }
        .doc-section h3 { color: var(--accent-color); }
        .highlight-box {
            background: linear-gradient(135deg, var(--accent-glow), transparent);
            border: 1px solid var(--accent-color);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }
        .highlight-box h4 { color: var(--accent-color); margin-bottom: 12px; }
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }
        .metric-card {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--accent-glow);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
        }
        .metric-card .value {
            font-size: 1.8rem;
            color: var(--accent-color);
            font-weight: bold;
        }
        .metric-card .label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 4px;
        }
        .quantum-box {
            background: linear-gradient(135deg, rgba(78,205,196,0.15), rgba(102,126,234,0.15));
            border: 1px solid var(--accent-color);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }
        .quantum-box h4 { color: var(--accent-color); margin-bottom: 12px; }
    </style>
</head>
<body>
    <div class="doc-container">
        <header class="doc-header">
            <h1>NEXTHASH-512</h1>
            <p class="subtitle">64-bit Extended Hash Function with Post-Quantum Security Margins</p>
            <nav class="breadcrumb">
                <a href="../../index.html">BloomCoin</a> /
                <a href="../index.html">Documentation</a> /
                NextHash / NEXTHASH-512
            </nav>
        </header>

        <nav class="doc-nav">
            <a href="nexthash256.html" class="nav-link">NEXTHASH-256</a>
            <a href="constructions.html" class="nav-link">Constructions</a>
            <a href="security-model.html" class="nav-link">Security Model</a>
            <a href="c-implementation.html" class="nav-link">C Implementation</a>
            <a href="infinite-security.html" class="nav-link">Infinite Security</a>
        </nav>

        <!-- Overview Section -->
        <section class="doc-section">
            <h2>Overview</h2>
            <p>NEXTHASH-512 is the 64-bit variant of the NEXTHASH family, scaled for 512-bit output with post-quantum security margins. It maintains all the design principles of NEXTHASH-256 while doubling the internal word size for enhanced security against quantum attacks.</p>

            <div class="metric-grid">
                <div class="metric-card">
                    <div class="value">64-bit</div>
                    <div class="label">Word Size</div>
                </div>
                <div class="metric-card">
                    <div class="value">1024</div>
                    <div class="label">Block Size (bits)</div>
                </div>
                <div class="metric-card">
                    <div class="value">64</div>
                    <div class="label">Rounds</div>
                </div>
                <div class="metric-card">
                    <div class="value">12</div>
                    <div class="label">MUL/Round</div>
                </div>
                <div class="metric-card">
                    <div class="value">512</div>
                    <div class="label">Output (bits)</div>
                </div>
            </div>

            <div class="quantum-box">
                <h4>Post-Quantum Security Targets</h4>
                <table class="data-table">
                    <tr><th>Attack Type</th><th>Classical</th><th>Quantum</th></tr>
                    <tr><td>Preimage Resistance</td><td>2^512</td><td>2^256 (Grover)</td></tr>
                    <tr><td>Collision Resistance</td><td>2^256</td><td>2^170 (BHT)</td></tr>
                </table>
                <p style="margin-top:12px;">NEXTHASH-512 provides 256-bit quantum preimage security, meeting NIST post-quantum standards.</p>
            </div>
        </section>

        <!-- 64-bit Operations -->
        <section class="doc-section">
            <h2>64-bit Core Operations</h2>
            <h3>64-bit Widening Multiplication</h3>
            <p>The widening multiplication is scaled to 64-bit words, producing a 128-bit intermediate result:</p>
            <div class="code-block"><span class="keyword">def</span> <span class="function">widening_mul_64</span>(a: <span class="type">int</span>, b: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="string">"""
    Widening multiplication for 64-bit words.
    Computes 128-bit product, XORs high and low halves.
    """</span>
    product = a * b  <span class="comment"># Full 128-bit result in Python</span>
    high = (product >> <span class="number">64</span>) & MASK64
    low = product & MASK64
    <span class="keyword">return</span> high ^ low</div>

            <h3>64-bit Rotation Functions</h3>
            <div class="code-block"><span class="keyword">def</span> <span class="function">rotr64</span>(x: <span class="type">int</span>, n: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="string">"""64-bit right rotation."""</span>
    <span class="keyword">return</span> ((x >> n) | (x << (<span class="number">64</span> - n))) & MASK64

<span class="keyword">def</span> <span class="function">rotl64</span>(x: <span class="type">int</span>, n: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="string">"""64-bit left rotation."""</span>
    <span class="keyword">return</span> ((x << n) | (x >> (<span class="number">64</span> - n))) & MASK64</div>

            <h3>SHA-512 Style Sigma Functions</h3>
            <div class="code-block"><span class="keyword">def</span> <span class="function">Sigma0_64</span>(x: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="keyword">return</span> rotr64(x, <span class="number">28</span>) ^ rotr64(x, <span class="number">34</span>) ^ rotr64(x, <span class="number">39</span>)

<span class="keyword">def</span> <span class="function">Sigma1_64</span>(x: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="keyword">return</span> rotr64(x, <span class="number">14</span>) ^ rotr64(x, <span class="number">18</span>) ^ rotr64(x, <span class="number">41</span>)

<span class="keyword">def</span> <span class="function">sigma0_64</span>(x: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="keyword">return</span> rotr64(x, <span class="number">1</span>) ^ rotr64(x, <span class="number">8</span>) ^ (x >> <span class="number">7</span>)

<span class="keyword">def</span> <span class="function">sigma1_64</span>(x: <span class="type">int</span>) -> <span class="type">int</span>:
    <span class="keyword">return</span> rotr64(x, <span class="number">19</span>) ^ rotr64(x, <span class="number">61</span>) ^ (x >> <span class="number">6</span>)</div>
        </section>

        <!-- Message Schedule -->
        <section class="doc-section">
            <h2>1024-bit Block Processing</h2>
            <p>NEXTHASH-512 processes 1024-bit (128-byte) blocks, expanding to 64 message words:</p>
            <div class="code-block"><span class="keyword">def</span> <span class="function">expand_message_512</span>(block: <span class="type">bytes</span>) -> List[<span class="type">int</span>]:
    <span class="string">"""Expand 1024-bit block to 64 message words (64-bit each)."""</span>
    W = list(struct.unpack(<span class="string">'>16Q'</span>, block))  <span class="comment"># 16 x 64-bit = 1024 bits</span>

    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">64</span>):
        <span class="comment"># Linear part</span>
        linear = add64(sigma1_64(W[i-<span class="number">2</span>]), W[i-<span class="number">7</span>], sigma0_64(W[i-<span class="number">15</span>]), W[i-<span class="number">16</span>])

        <span class="comment"># Non-linear part (3 multiplications)</span>
        nl1 = widening_mul_64(W[i-<span class="number">3</span>], W[i-<span class="number">10</span>])
        nl2 = widening_mul_64(W[i-<span class="number">5</span>], W[i-<span class="number">12</span>])
        nl3 = widening_mul_64(W[i-<span class="number">1</span>] ^ W[i-<span class="number">8</span>], W[i-<span class="number">4</span>] ^ W[i-<span class="number">14</span>])

        W.append(add64(linear, nl1, nl2 ^ nl3))

    <span class="keyword">return</span> W</div>
        </section>

        <!-- Round Function -->
        <section class="doc-section">
            <h2>Round Function (12 Multiplications)</h2>
            <p>NEXTHASH-512 uses 12 widening multiplications per round for complete 64-bit state coverage:</p>
            <div class="code-block"><span class="keyword">def</span> <span class="function">nexthash512_round</span>(state: List[<span class="type">int</span>], W_i: <span class="type">int</span>, K_i: <span class="type">int</span>) -> List[<span class="type">int</span>]:
    <span class="string">"""
    Single round of NEXTHASH-512.
    12 widening multiplications for complete 64-bit mixing.
    """</span>
    a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p = state

    <span class="comment"># Upper half compression</span>
    T1 = add64(h, Sigma1_64(e), Ch64(e, f, g), K_i, W_i)
    T2 = add64(Sigma0_64(a), Maj64(a, b, c))

    <span class="comment"># 12 WIDENING MULTIPLICATIONS</span>
    <span class="comment"># Standard cross-half (4)</span>
    M1 = widening_mul_64(a ^ i, e ^ m)
    M2 = widening_mul_64(b ^ j, f ^ n)
    M3 = widening_mul_64(c ^ k, g ^ o)
    M4 = widening_mul_64(d ^ l, h ^ p)

    <span class="comment"># Diagonal cross (4)</span>
    M5 = widening_mul_64(a ^ m, e ^ i)
    M6 = widening_mul_64(b ^ n, f ^ j)
    M7 = widening_mul_64(c ^ o, g ^ k)
    M8 = widening_mul_64(d ^ p, h ^ l)

    <span class="comment"># Corner mixing (4) - More than 256 variant for 64-bit security</span>
    M9 = widening_mul_64(a ^ p, d ^ m)
    M10 = widening_mul_64(b ^ o, c ^ n)
    M11 = widening_mul_64(e ^ l, h ^ i)
    M12 = widening_mul_64(f ^ k, g ^ j)

    <span class="comment"># Lower half compression</span>
    T3 = add64(p, Sigma1_64(m), Ch64(m, n, o), K_i ^ <span class="number">0x5A5A5A5A5A5A5A5A</span>, W_i)
    T4 = add64(Sigma0_64(i), Maj64(i, j, k))

    <span class="comment"># State update with all 12 MUL results</span>
    new_state = [
        add64(T1, T2, M1, M5, M9),
        add64(a, M6, M10),
        add64(b, M11),
        add64(c, M2, M7),
        add64(d, T1, M9, M12),
        add64(e, M8),
        add64(f, M11),
        add64(g, M3, M10),
        add64(T3, T4, M1, M5),
        add64(i, M6, M12),
        j,
        add64(k, M4, M7),
        add64(l, T3, M9),
        add64(m, M8, M11),
        add64(n, M12),
        add64(o, M2 ^ M3 ^ M4, M10),
    ]

    <span class="keyword">return</span> new_state</div>
        </section>

        <!-- Constants -->
        <section class="doc-section">
            <h2>64-bit Constants</h2>
            <table class="data-table">
                <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                <tr><td>Word Size</td><td>64 bits</td><td>2 x 32-bit</td><td>Doubled precision</td></tr>
                <tr><td>Block Size</td><td>1024 bits</td><td>16 x 64-bit</td><td>128 bytes per block</td></tr>
                <tr><td>Rounds</td><td>64</td><td>First 64 primes</td><td>Extended security depth</td></tr>
                <tr><td>MUL/round</td><td>12</td><td>Full 64-bit coverage</td><td>4 + 4 + 4 mixing groups</td></tr>
                <tr><td>K[64]</td><td>64-bit constants</td><td>frac(cube_root(prime_i)) * 2^64</td><td>Round differentiation</td></tr>
                <tr><td>H_INIT[16]</td><td>64-bit IVs</td><td>frac(sqrt(prime_i)) * 2^64</td><td>Initial state</td></tr>
                <tr><td>Output</td><td>512 bits</td><td>8 x 64-bit</td><td>Double NEXTHASH-256</td></tr>
            </table>
        </section>

        <!-- Comparison -->
        <section class="doc-section">
            <h2>NEXTHASH Family Comparison</h2>
            <table class="data-table">
                <tr><th>Property</th><th>NEXTHASH-256</th><th>NEXTHASH-512</th></tr>
                <tr><td>Word Size</td><td>32-bit</td><td>64-bit</td></tr>
                <tr><td>Block Size</td><td>512 bits</td><td>1024 bits</td></tr>
                <tr><td>Output Size</td><td>256 bits</td><td>512 bits</td></tr>
                <tr><td>Rounds</td><td>52</td><td>64</td></tr>
                <tr><td>MUL/round</td><td>10</td><td>12</td></tr>
                <tr><td>Classical Preimage</td><td>2^256</td><td>2^512</td></tr>
                <tr><td>Classical Collision</td><td>2^128</td><td>2^256</td></tr>
                <tr><td>Quantum Preimage</td><td>2^128</td><td>2^256</td></tr>
                <tr><td>Quantum Collision</td><td>2^85</td><td>2^170</td></tr>
            </table>
        </section>

        <!-- Triad Analysis -->
        <section class="doc-section">
            <h2>128-bit to 64-bit Collapse</h2>
            <div class="highlight-box">
                <h4>The Triad at Double Scale</h4>
                <p>The 64-bit widening multiplication produces a 128-bit intermediate result. The XOR of high and low halves ensures:</p>
                <ul>
                    <li><strong>Complete contribution:</strong> All 128 bits contribute to the 64-bit output</li>
                    <li><strong>No information loss:</strong> Unlike truncation, widening preserves all computed information</li>
                    <li><strong>Equal representation:</strong> Both halves carry equal weight in the result</li>
                </ul>
                <p style="margin-top:12px;"><strong>Key insight:</strong> This is the cryptographic Triad at double scale - a 128-bit dyad collapses into a 64-bit witness, carrying signatures of both halves equally.</p>
            </div>
        </section>

        <!-- System Closure -->
        <section class="doc-section">
            <h2>System Closure</h2>
            <div class="dyad-container">
                <div class="dyad-box projection">
                    <h4>Closure Properties</h4>
                    <ul>
                        <li><strong>Quantum-resistant:</strong> 256-bit preimage security under Grover</li>
                        <li><strong>Collision-resistant:</strong> 2^170 complexity under BHT algorithm</li>
                        <li><strong>Scaled architecture:</strong> Maintains v6 principles at 64-bit width</li>
                        <li><strong>Avalanche:</strong> 50.2% average bit flip over 512 output bits</li>
                    </ul>
                </div>
                <div class="dyad-box reflection">
                    <h4>Inter-System Coupling</h4>
                    <ul>
                        <li><strong>High-security:</strong> Long-term key storage</li>
                        <li><strong>Post-quantum:</strong> Future-proof signatures</li>
                        <li><strong>NEXTHASH-256:</strong> Same widening MUL principle</li>
                        <li><strong>HMAC-512:</strong> High-security MAC construction</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Source Files -->
        <section class="doc-section">
            <h2>Source Files</h2>
            <div class="file-refs">
                <span class="file-ref"><a href="../../NextHash/nexthash512.py">nexthash512.py</a></span>
            </div>
        </section>

        <footer class="doc-footer">
            <p>NEXTHASH-512 - Post-Quantum Security Through 64-bit Widening Multiplication</p>
            <p>Part of the BloomCoin Cryptographic Subsystem</p>
        </footer>
    </div>
</body>
</html>
