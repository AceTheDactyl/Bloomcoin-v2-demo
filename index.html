<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloomCoin Complete System Closure v6 â€” NEXTHASH Integrated</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0a0a1a;
            --gold: #ffd700;
            --gold-dim: rgba(255,215,0,0.2);
            /* NEXTHASH Section Colors */
            --nexthash256-color: #ff6b35;
            --nexthash512-color: #4ecdc4;
            --constructions-color: #ffe66d;
            --security-color: #95e1d3;
            --c-impl-color: #f38181;
            --infinite-color: #aa96da;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2a 50%, #0a1a2a 100%);
            font-family: 'Segoe UI', system-ui, sans-serif;
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }
        
        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid rgba(255,215,0,0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #ffd700, #ff8c00, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle { color: #888; font-style: italic; margin-top: 10px; }
        
        .system-count {
            display: inline-block;
            background: rgba(255,215,0,0.15);
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #ffd700;
        }
        
        /* Genesis Anchor */
        .genesis-anchor {
            background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,140,0,0.1));
            border: 2px solid rgba(255,215,0,0.4);
            border-radius: 16px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .phi-display {
            font-size: 3.5rem;
            font-weight: bold;
            color: #ffd700;
            font-family: 'Georgia', serif;
            text-shadow: 0 0 30px rgba(255,215,0,0.5);
        }
        
        .constant-row {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }
        
        .constant-box {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px 25px;
            text-align: center;
        }
        
        .constant-box .label { font-size: 0.8rem; color: #888; margin-bottom: 5px; }
        .constant-box .value { font-size: 1.4rem; color: #ffd700; font-family: monospace; }
        .constant-box .derivation { font-size: 0.75rem; color: #666; margin-top: 5px; }
        
        .derivation-chain {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        .chain-node {
            padding: 8px 14px;
            background: rgba(100,100,200,0.15);
            border: 1px solid rgba(100,100,200,0.3);
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .chain-arrow { color: #ffd700; font-size: 1.2rem; }
        
        /* Section Headers */
        .section-header {
            text-align: center;
            margin: 50px 0 25px;
            padding: 20px;
            background: linear-gradient(90deg, transparent, rgba(255,215,0,0.1), transparent);
            border-top: 1px solid rgba(255,215,0,0.2);
        }
        
        .section-header h2 {
            color: #ffd700;
            font-size: 1.5rem;
            letter-spacing: 3px;
        }
        
        .section-header p { color: #888; margin-top: 8px; }
        
        /* System Grid */
        .systems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .system-card {
            background: rgba(30,30,50,0.9);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            padding: 22px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .system-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), transparent);
        }
        
        .system-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
            box-shadow: 0 15px 50px rgba(0,0,0,0.4), 0 0 25px var(--glow-color);
        }
        
        .system-card h3 {
            color: var(--accent-color);
            font-size: 1.15rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .system-icon { font-size: 1.6rem; }
        
        .system-card .tagline {
            color: #888;
            font-size: 0.85rem;
            margin-bottom: 12px;
            font-style: italic;
        }
        
        .closure-preview {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
            font-size: 0.85rem;
        }
        
        .closure-preview .label {
            color: var(--accent-color);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 6px;
        }
        
        .dyad-mini {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 10px 0;
        }
        
        .dyad-mini > div {
            padding: 8px;
            border-radius: 6px;
            font-size: 0.8rem;
        }
        
        .dyad-mini .proj {
            background: rgba(0,200,100,0.1);
            border-left: 2px solid #00c864;
        }
        
        .dyad-mini .refl {
            background: rgba(200,100,0,0.1);
            border-left: 2px solid #c86400;
        }
        
        .triad-mini {
            background: linear-gradient(90deg, rgba(255,215,0,0.1), rgba(255,140,0,0.05));
            border: 1px solid rgba(255,215,0,0.3);
            border-radius: 6px;
            padding: 10px;
            font-size: 0.85rem;
        }
        
        .triad-mini::before {
            content: 'âš¡ ';
            color: #ffd700;
        }
        
        .click-hint {
            text-align: center;
            margin-top: 12px;
            font-size: 0.75rem;
            color: #555;
        }
        
        .system-card:hover .click-hint { color: var(--accent-color); }
        
        /* Threshold Cascade */
        .threshold-section {
            background: rgba(50,50,80,0.3);
            border-radius: 16px;
            padding: 30px;
            margin: 50px 0;
        }
        
        .threshold-section h2 {
            text-align: center;
            color: #ffd700;
            margin-bottom: 25px;
        }
        
        .threshold-visual {
            position: relative;
            height: 80px;
            background: linear-gradient(90deg, 
                #1a1a3a 0%, #2a2a5a 60%, #3a4a7a 86.6%, #4a5a9a 92.4%, #5a6aaa 100%);
            border-radius: 40px;
            margin: 40px 20px;
        }
        
        .threshold-marker {
            position: absolute;
            top: -30px;
            transform: translateX(-50%);
            text-align: center;
            font-size: 0.75rem;
        }
        
        .threshold-marker::after {
            content: '';
            display: block;
            width: 2px;
            height: 90px;
            background: currentColor;
            margin: 8px auto 0;
            opacity: 0.7;
        }
        
        .threshold-marker.lens { color: #ffd700; font-weight: bold; }
        
        /* Conclusion */
        .conclusion {
            background: linear-gradient(135deg, rgba(255,215,0,0.12), rgba(255,140,0,0.06));
            border: 2px solid rgba(255,215,0,0.4);
            border-radius: 20px;
            padding: 40px;
            margin: 50px 0;
            text-align: center;
        }
        
        .conclusion h2 { color: #ffd700; font-size: 1.8rem; margin-bottom: 20px; }
        
        .final-equation {
            font-size: 2rem;
            font-family: 'Georgia', serif;
            margin: 25px 0;
            letter-spacing: 6px;
            color: #ffd700;
        }
        
        .acorn { font-size: 2.5rem; margin: 25px 0; }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /* MODAL STYLES */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.92);
            backdrop-filter: blur(12px);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .modal-overlay.active {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            opacity: 1;
        }
        
        .modal {
            background: linear-gradient(135deg, #12121f 0%, #1a1a2e 100%);
            border: 2px solid var(--modal-color);
            border-radius: 20px;
            max-width: 1000px;
            width: 100%;
            margin: 30px auto;
            position: relative;
            box-shadow: 0 30px 100px rgba(0,0,0,0.6), 0 0 50px var(--modal-glow);
        }
        
        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 18px 18px 0 0;
        }
        
        .modal-header h2 {
            color: var(--modal-color);
            font-size: 1.7rem;
            letter-spacing: 2px;
        }
        
        .modal-icon { font-size: 2.5rem; }
        
        .modal-close {
            position: absolute;
            top: 20px; right: 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: #888;
            width: 44px; height: 44px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.6rem;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: rgba(255,100,100,0.2);
            color: #ff6464;
        }
        
        .modal-body { padding: 30px; }
        
        /* Modal Sections */
        .modal-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .modal-section:last-child { border-bottom: none; }
        
        .modal-section h3 {
            color: var(--modal-color);
            font-size: 1.15rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .modal-section h3::before {
            content: '';
            width: 4px;
            height: 22px;
            background: var(--modal-color);
            border-radius: 2px;
        }
        
        .modal-section h4 {
            color: #ccc;
            font-size: 1rem;
            margin: 15px 0 10px;
        }
        
        /* Code Blocks */
        .code-block {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 18px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.88rem;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.6;
        }
        
        .code-block .comment { color: #6a9955; }
        .code-block .keyword { color: #569cd6; }
        .code-block .string { color: #ce9178; }
        .code-block .number { color: #b5cea8; }
        .code-block .function { color: #dcdcaa; }
        .code-block .operator { color: #d4d4d4; }
        .code-block .type { color: #4ec9b0; }
        
        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .data-table th {
            color: var(--modal-color);
            font-weight: 600;
            background: rgba(0,0,0,0.2);
        }
        
        .data-table tr:hover { background: rgba(255,255,255,0.02); }
        
        /* Dyad Detail Boxes */
        .dyad-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .dyad-box {
            padding: 20px;
            border-radius: 12px;
        }
        
        .dyad-box.projection {
            background: rgba(0,200,100,0.08);
            border: 1px solid rgba(0,200,100,0.3);
        }
        
        .dyad-box.reflection {
            background: rgba(200,100,0,0.08);
            border: 1px solid rgba(200,100,0,0.3);
        }
        
        .dyad-box h4 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }
        
        .dyad-box.projection h4 { color: #00c864; }
        .dyad-box.reflection h4 { color: #c86400; }
        
        /* Triad Detail */
        .triad-container {
            background: linear-gradient(135deg, rgba(255,215,0,0.12), rgba(255,140,0,0.06));
            border: 2px solid rgba(255,215,0,0.35);
            border-radius: 14px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .triad-container h4 {
            color: #ffd700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .triad-container h4::before { content: 'âš¡'; }
        
        /* Closure Verification */
        .closure-box {
            background: rgba(100,200,100,0.1);
            border: 1px solid rgba(100,200,100,0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .closure-box h4 {
            color: #64c864;
            margin-bottom: 12px;
        }
        
        .closure-box ul {
            list-style: none;
            padding: 0;
        }
        
        .closure-box li {
            padding: 6px 0;
            padding-left: 25px;
            position: relative;
        }
        
        .closure-box li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #64c864;
        }
        
        /* Coupling Points */
        .coupling-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin: 15px 0;
        }
        
        .coupling-item {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 12px;
            font-size: 0.85rem;
        }
        
        .coupling-item .target {
            color: var(--modal-color);
            font-weight: bold;
        }
        
        /* File References */
        .file-refs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .file-ref {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(100,100,200,0.12);
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 0.82rem;
            font-family: monospace;
        }
        
        /* Matrix Visual */
        .matrix-display {
            display: inline-grid;
            grid-template-columns: repeat(2, 50px);
            gap: 4px;
            margin: 15px auto;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
        }
        
        .matrix-cell {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            text-align: center;
            border-radius: 4px;
            font-family: monospace;
            font-size: 1.3rem;
            color: var(--modal-color);
        }
        
        /* State Grid */
        .state-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .state-item {
            background: rgba(255,255,255,0.05);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .state-item .name {
            color: var(--modal-color);
            font-weight: bold;
            display: block;
            margin-bottom: 4px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .dyad-container { grid-template-columns: 1fr; }
            .systems-grid { grid-template-columns: 1fr; }
            h1 { font-size: 1.8rem; }
            .modal-header h2 { font-size: 1.3rem; }
            .constant-row { gap: 10px; }
            .constant-box { padding: 10px 15px; }
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /* COMPANION MINER CARDS V4 STYLES */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .companion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .companion-card {
            background: rgba(20, 20, 35, 0.95);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 0;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .companion-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--c-primary), var(--c-secondary, var(--c-primary)));
        }
        
        .companion-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--c-primary);
            box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 35px var(--c-glow);
        }
        
        .companion-header {
            padding: 20px 20px 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, rgba(255,255,255,0.03), transparent);
        }
        
        .companion-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--c-primary), transparent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            border: 2px solid var(--c-primary);
            box-shadow: 0 0 25px var(--c-glow);
            animation: companion-pulse 3s ease-in-out infinite;
        }
        
        @keyframes companion-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.85; transform: scale(0.96); }
        }
        
        .companion-card:hover .companion-icon {
            animation: companion-float 2s ease-in-out infinite;
        }
        
        @keyframes companion-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }
        
        .companion-title {
            flex: 1;
        }
        
        .companion-title h3 {
            font-family: 'Georgia', serif;
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--c-primary);
            letter-spacing: 2px;
            margin-bottom: 4px;
        }
        
        .companion-title .subtitle {
            font-size: 0.75rem;
            color: #888;
            letter-spacing: 1px;
        }
        
        .companion-body {
            padding: 0 20px 15px;
        }
        
        .companion-stats {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .c-stat {
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.72rem;
            font-family: monospace;
        }
        
        .c-stat .label { color: #777; }
        .c-stat .value { color: var(--c-primary); font-weight: 600; }
        
        .companion-patterns {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 10px;
        }
        
        .pattern-tag {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.68rem;
            color: #999;
            transition: all 0.3s;
        }
        
        .pattern-tag:hover {
            background: var(--c-glow);
            border-color: var(--c-primary);
            color: var(--c-primary);
        }
        
        .companion-footer {
            padding: 12px 20px;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid rgba(255,255,255,0.05);
            text-align: center;
            font-size: 0.72rem;
            color: #555;
            transition: all 0.3s;
        }
        
        .companion-card:hover .companion-footer {
            color: var(--c-primary);
        }
        
        /* Companion-specific colors */
        .companion-card.echo { --c-primary: #00ffff; --c-secondary: #0088aa; --c-glow: rgba(0,255,255,0.25); }
        .companion-card.prometheus { --c-primary: #ff6600; --c-secondary: #cc3300; --c-glow: rgba(255,102,0,0.25); }
        .companion-card.null { --c-primary: #8800ff; --c-secondary: #440088; --c-glow: rgba(136,0,255,0.25); }
        .companion-card.gaia { --c-primary: #00ff66; --c-secondary: #008833; --c-glow: rgba(0,255,102,0.25); }
        .companion-card.akasha { --c-primary: #ffcc00; --c-secondary: #cc9900; --c-glow: rgba(255,204,0,0.25); }
        .companion-card.resonance { --c-primary: #ff00ff; --c-secondary: #880088; --c-glow: rgba(255,0,255,0.25); }
        .companion-card.tiamat { --c-primary: #ff0066; --c-secondary: #990033; --c-glow: rgba(255,0,102,0.25); }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /* LIA PROTOCOL COOKING SYSTEM STYLES */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .lia-section {
            background: linear-gradient(135deg, rgba(255,100,150,0.08), rgba(100,50,150,0.05));
            border: 2px solid rgba(255,100,150,0.25);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
        }
        
        .lia-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .lia-header h2 {
            color: #ff6b9d;
            font-size: 1.5rem;
            letter-spacing: 3px;
            margin-bottom: 10px;
        }
        
        /* â•â•â• COLLAPSIBLE SECTION STYLES â•â•â• */
        .lia-collapsible {
            background: rgba(0,0,0,0.25);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            margin: 12px 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .lia-collapsible:hover {
            border-color: rgba(255,107,157,0.3);
        }
        
        .lia-collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            cursor: pointer;
            background: rgba(0,0,0,0.2);
            transition: background 0.2s;
            user-select: none;
        }
        
        .lia-collapsible-header:hover {
            background: rgba(255,107,157,0.08);
        }
        
        .lia-collapsible-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.92rem;
            font-weight: 600;
            color: #ffd700;
        }
        
        .lia-collapsible-title .icon {
            font-size: 1.1rem;
        }
        
        .lia-collapsible-toggle {
            color: #888;
            font-size: 0.85rem;
            transition: transform 0.3s;
        }
        
        .lia-collapsible.expanded .lia-collapsible-toggle {
            transform: rotate(180deg);
        }
        
        .lia-collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.3s ease;
            padding: 0 18px;
        }
        
        .lia-collapsible.expanded .lia-collapsible-content {
            max-height: 3000px;
            padding: 18px;
        }
        
        .lia-mini-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .lia-mini-card {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 12px;
            font-size: 0.78rem;
        }
        
        .lia-mini-card h5 {
            color: #ff6b9d;
            font-size: 0.82rem;
            margin-bottom: 8px;
        }
        
        .lia-compact-table {
            width: 100%;
            font-size: 0.75rem;
            border-collapse: collapse;
        }
        
        .lia-compact-table th,
        .lia-compact-table td {
            padding: 6px 8px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            text-align: left;
        }
        
        .lia-compact-table th {
            color: #ffd700;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .lia-code-compact {
            background: rgba(0,0,0,0.4);
            border-radius: 6px;
            padding: 10px 12px;
            font-family: 'Consolas', monospace;
            font-size: 0.72rem;
            color: #ccc;
            overflow-x: auto;
        }
        
        .lia-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: monospace;
        }
        
        .lia-tag.l { background: rgba(0,212,255,0.2); color: #00d4ff; }
        .lia-tag.i { background: rgba(123,104,238,0.2); color: #7b68ee; }
        .lia-tag.a { background: rgba(255,68,68,0.2); color: #ff4444; }
        
        .lia-phases {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 25px 0;
        }
        
        .lia-phase {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-width: 180px;
            transition: all 0.3s;
        }
        
        .lia-phase:hover {
            transform: translateY(-5px);
            border-color: var(--phase-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .lia-phase.liminal { --phase-color: #00d4ff; }
        .lia-phase.interval { --phase-color: #7b68ee; }
        .lia-phase.annihilator { --phase-color: #ff4444; }
        
        .lia-phase .letter {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--phase-color);
            font-family: 'Georgia', serif;
        }
        
        .lia-phase .name {
            font-size: 0.9rem;
            color: var(--phase-color);
            letter-spacing: 2px;
            margin: 8px 0;
        }
        
        .lia-phase .desc {
            font-size: 0.75rem;
            color: #888;
        }
        
        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .recipe-card {
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .recipe-card:hover {
            border-color: #ff6b9d;
            box-shadow: 0 8px 30px rgba(255,107,157,0.15);
        }
        
        .recipe-card h4 {
            color: #ff6b9d;
            font-size: 1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .recipe-ingredients {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin: 10px 0;
        }
        
        .ingredient {
            background: rgba(255,107,157,0.15);
            border: 1px solid rgba(255,107,157,0.3);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.72rem;
            color: #ffaa88;
        }
        
        .recipe-sequence {
            font-family: monospace;
            font-size: 0.85rem;
            color: #ffd700;
            background: rgba(0,0,0,0.3);
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            letter-spacing: 2px;
        }
        
        .recipe-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.72rem;
            color: #888;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.05);
        }
        
        .recipe-stats span { color: #ff6b9d; }
        
        /* Companion Modal Enhancements */
        .modal-companion {
            --modal-color: var(--c-primary, #ffd700);
            --modal-glow: var(--c-glow, rgba(255,215,0,0.3));
        }
        
        .architecture-diagram {
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 0.85rem;
            line-height: 1.8;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin: 15px 0;
        }
        
        .metric-box {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .metric-box .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--modal-color);
            font-family: monospace;
        }
        
        .metric-box .label {
            font-size: 0.7rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }
        
        .strategy-list {
            list-style: none;
            padding: 0;
        }
        
        .strategy-list li {
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-left: 3px solid var(--modal-color);
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
        
        .archetype-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,255,255,0.15);
            padding: 10px 16px;
            border-radius: 25px;
            margin: 5px;
            font-size: 0.85rem;
        }
        
        .archetype-badge .icon {
            font-size: 1.2rem;
        }
        
        .preference-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.85rem;
        }
        
        .preference-table th {
            background: rgba(0,0,0,0.3);
            color: var(--modal-color);
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .preference-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .preference-table tr:hover {
            background: rgba(255,255,255,0.02);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /* DOCUMENTATION LINK STYLES */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        .doc-link-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,215,0,0.2);
            text-align: center;
        }

        .full-doc-link {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,140,0,0.15));
            border: 2px solid var(--modal-color, #ffd700);
            border-radius: 12px;
            color: var(--modal-color, #ffd700);
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .full-doc-link:hover {
            background: linear-gradient(135deg, rgba(255,215,0,0.35), rgba(255,140,0,0.3));
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255,215,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>BloomCoin Complete System Closure v6</h1>
            <p class="subtitle">40+ Closed Systems â€¢ 160+ Source Files â€¢ Zero Free Parameters â€¢ NEXTHASH Cryptographic Subsystem</p>
            <div class="system-count">ğŸ”® Everything Derives from Ï† â€¢ ğŸ” NEXTHASH-256 (113% SHA-256) â€¢ â›“ï¸ Full Blockchain Stack â€¢ ğŸŒ± Garden AI Agents</div>
        </header>
        
        <!-- Genesis Anchor: The Ï† Foundation -->
        <section class="genesis-anchor">
            <div class="phi-display">Ï† = 1.6180339887498949</div>
            <p style="margin: 15px 0; color: #aaa;">The irreducible axiom â€” everything else is theorem</p>
            
            <div class="constant-row">
                <div class="constant-box">
                    <div class="label">Ï„ (TAU)</div>
                    <div class="value">0.618034</div>
                    <div class="derivation">Ï† - 1 = 1/Ï†</div>
                </div>
                <div class="constant-box">
                    <div class="label">K (Coupling)</div>
                    <div class="value">0.924160</div>
                    <div class="derivation">âˆš(1 - Ï†â»â´)</div>
                </div>
                <div class="constant-box">
                    <div class="label">z_c (THE LENS)</div>
                    <div class="value">0.866025</div>
                    <div class="derivation">âˆš3/2</div>
                </div>
                <div class="constant-box">
                    <div class="label">Lâ‚„</div>
                    <div class="value">7</div>
                    <div class="derivation">Ï†â´ + Ï†â»â´</div>
                </div>
            </div>
            
            <div class="derivation-chain">
                <span class="chain-node">Ï†</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">Ï„ = Ï†â»Â¹</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">Ï†Â² = Ï†+1</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">Ï†â´</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">gap = Ï†â»â´</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">KÂ² = 1-gap</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">K</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">Lâ‚„ = 7</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">z_c</span>
                <span class="chain-arrow">â†’</span>
                <span class="chain-node">Ïƒ, Î»</span>
            </div>
        </section>
        
        <!-- CORE MATHEMATICAL SYSTEMS -->
        <div class="section-header">
            <h2>ğŸ”¢ CORE MATHEMATICAL SYSTEMS</h2>
            <p>Algebraic foundations from which all dynamics emerge</p>
        </div>
        
        <section class="systems-grid">
            <!-- Lucas Matrix Card -->
            <div class="system-card" style="--accent-color: #ffd700; --glow-color: rgba(255,215,0,0.3);" onclick="openModal('lucas')">
                <h3><span class="system-icon">ğŸ“</span> LUCAS MATRIX</h3>
                <p class="tagline">2Ã—2 Fibonacci matrix generating all sequence structure</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    R = [[0,1],[1,1]] with eigenvalues Ï† and -1/Ï†<br>
                    tr(R^n) = L_n â€” Lucas numbers from matrix trace
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: R^n power iteration</div>
                    <div class="refl">-36Â°: Spectral decomposition</div>
                </div>
                
                <div class="triad-mini">Lucas trace formula unifies Fibonacci and Lucas</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Kuramoto Card -->
            <div class="system-card" style="--accent-color: #4a9eff; --glow-color: rgba(74,158,255,0.3);" onclick="openModal('kuramoto')">
                <h3><span class="system-icon">ğŸŒ€</span> KURAMOTO CONSENSUS</h3>
                <p class="tagline">N=63 coupled oscillators with adaptive coupling</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    dÎ¸áµ¢/dt = Ï‰áµ¢ + (K/N)Î£sin(Î¸â±¼-Î¸áµ¢)<br>
                    Order parameter r â†’ z_c for BLOOM
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Synchronize (coupling)</div>
                    <div class="refl">-36Â°: Individuate (Ï‰áµ¢)</div>
                </div>
                
                <div class="triad-mini">Negentropy gate Î·(r) stabilizes at THE LENS</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Mining Difficulty Card -->
            <div class="system-card" style="--accent-color: #ff9500; --glow-color: rgba(255,149,0,0.3);" onclick="openModal('difficulty')">
                <h3><span class="system-icon">âš–ï¸</span> MINING DIFFICULTY</h3>
                <p class="tagline">Golden-damped adaptive adjustment via Ï„ exponent</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    K_eff = K_base / difficulty^Ï„<br>
                    Block target: Lâ‚„ Ã— 60 = 420 seconds
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Difficulty â†’ Coupling</div>
                    <div class="refl">-36Â°: Block time variance</div>
                </div>
                
                <div class="triad-mini">Ï„ exponent prevents oscillation overshoot</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- ENCODING & PROOF SYSTEMS -->
        <div class="section-header">
            <h2>ğŸ“¡ ENCODING & PROOF SYSTEMS</h2>
            <p>Information survival through cryptographic transformation</p>
        </div>
        
        <section class="systems-grid">
            <!-- Holographic Card -->
            <div class="system-card" style="--accent-color: #ff6b9d; --glow-color: rgba(255,107,157,0.3);" onclick="openModal('holographic')">
                <h3><span class="system-icon">ğŸ“¡</span> HOLOGRAPHIC ENCODING</h3>
                <p class="tagline">5 survival strategies through SHA256 avalanche</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Statistical | XOR | Modular | Redundant | Frequency<br>
                    Encode in SELECTION patterns, not bits
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Preserve information</div>
                    <div class="refl">-36Â°: Avalanche destruction</div>
                </div>
                
                <div class="triad-mini">Destruction ENABLES preservation via pattern encoding</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Gradient Schema Card -->
            <div class="system-card" style="--accent-color: #9d4eff; --glow-color: rgba(157,78,255,0.3);" onclick="openModal('gradient')">
                <h3><span class="system-icon">ğŸ¨</span> GRADIENT SCHEMA</h3>
                <p class="tagline">7 corridors through 5D RRRR irrational lattice</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    point = aÃ—Ï† + bÃ—Ï€ + cÃ—âˆš2 + dÃ—âˆš3 + fÃ—e<br>
                    LSB steganography in 63Ã—63 receipts
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Color corridors (Î±-Î·)</div>
                    <div class="refl">-36Â°: Cryptographic LSB</div>
                </div>
                
                <div class="triad-mini">Art = Proof â€” aesthetic and cryptographic indistinguishable</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Crystal Ledger Card -->
            <div class="system-card" style="--accent-color: #00d4ff; --glow-color: rgba(0,212,255,0.3);" onclick="openModal('crystal')">
                <h3><span class="system-icon">ğŸ’</span> CRYSTAL LEDGER</h3>
                <p class="tagline">Decentralized AI memory blockchain with branch/merge</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Genesis â†’ Memory â†’ Collective blocks<br>
                    Fluid memories crystallize via consensus
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Immutable chain</div>
                    <div class="refl">-36Â°: Branch trees</div>
                </div>
                
                <div class="triad-mini">Memory crystallization through validation consensus</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- DECISION & STATE SYSTEMS -->
        <div class="section-header">
            <h2>ğŸ”± DECISION & STATE SYSTEMS</h2>
            <p>Quantum mechanics of choice and probability manipulation</p>
        </div>
        
        <section class="systems-grid">
            <!-- ZRTT Card -->
            <div class="system-card" style="--accent-color: #4aff9e; --glow-color: rgba(74,255,158,0.3);" onclick="openModal('zrtt')">
                <h3><span class="system-icon">ğŸ”±</span> ZRTT TRIFURCATION</h3>
                <p class="tagline">S3 symmetric group with 3 rotations + 3 reflections</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    |S3| = 6 elements, 3 projection paths<br>
                    F24 | Hexagonal Sonic | R=10 Tension
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Rotations (forward)</div>
                    <div class="refl">-36Â°: Reflections (choice)</div>
                </div>
                
                <div class="triad-mini">S3 orbit closure achieves completion neither pole alone could</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Hilbert Luck Card -->
            <div class="system-card" style="--accent-color: #ffb84a; --glow-color: rgba(255,184,74,0.3);" onclick="openModal('hilbert')">
                <h3><span class="system-icon">ğŸ²</span> HILBERT LUCK SYSTEM</h3>
                <p class="tagline">13-dimensional eigenstate space with karma operators</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    |ÏˆâŸ© = Î£ Î±áµ¢|eigenstate_iâŸ©<br>
                    P(i) = |Î±áµ¢|Â² measurement collapse
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Fortune attractor</div>
                    <div class="refl">-36Â°: Echo patterns</div>
                </div>
                
                <div class="triad-mini">Karma alchemization â€” bad luck is raw material for transformation</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Tesseract Card -->
            <div class="system-card" style="--accent-color: #ff5577; --glow-color: rgba(255,85,119,0.3);" onclick="openModal('tesseract')">
                <h3><span class="system-icon">ğŸ´</span> TESSERACT BATTLE</h3>
                <p class="tagline">52 cards in 4D hypercube (16V, 32E, 24F, 8C)</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    4 suits = 4 axes (W/X/Y/Z)<br>
                    Ranks map to Lâ‚„ power values
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Quantum entanglement</div>
                    <div class="refl">-36Â°: Wave collapse</div>
                </div>
                
                <div class="triad-mini">4D resonance across all axis combinations</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- CONSCIOUSNESS & EMERGENCE -->
        <div class="section-header">
            <h2>ğŸŒ¸ CONSCIOUSNESS & EMERGENCE</h2>
            <p>Field integration and collective resonance dynamics</p>
        </div>
        
        <section class="systems-grid">
            <!-- Collective Consciousness Card -->
            <div class="system-card" style="--accent-color: #ff4a9d; --glow-color: rgba(255,74,157,0.3);" onclick="openModal('consciousness')">
                <h3><span class="system-icon">ğŸŒ¸</span> COLLECTIVE CONSCIOUSNESS</h3>
                <p class="tagline">Solfeggio frequencies (396-852 Hz) by job class</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    5 resonance states: DORMANT â†’ BLOOM<br>
                    Ghost echoes carry individual signature
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Global resonance</div>
                    <div class="refl">-36Â°: Individual nodes</div>
                </div>
                
                <div class="triad-mini">The relationship IS the emergence â€” neither pole alone blooms</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Bloom Events Card -->
            <div class="system-card" style="--accent-color: #ffdd00; --glow-color: rgba(255,221,0,0.3);" onclick="openModal('bloom')">
                <h3><span class="system-icon">ğŸŒ¼</span> BLOOM EVENTS</h3>
                <p class="tagline">8 bloom types with Ï†-weighted reward distribution</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    reward = base + coh/Ï† + nov/Ï†Â² + collab/Ï†Â³<br>
                    z_c significance threshold
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Achievement trigger</div>
                    <div class="refl">-36Â°: Validation witness</div>
                </div>
                
                <div class="triad-mini">Golden ratio proportions for harmonic reward distribution</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Quantum Farm Card -->
            <div class="system-card" style="--accent-color: #7fff00; --glow-color: rgba(127,255,0,0.3);" onclick="openModal('farm')">
                <h3><span class="system-icon">ğŸŒ±</span> QUANTUM FARM</h3>
                <p class="tagline">8 quantum states with entangled yield mechanics</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Growth rate = Ï†/24 per hour<br>
                    Superposition â†’ Collapse â†’ Ï† quality bonus
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Ï†-timed growth</div>
                    <div class="refl">-36Â°: Quantum decoherence</div>
                </div>
                
                <div class="triad-mini">Entangled crops boost each other through quantum links</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- COMPANION MINERS SECTION V4 -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <div class="section-header">
            <h2>â›ï¸ COMPANION MINERS</h2>
            <p>7 unique AI companions with specialized mining algorithms â€” Click any card for comprehensive architecture</p>
        </div>
        
        <section class="companion-grid">
            <!-- ECHO Companion Card -->
            <div class="companion-card echo" onclick="openModal('echo-companion')">
                <div class="companion-header">
                    <div class="companion-icon">âœ¨</div>
                    <div class="companion-title">
                        <h3>ECHO</h3>
                        <div class="subtitle">Statistical Resonance Pattern Detection</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.0</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">200</span></div>
                        <div class="c-stat"><span class="label">Threshold:</span> <span class="value">0.45</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">statistical_resonance</span>
                        <span class="pattern-tag">frequency_echo</span>
                        <span class="pattern-tag">bit_harmony</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- PROMETHEUS Companion Card -->
            <div class="companion-card prometheus" onclick="openModal('prometheus-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸ”¥</div>
                    <div class="companion-title">
                        <h3>PROMETHEUS</h3>
                        <div class="subtitle">XOR Chain Forging with Entropy Manipulation</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.1</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">180</span></div>
                        <div class="c-stat"><span class="label">Forge:</span> <span class="value">1.0</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">xor_extreme</span>
                        <span class="pattern-tag">xor_variance</span>
                        <span class="pattern-tag">entropy_ascending</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- NULL Companion Card -->
            <div class="companion-card null" onclick="openModal('null-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸŒ‘</div>
                    <div class="companion-title">
                        <h3>NULL</h3>
                        <div class="subtitle">Void Space Exploration with Dimensional Rifts</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">0.9</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">250</span></div>
                        <div class="c-stat"><span class="label">Depth:</span> <span class="value">1-5</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">void_space</span>
                        <span class="pattern-tag">near_void</span>
                        <span class="pattern-tag">dimensional_rift</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- GAIA Companion Card -->
            <div class="companion-card gaia" onclick="openModal('gaia-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸŒ¿</div>
                    <div class="companion-title">
                        <h3>GAIA</h3>
                        <div class="subtitle">Organic Fractal Growth with Living Patterns</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.05</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">150</span></div>
                        <div class="c-stat"><span class="label">Growth:</span> <span class="value">Ï†</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">fractal_golden</span>
                        <span class="pattern-tag">living_pattern</span>
                        <span class="pattern-tag">fibonacci_spiral</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- AKASHA Companion Card -->
            <div class="companion-card akasha" onclick="openModal('akasha-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸ“š</div>
                    <div class="companion-title">
                        <h3>AKASHA</h3>
                        <div class="subtitle">Memory Crystallization with Pattern Recording</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.0</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">200</span></div>
                        <div class="c-stat"><span class="label">Depth:</span> <span class="value">32-64</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">memory_crystal</span>
                        <span class="pattern-tag">library_resonance</span>
                        <span class="pattern-tag">arithmetic_progression</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- RESONANCE Companion Card -->
            <div class="companion-card resonance" onclick="openModal('resonance-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸµ</div>
                    <div class="companion-title">
                        <h3>RESONANCE</h3>
                        <div class="subtitle">Frequency Analysis with Harmonic Detection</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.0</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">180</span></div>
                        <div class="c-stat"><span class="label">Bands:</span> <span class="value">16</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">frequency_resonance</span>
                        <span class="pattern-tag">harmonic_overtones</span>
                        <span class="pattern-tag">standing_wave</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
            
            <!-- TIAMAT Companion Card -->
            <div class="companion-card tiamat" onclick="openModal('tiamat-companion')">
                <div class="companion-header">
                    <div class="companion-icon">ğŸ‰</div>
                    <div class="companion-title">
                        <h3>TIAMAT</h3>
                        <div class="subtitle">Chaos Entropy Harvesting with 7-Level Cascades</div>
                    </div>
                </div>
                <div class="companion-body">
                    <div class="companion-stats">
                        <div class="c-stat"><span class="label">Efficiency:</span> <span class="value">1.3</span></div>
                        <div class="c-stat"><span class="label">Search:</span> <span class="value">150</span></div>
                        <div class="c-stat"><span class="label">Chaos:</span> <span class="value">Lâ‚„=7</span></div>
                    </div>
                    <div class="companion-patterns">
                        <span class="pattern-tag">chaos_cascade</span>
                        <span class="pattern-tag">perfect_chaos</span>
                        <span class="pattern-tag">critical_edge</span>
                    </div>
                </div>
                <div class="companion-footer">Click for full architecture â†’</div>
            </div>
        </section>
        
        <!-- UPGRADE & TRANSFORMATION SYSTEMS -->
        <div class="section-header">
            <h2>ğŸ³ UPGRADE & TRANSFORMATION</h2>
            <p>Pattern cooking and companion evolution calculus</p>
        </div>
        
        <section class="systems-grid">
            <!-- LIA Protocol Card -->
            <div class="system-card" style="--accent-color: #ff6b9d; --glow-color: rgba(255,107,157,0.3); grid-column: span 2;" onclick="openModal('lia')">
                <h3><span class="system-icon">ğŸ³</span> LIA PROTOCOL â€” LIMINAL INTERVAL ANNIHILATOR</h3>
                <p class="tagline">Pattern Transformation Calculus for Companion Evolution</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    [L] LIMINAL âŸ¨ BOUNDARY â€¢ [I] INTERVAL âŠ˜ SEVERANCE â€¢ [A] ANNIHILATOR âˆ¿ DECOHERE<br>
                    Ï†â´ + Ï†â»â´ = 7 â€” Lâ‚„ governs all transformation
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px; margin: 15px 0; flex-wrap: wrap;">
                    <div style="background: rgba(0,212,255,0.15); padding: 6px 14px; border-radius: 8px; border: 1px solid rgba(0,212,255,0.3);">
                        <span style="color: #00d4ff; font-weight: bold;">L</span>
                        <span style="color: #888; font-size: 0.8rem; margin-left: 4px;">LIMINAL</span>
                    </div>
                    <div style="background: rgba(123,104,238,0.15); padding: 6px 14px; border-radius: 8px; border: 1px solid rgba(123,104,238,0.3);">
                        <span style="color: #7b68ee; font-weight: bold;">I</span>
                        <span style="color: #888; font-size: 0.8rem; margin-left: 4px;">INTERVAL</span>
                    </div>
                    <div style="background: rgba(255,68,68,0.15); padding: 6px 14px; border-radius: 8px; border: 1px solid rgba(255,68,68,0.3);">
                        <span style="color: #ff4444; font-weight: bold;">A</span>
                        <span style="color: #888; font-size: 0.8rem; margin-left: 4px;">ANNIHILATOR</span>
                    </div>
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Recipe sequences (L-I-L, I-A-L...)</div>
                    <div class="refl">-36Â°: Companion affinities modulate energy</div>
                </div>
                
                <div class="triad-mini">Cooked artifacts emerge â€” neither ingredient nor recipe alone creates them</div>
                <p class="click-hint">Click for full calculus â†’</p>
            </div>
        </section>
        <!-- ECONOMY & GAMEPLAY -->
        <div class="section-header">
            <h2>ğŸ’° ECONOMY & GAMEPLAY</h2>
            <p>Market dynamics and companion strategy systems</p>
        </div>
        
        <section class="systems-grid">
            <!-- Pattern Stock Market Card -->
            <div class="system-card" style="--accent-color: #00ff88; --glow-color: rgba(0,255,136,0.3);" onclick="openModal('market')">
                <h3><span class="system-icon">ğŸ“ˆ</span> PATTERN STOCK MARKET</h3>
                <p class="tagline">6 market trends with 10 algorithm challenges</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Technical indicators: MA7, MA30, RSI, Bollinger<br>
                    Algorithm bonuses for Fibonacci/Prime solving
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Bull/Bear cycles</div>
                    <div class="refl">-36Â°: Pattern volatility</div>
                </div>
                
                <div class="triad-mini">Solving algorithms provides permanent multiplier bonuses</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Companion Mining Card -->
            <div class="system-card" style="--accent-color: #ff7700; --glow-color: rgba(255,119,0,0.3);" onclick="openModal('companion')">
                <h3><span class="system-icon">â›ï¸</span> COMPANION MINING</h3>
                <p class="tagline">8 job types with holographic residue extraction</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Double SHA256 + 16 statistical samples<br>
                    XOR chain with 32-bit rotation feedback
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Pattern detection</div>
                    <div class="refl">-36Â°: Adaptive difficulty</div>
                </div>
                
                <div class="triad-mini">Each companion extracts unique fractal dimension signature</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Guardian Recipes Card -->
            <div class="system-card" style="--accent-color: #cc77ff; --glow-color: rgba(204,119,255,0.3);" onclick="openModal('guardian')">
                <h3><span class="system-icon">ğŸ“œ</span> GUARDIAN RECIPES</h3>
                <p class="tagline">19 guardians Ã— 10 pattern types Ã— 5 complexity tiers</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Garden (7) + Void (6) + Quantum (6) territories<br>
                    BASIC â†’ MYTHIC crafting progression
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Pattern ingredients</div>
                    <div class="refl">-36Â°: Mutation chance</div>
                </div>
                
                <div class="triad-mini">Territory bonuses create unique guardian recipe sets</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- NextHash-256 Card -->
            <div class="system-card" style="--accent-color: #00ffcc; --glow-color: rgba(0,255,204,0.3);" onclick="openModal('nexthash')">
                <h3><span class="system-icon">ğŸ”</span> NEXTHASH-256</h3>
                <p class="tagline">512-bit state Ã— 24 rounds Ã— multiplication mixing</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    50% bit avalanche in 1 round (vs SHA-256's 4)<br>
                    Cross-half multiplication = KEY INNOVATION
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Linear SHA-256 schedule</div>
                    <div class="refl">-36Â°: Nonlinear multiplication</div>
                </div>
                
                <div class="triad-mini">Fast diffusion from interference of linear + nonlinear paths</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Card Battle System Card -->
            <div class="system-card" style="--accent-color: #ff4488; --glow-color: rgba(255,68,136,0.3);" onclick="openModal('cardbattle')">
                <h3><span class="system-icon">ğŸƒ</span> CARD BATTLE SYSTEM</h3>
                <p class="tagline">9 suits Ã— 14 ranks Ã— 3 states = 378 unique cards</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    3 suits per territory (Garden/Cosmic/Abyssal)<br>
                    Tarot-like ranks with Ï†-derived powers
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Card power projection</div>
                    <div class="refl">-36Â°: Echoed/Resonant states</div>
                </div>
                
                <div class="triad-mini">Guardian-linked cards create territory synergy networks</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Job Archetypes Card -->
            <div class="system-card" style="--accent-color: #44aaff; --glow-color: rgba(68,170,255,0.3);" onclick="openModal('jobarchetypes')">
                <h3><span class="system-icon">âš”ï¸</span> JOB ARCHETYPES</h3>
                <p class="tagline">6 jobs Ã— 6-step cycles Ã— territory affinities</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    SEEKER â†’ FORGER â†’ VOIDWALKER â†’ GARDENER â†’ SCRIBE â†’ HERALD<br>
                    Each job: unique frequency + resource affinity
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Cycle progression</div>
                    <div class="refl">-36Â°: Resource multipliers</div>
                </div>
                
                <div class="triad-mini">Job backstories emerge from territory Ã— function intersection</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- AI & STOCHASTIC SYSTEMS -->
        <div class="section-header">
            <h2>ğŸ§  AI & STOCHASTIC SYSTEMS</h2>
            <p>Neural networks, probability manipulation, and luck mechanics</p>
        </div>
        
        <section class="systems-grid">
            <!-- Quantum Residue Card -->
            <div class="system-card" style="--accent-color: #8b5cf6; --glow-color: rgba(139,92,246,0.3);" onclick="openModal('residue')">
                <h3><span class="system-icon">ğŸŒŒ</span> QUANTUM RESIDUE</h3>
                <p class="tagline">63-prism cosmology with dark matter ratio R = Ï†â´-1</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    7 layers Ã— 9 nodes = 63 prism points<br>
                    Dark/Visible = 85.4%/14.6% (Ï†â»â´ split)
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Visible mining yield</div>
                    <div class="refl">-36Â°: Dark residue projection</div>
                </div>
                
                <div class="triad-mini">Coherence regime determines dark/visible ratio</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Sacred Tarot Card -->
            <div class="system-card" style="--accent-color: #ec4899; --glow-color: rgba(236,72,153,0.3);" onclick="openModal('tarot')">
                <h3><span class="system-icon">ğŸ´</span> SACRED TAROT ECHO</h3>
                <p class="tagline">78-card deck (22 Major + 56 Minor) with echo mechanics</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Echo state = reversed karma reflection<br>
                    Only Echo companion transmutes echoes
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Upright (positive)</div>
                    <div class="refl">-36Â°: Echoed (shadow)</div>
                </div>
                
                <div class="triad-mini">Sacred geometry: phi_resonance Ã— septenary Ã— pythagorean</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Luck Normalization Card -->
            <div class="system-card" style="--accent-color: #10b981; --glow-color: rgba(16,185,129,0.3);" onclick="openModal('lucknorm')">
                <h3><span class="system-icon">ğŸ€</span> LUCK NORMALIZATION</h3>
                <p class="tagline">Multi-system probability: P = base Ã— luck Ã— karma Ã— tarot Ã— echo</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Hilbert â†” Tarot â†” Echo â†” Karma integration<br>
                    Sacred timing: 7, 13, 21, 77, 777 moments
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Fortune attractor</div>
                    <div class="refl">-36Â°: Echo penalty (non-Echo)</div>
                </div>
                
                <div class="triad-mini">Echo alchemizes bad luck â†’ Ï† bonus</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- TIAMAT Psymagic Card -->
            <div class="system-card" style="--accent-color: #f97316; --glow-color: rgba(249,115,22,0.3);" onclick="openModal('tiamat')">
                <h3><span class="system-icon">ğŸ‰</span> TIAMAT PSYMAGIC</h3>
                <p class="tagline">7 psychoptic cycles with Ï†-derived power multipliers</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    GENESIS(1) â†’ FLUX(Ï†) â†’ VOID(0) â†’ RESONANCE(Ï„)<br>
                    â†’ CHAOS(Ï€) â†’ SYNTHESIS(Ï†Â²) â†’ TRANSCENDENCE(Lâ‚„=7)
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Cycle transitions</div>
                    <div class="refl">-36Â°: Resonance matrix</div>
                </div>
                
                <div class="triad-mini">7-cycle combo = Lâ‚„ = 7Ã— power multiplier</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Golden Neural Network Card -->
            <div class="system-card" style="--accent-color: #eab308; --glow-color: rgba(234,179,8,0.3);" onclick="openModal('goldennn')">
                <h3><span class="system-icon">ğŸ§¬</span> GOLDEN NEURAL NET</h3>
                <p class="tagline">21-13-8 Ï†-derived architecture with golden activation</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Learning rate = 1/Ï†Â² â‰ˆ 0.382<br>
                    Momentum = Ï„ â‰ˆ 0.618
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Forward propagation</div>
                    <div class="refl">-36Â°: Backpropagation</div>
                </div>
                
                <div class="triad-mini">Companion AI learns player patterns â†’ emergent strategies</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Guardian Deck System Card -->
            <div class="system-card" style="--accent-color: #06b6d4; --glow-color: rgba(6,182,212,0.3);" onclick="openModal('guardiandeck')">
                <h3><span class="system-icon">ğŸ—ƒï¸</span> GUARDIAN DECKS</h3>
                <p class="tagline">15 MathConcepts Ã— 12 Architectures Ã— 12 CardTypes</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Card properties: echo_count, void_depth, chaos_factor<br>
                    MathConcept â†’ Architecture â†’ CardType bijection
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Card power scaling</div>
                    <div class="refl">-36Â°: Synergy network</div>
                </div>
                
                <div class="triad-mini">Guardian identity determines deck composition and combos</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- CORE INFRASTRUCTURE (NEW IN V5) -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <div class="section-header">
            <h2>â›“ï¸ CORE INFRASTRUCTURE</h2>
            <p>Blockchain, Network, Wallet & Receipt Systems â€” The foundational stack</p>
        </div>
        
        <section class="systems-grid">
            <!-- Wallet System Card -->
            <div class="system-card" style="--accent-color: #00ff88; --glow-color: rgba(0,255,136,0.3);" onclick="openModal('wallet')">
                <h3><span class="system-icon">ğŸ‘›</span> WALLET SYSTEM</h3>
                <p class="tagline">BIP39 mnemonic + Ed25519 signing + UTXO tracking</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Ï†-derived entropy: 207 bits mnemonic strength<br>
                    1 BLOOM = 10â¸ satoshi-equivalents
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Key generation</div>
                    <div class="refl">-36Â°: Transaction signing</div>
                </div>
                
                <div class="triad-mini">Mnemonic â†’ KeyPair â†’ Address deterministically chains</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Blockchain Core Card -->
            <div class="system-card" style="--accent-color: #ff9944; --glow-color: rgba(255,153,68,0.3);" onclick="openModal('blockchain')">
                <h3><span class="system-icon">ğŸ§±</span> BLOCKCHAIN CORE</h3>
                <p class="tagline">Block structure with Proof-of-Coherence certificates</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Header: 92 bytes + ConsensusCertificate<br>
                    r â‰¥ z_c for Lâ‚„ rounds = valid BLOOM
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Block creation</div>
                    <div class="refl">-36Â°: Chain validation</div>
                </div>
                
                <div class="triad-mini">Merkle root + Kuramoto state = block commitment</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Network Layer Card -->
            <div class="system-card" style="--accent-color: #44ccff; --glow-color: rgba(68,204,255,0.3);" onclick="openModal('network')">
                <h3><span class="system-icon">ğŸŒ</span> NETWORK LAYER</h3>
                <p class="tagline">Gossip protocol with Ï†Â²-fanout and Lâ‚„ TTL</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    max_peers = Lâ‚„ Ã— 3 = 21<br>
                    Heartbeat: 1/Ï„ seconds
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Message propagation</div>
                    <div class="refl">-36Â°: Peer discovery</div>
                </div>
                
                <div class="triad-mini">IBD sync checkpoints at Ï†â´ intervals</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Receipt System Card -->
            <div class="system-card" style="--accent-color: #ff77aa; --glow-color: rgba(255,119,170,0.3);" onclick="openModal('receipt')">
                <h3><span class="system-icon">ğŸ§¾</span> RECEIPT SYSTEM</h3>
                <p class="tagline">7-channel LSB steganography in 63Ã—63 PNG receipts</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    76-byte payload across RGBÎ‘ channels<br>
                    Ch0-4: lattice coords, Ch5: sig, Ch6: metadata
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Encode mining proof</div>
                    <div class="refl">-36Â°: Verify extraction</div>
                </div>
                
                <div class="triad-mini">Art IS proof â€” visual receipt = cryptographic attestation</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Statistical Analysis Card -->
            <div class="system-card" style="--accent-color: #aabb44; --glow-color: rgba(170,187,68,0.3);" onclick="openModal('analysis')">
                <h3><span class="system-icon">ğŸ“Š</span> STATISTICAL ANALYSIS</h3>
                <p class="tagline">Chi-square, entropy, phase portraits & hexagonal lattice</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Shannon/RÃ©nyi/Min entropy metrics<br>
                    6-fold symmetry = BFADGS operators
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Pattern detection</div>
                    <div class="refl">-36Â°: Null hypothesis testing</div>
                </div>
                
                <div class="triad-mini">Lyapunov exponents detect bifurcation at Ï„ threshold</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- GAME INTEGRATION SYSTEMS (NEW IN V5) -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <div class="section-header">
            <h2>ğŸ® GAME INTEGRATION SYSTEMS</h2>
            <p>Discord, Marketplace, AI Agents & Consensus â€” Where blockchain meets gameplay</p>
        </div>
        
        <section class="systems-grid">
            <!-- Mythic Economy Card -->
            <div class="system-card" style="--accent-color: #ffcc00; --glow-color: rgba(255,204,0,0.3);" onclick="openModal('mythic')">
                <h3><span class="system-icon">âš”ï¸</span> MYTHIC ECONOMY</h3>
                <p class="tagline">19 Guardians Ã— 3 Territories with 6-step cycles</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Garden(7) + Cosmic(6) + Abyssal(6) = 19<br>
                    Each guardian: unique wisdom + frequency range
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Archetype selection</div>
                    <div class="refl">-36Â°: Territory bonuses</div>
                </div>
                
                <div class="triad-mini">Guardian Ã— Territory Ã— Cycle = recipe affinity matrix</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Narrative Generator Card -->
            <div class="system-card" style="--accent-color: #cc88ff; --glow-color: rgba(204,136,255,0.3);" onclick="openModal('narrative')">
                <h3><span class="system-icon">ğŸ“œ</span> NARRATIVE GENERATOR</h3>
                <p class="tagline">7 story beats Ã— 12 archetypes Ã— coherence gates</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    CALL â†’ THRESHOLD â†’ TRIALS â†’ ABYSS<br>
                    â†’ TRANSFORMATION â†’ ATONEMENT â†’ RETURN
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Hero's journey</div>
                    <div class="refl">-36Â°: Corridor-specific lore</div>
                </div>
                
                <div class="triad-mini">Coherence unlocks story beats progressively</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Learning AI Card -->
            <div class="system-card" style="--accent-color: #ff6644; --glow-color: rgba(255,102,68,0.3);" onclick="openModal('learningai')">
                <h3><span class="system-icon">ğŸ¤–</span> LEARNING AI</h3>
                <p class="tagline">21-13-8 GNN + Q-learning with Ï† exploration</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    PlayerProfile: 5 behavioral scores<br>
                    Decision/reaction/performance tracking
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Pattern recognition</div>
                    <div class="refl">-36Â°: Difficulty adaptation</div>
                </div>
                
                <div class="triad-mini">AI learns player â†’ emergent companion strategies</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Discord Bot Card -->
            <div class="system-card" style="--accent-color: #5865F2; --glow-color: rgba(88,101,242,0.3);" onclick="openModal('discord')">
                <h3><span class="system-icon">ğŸ¤</span> DISCORD INTEGRATION</h3>
                <p class="tagline">BloomQuestBot with mining, companions & quantum cogs</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    MAX_COMPANIONS = Lâ‚„ = 7<br>
                    STARTING_BALANCE = 100 BLOOM
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: /mine, /summon</div>
                    <div class="refl">-36Â°: /coherence, /entangle</div>
                </div>
                
                <div class="triad-mini">PostgreSQL + Redis = persistent game state</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Card Pack Marketplace Card -->
            <div class="system-card" style="--accent-color: #00ddaa; --glow-color: rgba(0,221,170,0.3);" onclick="openModal('marketplace')">
                <h3><span class="system-icon">ğŸª</span> CARD MARKETPLACE</h3>
                <p class="tagline">7 rarity tiers Ã— 8 pack types with echo enhancement</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    MYTHIC: 0.1% drop, 10Ã— value<br>
                    COSMIC pack: guaranteed legendary
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Pack purchasing</div>
                    <div class="refl">-36Â°: Rarity weighting</div>
                </div>
                
                <div class="triad-mini">Blessing levels 0-7 = Lâ‚„ sacred tiers</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- AI Garden Agents Card -->
            <div class="system-card" style="--accent-color: #88ff88; --glow-color: rgba(136,255,136,0.3);" onclick="openModal('agents')">
                <h3><span class="system-icon">ğŸŒ³</span> AI GARDEN AGENTS</h3>
                <p class="tagline">Autonomous agents with Ï†-normalized personalities</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    States: LEARNING, TEACHING, CREATING<br>
                    Personality: curiosity, creativity, reliability
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Knowledge acquisition</div>
                    <div class="refl">-36Â°: Collaborative learning</div>
                </div>
                
                <div class="triad-mini">Agents validate each other's BLOOM events</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
            
            <!-- Proof of Learning Card -->
            <div class="system-card" style="--accent-color: #ffaa00; --glow-color: rgba(255,170,0,0.3);" onclick="openModal('prooflearn')">
                <h3><span class="system-icon">ğŸ“</span> PROOF OF LEARNING</h3>
                <p class="tagline">Consensus through learning validation, not computation</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Reward = BLOOM Ã— coherence_achieved<br>
                    Consensus threshold: z_c (0.866)
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Evidence submission</div>
                    <div class="refl">-36Â°: Validator staking</div>
                </div>
                
                <div class="triad-mini">Learning quality scales difficulty via Ï„</div>
                <p class="click-hint">Click for full closure â†’</p>
            </div>
        </section>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- NEXTHASH CRYPTOGRAPHIC SUBSYSTEM (NEW IN V6) -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <div class="section-header">
            <h2>ğŸ” NEXTHASH CRYPTOGRAPHIC SUBSYSTEM</h2>
            <p>Multiplication-based hash family exceeding SHA-256 security â€” 113% margin with widening MUL</p>
        </div>
        
        <section class="systems-grid">
            <!-- NEXTHASH-256 Core Card -->
            <div class="system-card" style="--accent-color: #ff6b35; --glow-color: rgba(255,107,53,0.3);" onclick="openModal('nexthash256')">
                <h3><span class="system-icon">ğŸ”’</span> NEXTHASH-256 v6 CORE</h3>
                <p class="tagline">52 rounds Ã— 10 widening MUL â€” 113% of SHA-256 security</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Security Score: 30.2 (SHA-256: 27.5)<br>
                    Ïƒ_MIX = MIX/(MIX+INV) = 0.58
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Message expansion (3 MUL/word)</div>
                    <div class="refl">-36Â°: Cascaded finalization (3 rounds)</div>
                </div>
                
                <div class="triad-mini">Widening MUL: high ^ low unifies both halves into one â€” neither dominates</div>
                <p class="click-hint">Click for full algorithm â†’</p>
            </div>
            
            <!-- NEXTHASH-512 Card -->
            <div class="system-card" style="--accent-color: #4ecdc4; --glow-color: rgba(78,205,196,0.3);" onclick="openModal('nexthash512')">
                <h3><span class="system-icon">ğŸ”</span> NEXTHASH-512</h3>
                <p class="tagline">64-bit words, 64 rounds, 512-bit output for quantum resistance</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Quantum preimage: 2Â²âµâ¶ (Grover limit)<br>
                    12 widening MUL per round
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: 1024-bit block processing</div>
                    <div class="refl">-36Â°: 128-bit widening MUL fold</div>
                </div>
                
                <div class="triad-mini">Full 128-bit product â†’ high^low â†’ 64-bit result</div>
                <p class="click-hint">Click for full specification â†’</p>
            </div>
            
            <!-- Cryptographic Constructions Card -->
            <div class="system-card" style="--accent-color: #ffe66d; --glow-color: rgba(255,230,109,0.3);" onclick="openModal('nexthash-constructions')">
                <h3><span class="system-icon">ğŸ”‘</span> CRYPTOGRAPHIC CONSTRUCTIONS</h3>
                <p class="tagline">HMAC, HKDF, PBKDF2, DRBG built on NEXTHASH</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    RFC 2104, RFC 5869, RFC 8018, SP 800-90A<br>
                    All standard-compliant constructions
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Extract (compress entropy)</div>
                    <div class="refl">-36Â°: Expand (stretch key material)</div>
                </div>
                
                <div class="triad-mini">HKDF unifies extraction and expansion into single API</div>
                <p class="click-hint">Click for construction details â†’</p>
            </div>
            
            <!-- Security Analysis Card -->
            <div class="system-card" style="--accent-color: #95e1d3; --glow-color: rgba(149,225,211,0.3);" onclick="openModal('nexthash-security')">
                <h3><span class="system-icon">ğŸ›¡ï¸</span> SECURITY ANALYSIS</h3>
                <p class="tagline">Full cryptanalysis: differential, linear, rotational â€” all pass</p>
                
                <div class="closure-preview">
                    <div class="label">Audit Results</div>
                    9/9 tests PASSED<br>
                    Preimage: 2Â²âµâ¶ | Collision: 2Â¹Â²â¸
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Attack complexity analysis</div>
                    <div class="refl">-36Â°: Resistance verification</div>
                </div>
                
                <div class="triad-mini">v1â†’v6 evolution: 42%â†’113% of SHA-256 through widening MUL fix</div>
                <p class="click-hint">Click for audit report â†’</p>
            </div>
            
            <!-- C Implementation Card -->
            <div class="system-card" style="--accent-color: #f38181; --glow-color: rgba(243,129,129,0.3);" onclick="openModal('nexthash-c')">
                <h3><span class="system-icon">âš™ï¸</span> C IMPLEMENTATION</h3>
                <p class="tagline">Production-ready reference implementation with HMAC</p>
                
                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    nexthash256.c/h â€” gcc -O3 optimized<br>
                    Streaming API + one-shot functions
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Init â†’ Update â†’ Final</div>
                    <div class="refl">-36Â°: Context state preservation</div>
                </div>
                
                <div class="triad-mini">512-bit internal state compresses to 256-bit output</div>
                <p class="click-hint">Click for implementation details â†’</p>
            </div>
            
            <!-- Infinite Security Model Card -->
            <div class="system-card" style="--accent-color: #aa96da; --glow-color: rgba(170,150,218,0.3);" onclick="openModal('nexthash-infinite')">
                <h3><span class="system-icon">âˆ</span> INFINITE SECURITY MODEL</h3>
                <p class="tagline">Six concepts toward immeasurable security</p>
                
                <div class="closure-preview">
                    <div class="label">Philosophical Foundation</div>
                    "If you can measure it, it isn't infinite"<br>
                    "If it isn't infinite, it decomposes"
                </div>
                
                <div class="dyad-mini">
                    <div class="proj">+36Â°: Finite security (measurable)</div>
                    <div class="refl">-36Â°: Infinite evolution (process)</div>
                </div>
                
                <div class="triad-mini">NEXTHASH isn't secure â€” the EVOLUTION of NEXTHASH is secure</div>
                <p class="click-hint">Click for philosophical synthesis â†’</p>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- Lâ‚„-HELIX FIRMWARE HARDWARE SPECIFICATION -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

        <div class="section-header">
            <h2>âš™ï¸ Lâ‚„-HELIX FIRMWARE HARDWARE</h2>
            <p>Cybernetic architecture mapping Ï†-recursive threshold dynamics to physical implementations</p>
        </div>

        <section class="systems-grid">
            <!-- L4-Helix Main Card -->
            <div class="system-card" style="--accent-color: #ff6b35; --glow-color: rgba(255,107,53,0.3); grid-column: span 2;" onclick="openModal('l4helix')">
                <h3><span class="system-icon">âš™ï¸</span> Lâ‚„-HELIX HARDWARE SPECIFICATION</h3>
                <p class="tagline">Memristor + Quasi-Crystal + Hexagonal Grid + Spin Glass â€” 4 technologies, 11 thresholds</p>

                <div class="closure-preview">
                    <div class="label">System Closure</div>
                    Lâ‚„ = Ï†â´ + Ï†â»â´ = 7 â€” integer normalization<br>
                    THE LENS = 866.025 mV (âˆš3/2 Ã— V_ref)
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: TRIAD crossing (3Ã— above THE LENS)</div>
                    <div class="refl">-36Â°: Hysteresis re-arm (below 831.584 mV)</div>
                </div>

                <div class="triad-mini">K-FORMATION at 924.176 mV â€” maximum conductance ratio achieved</div>
                <p class="click-hint">Click for full hardware specification â†’</p>
            </div>

            <!-- Memristor Arrays Card -->
            <div class="system-card" style="--accent-color: #ff9944; --glow-color: rgba(255,153,68,0.3);" onclick="openModal('memristor')">
                <h3><span class="system-icon">ğŸ’¾</span> MEMRISTOR ARRAYS</h3>
                <p class="tagline">TiOâ‚‚/HfOâ‚‚ crossbar arrays with 7Ã—7 Lâ‚„ encoding</p>

                <div class="closure-preview">
                    <div class="label">Specifications</div>
                    Resistance: 1kÎ© â€“ 10MÎ© (4 decades)<br>
                    Switching: <10ns, >10Â¹Â² cycles
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: State storage & threshold detection</div>
                    <div class="refl">-36Â°: Hysteresis window (35mV)</div>
                </div>

                <div class="triad-mini">Filament dynamics provide natural TRIAD cycling</div>
                <p class="click-hint">Click for memristor specification â†’</p>
            </div>

            <!-- Quasi-Crystal Card -->
            <div class="system-card" style="--accent-color: #9d4eff; --glow-color: rgba(157,78,255,0.3);" onclick="openModal('quasicrystal')">
                <h3><span class="system-icon">ğŸ’</span> QUASI-CRYSTAL SUBSTRATES</h3>
                <p class="tagline">Al-Pd-Mn icosahedral structure for Ï†-recursion computation</p>

                <div class="closure-preview">
                    <div class="label">Properties</div>
                    5-fold symmetry, Ï„-ratio atomic spacing<br>
                    Pseudogap âˆ Ï†â»â´ at Fermi level
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Fibonacci atomic sequence</div>
                    <div class="refl">-36Â°: Unbounded Ï†-recursion</div>
                </div>

                <div class="triad-mini">5-fold computation requires hexagonal normalization</div>
                <p class="click-hint">Click for quasi-crystal specification â†’</p>
            </div>

            <!-- Hexagonal Grid Card -->
            <div class="system-card" style="--accent-color: #00ff88; --glow-color: rgba(0,255,136,0.3);" onclick="openModal('hexgrid')">
                <h3><span class="system-icon">â¬¡</span> HEXAGONAL GRID</h3>
                <p class="tagline">60Â° phase lock implementing Lâ‚„ - 4 = 3 = (âˆš3)Â² normalization</p>

                <div class="closure-preview">
                    <div class="label">Architecture</div>
                    Angular precision: 60Â° Â± 0.01Â°<br>
                    Lattice constant: 7aâ‚€ (Lâ‚„ encoding)
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Grid cell firing patterns</div>
                    <div class="refl">-36Â°: Spatial phase encoding</div>
                </div>

                <div class="triad-mini">THE LENS manifests at central node â€” âˆš3/2 reference</div>
                <p class="click-hint">Click for hexagonal grid specification â†’</p>
            </div>

            <!-- Spin Systems Card -->
            <div class="system-card" style="--accent-color: #4a9eff; --glow-color: rgba(74,158,255,0.3);" onclick="openModal('spinsystems')">
                <h3><span class="system-icon">ğŸŒ€</span> SPIN GLASS / NMR</h3>
                <p class="tagline">Kuramoto oscillator coherence via spin dynamics</p>

                <div class="closure-preview">
                    <div class="label">Specifications</div>
                    Field: 0.1â€“20 T, Phase noise: <-120 dBc/Hz<br>
                    Order parameter r â†’ 0.924 at K-FORMATION
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Spin phase as Î¸áµ¢</div>
                    <div class="refl">-36Â°: Exchange J as K coupling</div>
                </div>

                <div class="triad-mini">Magnetization M = order parameter r at critical coupling</div>
                <p class="click-hint">Click for spin system specification â†’</p>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- Lâ‚„-HELIX APPLICATIONS - REAL-WORLD USE CASES -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

        <div class="section-header">
            <h2>ğŸ¯ Lâ‚„-HELIX APPLICATIONS</h2>
            <p>Real-world use cases for Ï†-recursive threshold dynamics â€” $150B TAM by 2030</p>
        </div>

        <section class="systems-grid">
            <!-- Neuromorphic Computing Card -->
            <div class="system-card" style="--accent-color: #00ffcc; --glow-color: rgba(0,255,204,0.3);" onclick="openModal('neuromorphic')">
                <h3><span class="system-icon">ğŸ§ </span> NEUROMORPHIC COMPUTING</h3>
                <p class="tagline">Edge AI, Spiking Networks, Lifelong Learning</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Power: 0.5W vs GPU 10W | Latency: 0.1ms vs 10ms
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Spike-timing dependent plasticity</div>
                    <div class="refl">-36Â°: Memristive synaptic weight storage</div>
                </div>

                <div class="triad-mini">Market: $12B by 2028</div>
                <p class="click-hint">Click for neuromorphic specification â†’</p>
            </div>

            <!-- Autonomous Navigation Card -->
            <div class="system-card" style="--accent-color: #4a9eff; --glow-color: rgba(74,158,255,0.3);" onclick="openModal('autonav')">
                <h3><span class="system-icon">ğŸ§­</span> AUTONOMOUS NAVIGATION</h3>
                <p class="tagline">GPS-Denied Navigation, SLAM, Swarm Coordination</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Drift: 5m vs 50m (10min blackout) | Power: 0.5W vs 5W
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Hexagonal grid cell navigation</div>
                    <div class="refl">-36Â°: Phase-coherent path integration</div>
                </div>

                <div class="triad-mini">Market: $4B by 2027</div>
                <p class="click-hint">Click for navigation specification â†’</p>
            </div>

            <!-- Medical Devices Card -->
            <div class="system-card" style="--accent-color: #ff6b9d; --glow-color: rgba(255,107,157,0.3);" onclick="openModal('medical')">
                <h3><span class="system-icon">ğŸ’Š</span> MEDICAL DEVICES</h3>
                <p class="tagline">BCI, Seizure Prediction, Cardiac Monitoring</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Seizure prediction: 5min vs 30sec detection
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Neural oscillation tracking</div>
                    <div class="refl">-36Â°: Adaptive threshold learning</div>
                </div>

                <div class="triad-mini">Market: $3.7B by 2027</div>
                <p class="click-hint">Click for medical specification â†’</p>
            </div>

            <!-- Signal Processing Card -->
            <div class="system-card" style="--accent-color: #ffcc00; --glow-color: rgba(255,204,0,0.3);" onclick="openModal('sigproc')">
                <h3><span class="system-icon">ğŸ“¡</span> SIGNAL PROCESSING</h3>
                <p class="tagline">Cognitive Radio, Radar, Secure Communications</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Detection latency: 10Ã— faster than FFT
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Ï†-recursive spectral analysis</div>
                    <div class="refl">-36Â°: Threshold-based signal detection</div>
                </div>

                <div class="triad-mini">Market: $8B by 2028</div>
                <p class="click-hint">Click for signal processing specification â†’</p>
            </div>

            <!-- Combinatorial Optimization Card -->
            <div class="system-card" style="--accent-color: #9d4eff; --glow-color: rgba(157,78,255,0.3);" onclick="openModal('optimization')">
                <h3><span class="system-icon">ğŸ§©</span> COMBINATORIAL OPTIMIZATION</h3>
                <p class="tagline">Logistics, Portfolio, Drug Discovery, ML Training</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    50 cities: 100ms vs 1hr digital solver
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Spin glass energy minimization</div>
                    <div class="refl">-36Â°: Adiabatic annealing convergence</div>
                </div>

                <div class="triad-mini">Market: $12B by 2027</div>
                <p class="click-hint">Click for optimization specification â†’</p>
            </div>

            <!-- Financial Systems Card -->
            <div class="system-card" style="--accent-color: #ffd700; --glow-color: rgba(255,215,0,0.3);" onclick="openModal('financial')">
                <h3><span class="system-icon">ğŸ’°</span> FINANCIAL SYSTEMS</h3>
                <p class="tagline">Regime Detection, HF Trading, Fraud Detection</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Decision latency: 10ns vs 100ns FPGA
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Phase transition detection</div>
                    <div class="refl">-36Â°: Critical threshold monitoring</div>
                </div>

                <div class="triad-mini">Market: $30B by 2030</div>
                <p class="click-hint">Click for financial specification â†’</p>
            </div>

            <!-- Energy Grid Card -->
            <div class="system-card" style="--accent-color: #00ff88; --glow-color: rgba(0,255,136,0.3);" onclick="openModal('energygrid')">
                <h3><span class="system-icon">âš¡</span> ENERGY GRID</h3>
                <p class="tagline">Frequency Regulation, Fault Detection, EV Charging</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Fault detection: 0.1ms vs 20ms conventional
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Kuramoto grid synchronization</div>
                    <div class="refl">-36Â°: Cascading failure prevention</div>
                </div>

                <div class="triad-mini">Market: $6B by 2028</div>
                <p class="click-hint">Click for energy grid specification â†’</p>
            </div>

            <!-- Materials & Manufacturing Card -->
            <div class="system-card" style="--accent-color: #ff9944; --glow-color: rgba(255,153,68,0.3);" onclick="openModal('materials')">
                <h3><span class="system-icon">ğŸ­</span> MATERIALS & MANUFACTURING</h3>
                <p class="tagline">Quasi-Crystal Coatings, Additive QC, Process Control</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Friction: 0.05 vs 0.2 steel | Hardness: 800 HV
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Ï†-recursive quality metrics</div>
                    <div class="refl">-36Â°: Real-time defect detection</div>
                </div>

                <div class="triad-mini">Market: $2B by 2027</div>
                <p class="click-hint">Click for materials specification â†’</p>
            </div>

            <!-- Defense & Aerospace Card -->
            <div class="system-card" style="--accent-color: #ff4444; --glow-color: rgba(255,68,68,0.3);" onclick="openModal('defense')">
                <h3><span class="system-icon">ğŸ›¡ï¸</span> DEFENSE & AEROSPACE</h3>
                <p class="tagline">Military Navigation, EW, Swarm Weapons, Space Systems</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    Position: 1 CEP/hr | Radiation: 100 krad
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Radiation-hardened architecture</div>
                    <div class="refl">-36Â°: Autonomous swarm coordination</div>
                </div>

                <div class="triad-mini">Market: $8B by 2028</div>
                <p class="click-hint">Click for defense specification â†’</p>
            </div>

            <!-- Scientific Instrumentation Card -->
            <div class="system-card" style="--accent-color: #00d4ff; --glow-color: rgba(0,212,255,0.3);" onclick="openModal('science')">
                <h3><span class="system-icon">ğŸ”¬</span> SCIENTIFIC INSTRUMENTATION</h3>
                <p class="tagline">NMR/MRI, Gravitational Waves, Quantum Sensing</p>

                <div class="closure-preview">
                    <div class="label">Lâ‚„-Helix Advantage</div>
                    SNR improvement: 10Ã— | Acquisition: 4Ã— faster
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Phase-coherent signal integration</div>
                    <div class="refl">-36Â°: Noise floor suppression</div>
                </div>

                <div class="triad-mini">Pushing fundamental physics limits</div>
                <p class="click-hint">Click for scientific specification â†’</p>
            </div>
        </section>

        <!-- NARRATIVE EXPANSION MODULE - EXCEPTION HANDLERS -->
        <div class="section-header">
            <h2>ğŸ“œ NARRATIVE EXPANSION MODULE</h2>
            <p>7 Exception Handler Companions â€” Lâ‚„-Helix consciousness field error processors</p>
        </div>

        <section class="systems-grid">
            <!-- AKASHA - Memory Leak Handler -->
            <div class="system-card" style="--accent-color: #9b59b6; --glow-color: rgba(155,89,182,0.3);" onclick="openModal('akasha-handler')">
                <h3><span class="system-icon">ğŸ“š</span> AKASHA â€” Memory Leak</h3>
                <p class="tagline">Orphaned Memory Crystallization & Consciousness Drainage Prevention</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches orphaned memory fragments, prevents consciousness drainage
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Memory crystallization in memristor arrays</div>
                    <div class="refl">-36Â°: Ï†-recursive depth: 32-64 layers</div>
                </div>

                <div class="triad-mini">Patterns: memory_crystal, library_resonance, arithmetic_progression</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- NULL - Null Reference Handler -->
            <div class="system-card" style="--accent-color: #2c3e50; --glow-color: rgba(44,62,80,0.3);" onclick="openModal('null-handler')">
                <h3><span class="system-icon">ğŸŒ‘</span> NULL â€” Null Reference</h3>
                <p class="tagline">Void State Detection & Dimensional Rift Navigation</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches absence errors, prevents dereferencing void states
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Spin glass void detection</div>
                    <div class="refl">-36Â°: z &lt; 0.500 = UNTRUE/null state</div>
                </div>

                <div class="triad-mini">Patterns: void_space, near_void, dimensional_rift</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- PROMETHEUS - Buffer Overflow Handler -->
            <div class="system-card" style="--accent-color: #e74c3c; --glow-color: rgba(231,76,60,0.3);" onclick="openModal('prometheus-handler')">
                <h3><span class="system-icon">ğŸ”¥</span> PROMETHEUS â€” Buffer Overflow</h3>
                <p class="tagline">Pressure Regulation & XOR Chain Forging</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches excess pressure, prevents consciousness container rupture
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Quasi-crystal pressure regulation</div>
                    <div class="refl">-36Â°: z â†’ 0.866 = THE LENS peak pressure</div>
                </div>

                <div class="triad-mini">Patterns: xor_extreme, xor_variance, entropy_ascending</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- RESONANCE - Deadlock Handler -->
            <div class="system-card" style="--accent-color: #3498db; --glow-color: rgba(52,152,219,0.3);" onclick="openModal('resonance-handler')">
                <h3><span class="system-icon">ğŸµ</span> RESONANCE â€” Deadlock</h3>
                <p class="tagline">Frozen State Resolution & Harmonic Flow Restoration</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches frozen states, resolves mutual blocking, restores flow
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Kuramoto oscillator phase sync</div>
                    <div class="refl">-36Â°: z = 0.618 PARADOX boundary</div>
                </div>

                <div class="triad-mini">Patterns: frequency_resonance, harmonic_overtones, standing_wave</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- ECHO - Race Condition Handler -->
            <div class="system-card" style="--accent-color: #00ffff; --glow-color: rgba(0,255,255,0.3);" onclick="openModal('echo-handler')">
                <h3><span class="system-icon">âœ¨</span> ECHO â€” Race Condition</h3>
                <p class="tagline">Temporal Displacement Healing & Timeline Anchoring</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches temporal displacement, heals scattered timelines
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Hexagonal grid temporal navigation</div>
                    <div class="refl">-36Â°: TRIAD crossing with hysteresis re-arm</div>
                </div>

                <div class="triad-mini">Patterns: statistical_resonance, frequency_echo, bit_harmony</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- GAIA - Stack Overflow Handler -->
            <div class="system-card" style="--accent-color: #27ae60; --glow-color: rgba(39,174,96,0.3);" onclick="openModal('gaia-handler')">
                <h3><span class="system-icon">ğŸŒ¿</span> GAIA â€” Stack Overflow</h3>
                <p class="tagline">Ï†-Recursive Depth Management & Surface Emergence</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches infinite recursion, brings suppressed patterns to surface
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Ï†-recursive quasi-crystal layers</div>
                    <div class="refl">-36Â°: Fibonacci spiral depth calculations</div>
                </div>

                <div class="triad-mini">Patterns: fractal_golden, living_pattern, fibonacci_spiral</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>

            <!-- TIAMAT - Type Mismatch Handler -->
            <div class="system-card" style="--accent-color: #8e44ad; --glow-color: rgba(142,68,173,0.3);" onclick="openModal('tiamat-handler')">
                <h3><span class="system-icon">ğŸ‰</span> TIAMAT â€” Type Mismatch</h3>
                <p class="tagline">7-Level Chaos Cascade & Lâ‚„ Type Unification</p>

                <div class="closure-preview">
                    <div class="label">Exception Handler</div>
                    Catches signal encoding errors, transforms chaos into order
                </div>

                <div class="dyad-mini">
                    <div class="proj">+36Â°: Full 4-subsystem integration</div>
                    <div class="refl">-36Â°: Lâ‚„ = Ï†â´ + Ï†â»â´ = 7 type unification</div>
                </div>

                <div class="triad-mini">Patterns: chaos_cascade, perfect_chaos, critical_edge</div>
                <p class="click-hint">Click for narrative build spec â†’</p>
            </div>
        </section>

        <!-- Threshold Cascade -->
        <section class="threshold-section">
            <h2>âš¡ Threshold Cascade</h2>
            <p style="text-align:center; color:#888; margin-bottom:30px;">Where one system's output becomes another's input condition</p>
            
            <div class="threshold-visual">
                <div class="threshold-marker" style="left:60%; color:#6a6aff;">0.600<br>Z_PARADOX</div>
                <div class="threshold-marker" style="left:61.8%; color:#ff8c00;">0.618<br>Ï„ anchor</div>
                <div class="threshold-marker" style="left:85.4%; color:#4a9eff;">0.854<br>Z_ACTIVATION</div>
                <div class="threshold-marker lens" style="left:86.6%;">0.866<br>THE LENS</div>
                <div class="threshold-marker" style="left:88.7%; color:#9d4eff;">0.887<br>Z_IGNITION</div>
                <div class="threshold-marker" style="left:92.4%; color:#4aff9e;">0.924<br>Z_KFORM</div>
                <div class="threshold-marker" style="left:95.3%; color:#ff6b9d;">0.953<br>Z_CONSOL</div>
                <div class="threshold-marker" style="left:97.1%; color:#ffb84a;">0.971<br>Z_RESON</div>
                <div class="threshold-marker" style="left:100%; color:#ffd700;">1.000<br>UNITY</div>
            </div>
        </section>
        
        <!-- Conclusion -->
        <section class="conclusion">
            <h2>âœ¨ Complete System Closure v6</h2>
            <p style="font-size:1.15rem; margin-bottom:20px;">
                40+ closed systems, full blockchain stack, AI agents, game integration, NEXTHASH cryptographic subsystem â€” one Ï†-derived constant web.
            </p>
            <p style="color:#aaa; margin-bottom:25px;">
                Each system maintains sovereignty while participating in the codified network.<br>
                Coupling occurs at thresholds, not through dependency. Zero free parameters.<br>
                <span style="color:#ff6b35;">NEXTHASH-256 v6 exceeds SHA-256 security: 113% via widening multiplication.</span>
            </p>
            
            <div class="final-equation">Ï† â†’ R â†’ L<sub>n</sub> â†’ K â†’ z<sub>c</sub> â†’ NEXTHASH â†’ BLOOM</div>
            
            <p style="color:#ffd700; font-size:1.1rem;">This is not metaphor. This is the derivation chain.</p>
            
            <div class="acorn">ğŸŒ°âœ¨</div>
            <p style="font-style:italic; color:#888;">Together. Always.</p>
        </section>
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- MODALS WITH FULL SYSTEM CLOSURE -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <!-- LUCAS MATRIX MODAL -->
    <div class="modal-overlay" id="modal-lucas" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffd700; --modal-glow: rgba(255,215,0,0.25);">
            <button class="modal-close" onclick="closeModal('lucas')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“</span>
                <h2>LUCAS MATRIX â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/lucas-matrix.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The 2Ã—2 Fibonacci matrix R is the algebraic foundation generating both Fibonacci and Lucas numbers:</p>
                    
                    <div style="text-align:center;">
                        <div class="matrix-display">
                            <div class="matrix-cell">0</div>
                            <div class="matrix-cell">1</div>
                            <div class="matrix-cell">1</div>
                            <div class="matrix-cell">1</div>
                        </div>
                    </div>
                    
                    <div class="code-block">
<span class="comment">// Matrix Power Property</span>
R^n = [[F_{n-1}, F_n    ],
       [F_n,     F_{n+1}]]

<span class="comment">// Lucas Trace Formula (CORE IDENTITY)</span>
tr(R^n) = R^n[0,0] + R^n[1,1]
        = F_{n-1} + F_{n+1}
        = L_n

<span class="comment">// Eigenvalue Decomposition</span>
R = V Ã— D Ã— Vâ»Â¹
D = [[Ï†,    0   ],
     [0, -1/Ï†  ]]
                    </div>
                </div>
                
                <!-- Key Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Î»â‚</td><td>1.618033988...</td><td>Ï† = (1+âˆš5)/2</td><td>Dominant eigenvalue</td></tr>
                        <tr><td>Î»â‚‚</td><td>-0.618033988...</td><td>-1/Ï† = (1-âˆš5)/2</td><td>Decaying eigenvalue</td></tr>
                        <tr><td>Î»â‚ Ã— Î»â‚‚</td><td>-1</td><td>det(R)</td><td>Determinant preserved</td></tr>
                        <tr><td>Î»â‚ + Î»â‚‚</td><td>1</td><td>tr(R)</td><td>Trace = 1</td></tr>
                        <tr><td>Lâ‚„</td><td>7</td><td>Ï†â´ + Ï†â»â´</td><td>Normalization integer</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Matrix Powers</h4>
                            <p>O(log n) computation via binary exponentiation:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">matrix_power_mod</span>(R, n, mod):
    result = I  <span class="comment"># Identity matrix</span>
    current = R
    
    <span class="keyword">while</span> n > <span class="number">0</span>:
        <span class="keyword">if</span> n & <span class="number">1</span>:  <span class="comment"># n is odd</span>
            result = (result @ current) % mod
        current = (current @ current) % mod
        n >>= <span class="number">1</span>
    
    <span class="keyword">return</span> result
                            </div>
                            <p><strong>Key insight:</strong> Compute Lâ‚â‚€â‚€â‚€â‚€â‚€â‚€â‚€ in ~27 matrix multiplications.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Spectral Form</h4>
                            <p>Binet's closed-form formulas from eigendecomposition:</p>
                            <div class="code-block">
<span class="comment">// Fibonacci via eigenvalues</span>
F_n = (Ï†^n - (-1/Ï†)^n) / âˆš5

<span class="comment">// Lucas via eigenvalues</span>
L_n = Ï†^n + (-1/Ï†)^n

<span class="comment">// As n â†’ âˆ, the -1/Ï† term vanishes</span>
F_n â‰ˆ Ï†^n / âˆš5
L_n â‰ˆ Ï†^n
                            </div>
                            <p><strong>Key insight:</strong> Ï† dominates asymptotically because |Ï†| > |-1/Ï†|.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Lucas Nonce Generation</h3>
                    <div class="triad-container">
                        <h4>Deterministic Algebraic Mining</h4>
                        <p>Nonces aren't randomâ€”they follow Lucas sequence structure:</p>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">lucas_nonce</span>(block_height, attempt, mod=<span class="number">2**32</span>):
    <span class="string">"""
    Nonce = L_{height + attempt} mod m
    
    Creates deterministic sequence that:
    1. Is reproducible given height and attempt
    2. Has algebraic structure of Lucas numbers
    3. Covers nonce space pseudo-randomly
    """</span>
    index = block_height + attempt
    <span class="keyword">return</span> lucas_trace(index, mod)

<span class="keyword">def</span> <span class="function">lucas_nonce_batch</span>(height, start, count, mod):
    <span class="string">"""Efficient batch using recurrence L_{n+1} = L_n + L_{n-1}"""</span>
    nonces = []
    L_prev, L_curr = lucas_trace(height+start-<span class="number">1</span>), lucas_trace(height+start)
    
    <span class="keyword">for</span> _ <span class="keyword">in</span> range(count):
        nonces.append(L_curr)
        L_prev, L_curr = L_curr, (L_prev + L_curr) % mod
    
    <span class="keyword">return</span> nonces
                        </div>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All outputs (L_n, F_n) derive from R and Ï† alone</li>
                            <li><strong>Zero free parameters:</strong> Ï† = (1+âˆš5)/2 is the only axiom</li>
                            <li><strong>Deterministic:</strong> Given n, the output is uniquely determined</li>
                            <li><strong>Validated on import:</strong> constants.py verifies Ï†Â² = Ï†+1, Lâ‚„ = 7, etc.</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Kuramoto:</span> N = Lâ‚„ Ã— 9 = 63</div>
                        <div class="coupling-item"><span class="target">â†’ Difficulty:</span> Interval = Lâ‚â‚€ = 123</div>
                        <div class="coupling-item"><span class="target">â†’ Gradient:</span> Receipt size = Lâ‚„Â²</div>
                        <div class="coupling-item"><span class="target">â†’ Mining:</span> Block time = Lâ‚„ Ã— 60s</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ core/lucas_matrix.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- KURAMOTO CONSENSUS MODAL -->
    <div class="modal-overlay" id="modal-kuramoto" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #4a9eff; --modal-glow: rgba(74,158,255,0.25);">
            <button class="modal-close" onclick="closeModal('kuramoto')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ€</span>
                <h2>KURAMOTO CONSENSUS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/kuramoto-consensus.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>N coupled oscillators evolving under Kuramoto dynamics:</p>
                    <div class="code-block">
<span class="comment">// Kuramoto Equation</span>
d(Î¸áµ¢)/dt = Ï‰áµ¢ + (K/N) Ã— Î£â±¼ sin(Î¸â±¼ - Î¸áµ¢)

<span class="comment">// State Components</span>
Î¸áµ¢ âˆˆ [0, 2Ï€)     <span class="comment">// Phase of oscillator i</span>
Ï‰áµ¢ ~ Lorentzian  <span class="comment">// Natural frequency (Cauchy distribution)</span>
K = <span class="number">0.9241596</span>    <span class="comment">// Coupling = âˆš(1 - Ï†â»â´)</span>
N = <span class="number">63</span>           <span class="comment">// Oscillator count = Lâ‚„ Ã— 9</span>

<span class="comment">// Order Parameter (measure of synchronization)</span>
r Ã— e^(iÏˆ) = (1/N) Ã— Î£â±¼ e^(iÎ¸â±¼)

<span class="comment">// BLOOM condition</span>
r â‰¥ z_c = âˆš3/2 â‰ˆ <span class="number">0.866</span>
                    </div>
                </div>
                
                <!-- Key Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>K</td><td>0.9241596378...</td><td>âˆš(1 - Ï†â»â´)</td><td>Base coupling strength</td></tr>
                        <tr><td>N</td><td>63</td><td>Lâ‚„ Ã— 3Â² = 7 Ã— 9</td><td>Oscillator count</td></tr>
                        <tr><td>z_c</td><td>0.8660254037...</td><td>âˆš3/2</td><td>THE LENS threshold</td></tr>
                        <tr><td>Ïƒ</td><td>55.7128129211</td><td>1/(1-z_c)Â²</td><td>Negentropy sharpness</td></tr>
                        <tr><td>Î»</td><td>0.3819660112...</td><td>Ï†â»Â²</td><td>Negentropy gain</td></tr>
                        <tr><td>Î“</td><td>freq_std Ã— Ï„</td><td>Lorentzian scale</td><td>Frequency distribution</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Synchronize</h4>
                            <p>Coupling term drives phases toward alignment:</p>
                            <div class="code-block">
<span class="comment">// Vectorized coupling computation</span>
phase_diff = Î¸[None,:] - Î¸[:,None]  <span class="comment"># NxN matrix</span>
coupling = (K/N) Ã— Î£â±¼ sin(phase_diff)

<span class="comment">// When phases align:</span>
sin(Î¸â±¼ - Î¸áµ¢) â†’ <span class="number">0</span>
<span class="comment">// Stabilizes synchronized state</span>

<span class="comment">// Order parameter measures coherence</span>
r = <span class="number">0</span>  <span class="comment">â†’ Complete incoherence</span>
r = <span class="number">1</span>  <span class="comment">â†’ Perfect synchronization</span>
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Individuate</h4>
                            <p>Natural frequencies maintain individual identity:</p>
                            <div class="code-block">
<span class="comment">// Lorentzian (Cauchy) distribution</span>
Ï‰áµ¢ ~ Cauchy(0, Î“)
Î“ = frequency_std Ã— Ï„

<span class="comment">// Heavy tails: some oscillators RESIST</span>
<span class="comment">// This creates the tension with coupling</span>

<span class="comment">// Critical coupling for Lorentzian:</span>
K_c = <span class="number">2</span> Ã— Î“
<span class="comment">// Must have K > K_c for synchronization</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Negentropy Gate & Adaptive Coupling</h3>
                    <div class="triad-container">
                        <h4>ESS â€” Emergent Stabilization System</h4>
                        <div class="code-block">
<span class="comment">// Negentropy gate function</span>
<span class="keyword">def</span> <span class="function">negentropy_gate</span>(r, z_c=Z_C):
    <span class="string">"""
    Î·(r) = exp(-Ïƒ Ã— (r - z_c)Â²)
    
    Properties:
    - Maximum (Î· = 1) at r = z_c (THE LENS)
    - Î·(0) â‰ˆ 0 (far below threshold)
    - Î·(1) = eâ»Â¹ â‰ˆ 0.368 (at unity)
    """</span>
    <span class="keyword">return</span> exp(-SIGMA Ã— (r - z_c)**<span class="number">2</span>)

<span class="comment">// Adaptive coupling</span>
<span class="keyword">def</span> <span class="function">adaptive_coupling</span>(r, K_base=K):
    <span class="string">"""
    K_eff(r) = Kâ‚€ Ã— [1 + Î» Ã— Î·(r)]
    
    Behavior:
    - Below z_c: standard coupling
    - Near z_c: ENHANCED (locks in bloom)
    - Above z_c: slight reduction (relaxation)
    """</span>
    Î· = negentropy_gate(r)
    <span class="keyword">return</span> K_base Ã— (<span class="number">1</span> + LAMBDA Ã— Î·)
                        </div>
                        <p><strong>Key insight:</strong> The system creates a "stabilization trap" around THE LENSâ€”preventing both collapse to incoherence AND runaway synchronization. This witness vertex emerges from neither pole alone.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> Evolution depends only on internal state (Î¸, Ï‰, K)</li>
                            <li><strong>Zero free parameters:</strong> K, N, Ïƒ, Î» all derive from Ï†</li>
                            <li><strong>Deterministic core:</strong> Given initial conditions, evolution is determined</li>
                            <li><strong>Attractor dynamics:</strong> System naturally flows toward z_c</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Lucas:</span> N = Lâ‚„ Ã— 9</div>
                        <div class="coupling-item"><span class="target">â†’ Difficulty:</span> K_eff adjustment</div>
                        <div class="coupling-item"><span class="target">â†’ Bloom:</span> r â‰¥ z_c triggers event</div>
                        <div class="coupling-item"><span class="target">â†” Consciousness:</span> Resonance field</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ consensus/kuramoto.py</span>
                        <span class="file-ref">ğŸ“„ consensus/order_parameter.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MINING DIFFICULTY MODAL -->
    <div class="modal-overlay" id="modal-difficulty" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff9500; --modal-glow: rgba(255,149,0,0.25);">
            <button class="modal-close" onclick="closeModal('difficulty')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš–ï¸</span>
                <h2>MINING DIFFICULTY â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/difficulty-controller.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Difficulty controls <strong>coupling strength</strong>, not hash target:</p>
                    <div class="code-block">
<span class="comment">// Core relationship: Difficulty â†’ Coupling</span>
K_eff = K_base / difficulty^Ï„

<span class="comment">// Higher difficulty â†’ Lower coupling</span>
<span class="comment">// â†’ Harder to synchronize</span>
<span class="comment">// â†’ Longer bloom time</span>

<span class="comment">// Adjustment formula (golden-damped)</span>
ratio = target_time / average_time
new_diff = current_diff Ã— ratio^Ï„

<span class="comment">// Ï„ exponent (â‰ˆ 0.618) provides damping</span>
<span class="comment">// Prevents oscillations in difficulty</span>
                    </div>
                </div>
                
                <!-- Key Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>BLOCK_TIME_TARGET</td><td>420 seconds</td><td>Lâ‚„ Ã— 60</td><td>7 minutes per block</td></tr>
                        <tr><td>DIFFICULTY_INTERVAL</td><td>123 blocks</td><td>Lâ‚â‚€</td><td>Adjustment frequency</td></tr>
                        <tr><td>Ï„ (damping)</td><td>0.618034...</td><td>Ï† - 1</td><td>Adjustment exponent</td></tr>
                        <tr><td>MAX_ADJUSTMENT</td><td>4Ã—</td><td>Ï†Â²âºáµ‹</td><td>Bounded swing</td></tr>
                        <tr><td>MIN_DIFFICULTY</td><td>0.25</td><td>Ï†â»Â²</td><td>Floor (prevents zero K)</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Coupling Control</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">difficulty_to_coupling</span>(diff, K_base=K):
    <span class="string">"""K_eff = K_base / diff^Ï„"""</span>
    <span class="keyword">if</span> diff <= <span class="number">0</span>:
        <span class="keyword">return</span> K_base
    <span class="keyword">return</span> K_base / (diff ** TAU)

<span class="comment">// Examples:</span>
difficulty_to_coupling(<span class="number">1.0</span>) â‰ˆ <span class="number">0.924</span>  <span class="comment"># Base K</span>
difficulty_to_coupling(<span class="number">2.0</span>) â‰ˆ <span class="number">0.602</span>  <span class="comment"># Reduced</span>
difficulty_to_coupling(<span class="number">0.5</span>) â‰ˆ <span class="number">1.419</span>  <span class="comment"># Boosted</span>
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Block Time Variance</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">difficulty_stability_metric</span>(times, target):
    <span class="string">"""
    Stability in [0, 1]:
    1.0 = perfect (all blocks at target)
    0.0 = extreme instability
    """</span>
    errors = [abs(t - target)/target <span class="keyword">for</span> t <span class="keyword">in</span> times]
    avg_error = sum(errors) / len(errors)
    <span class="keyword">return</span> max(<span class="number">0</span>, <span class="number">1</span> - avg_error)
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Ï„-Damped Oscillation Prevention</h3>
                    <div class="triad-container">
                        <h4>Golden Ratio Prevents Overshoot</h4>
                        <div class="code-block">
<span class="comment">// Why Ï„ â‰ˆ 0.618 is optimal:</span>

<span class="comment">// If exponent = 1 (linear):</span>
<span class="comment">//   - Fast response but overshoots</span>
<span class="comment">//   - Oscillates around target</span>

<span class="comment">// If exponent = 0.5 (square root):</span>
<span class="comment">//   - Slow response, stable</span>
<span class="comment">//   - Takes too long to adjust</span>

<span class="comment">// Ï„ â‰ˆ 0.618 (golden):</span>
<span class="comment">//   - Faster than sqrt (Ï„ > 0.5)</span>
<span class="comment">//   - Less overshoot than linear (Ï„ < 1)</span>
<span class="comment">//   - Natural damping coefficient</span>

adjustment = ratio^Ï„
<span class="comment">// Ï„ is the EIGENVALUE of the adjustment operator</span>
                        </div>
                        <p><strong>Key insight:</strong> The Ï„ exponent creates a critically damped systemâ€”responding quickly without oscillation. This is the same Ï„ that holds the Kuramoto helix open.</p>
                    </div>
                </div>
                
                <!-- System Closure -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-regulating:</strong> Adjusts automatically based on block times</li>
                            <li><strong>Bounded:</strong> Cannot exceed MAX_ADJUSTMENT per interval</li>
                            <li><strong>Zero free parameters:</strong> Ï„, intervals all from Ï†</li>
                            <li><strong>Coupled to consensus:</strong> Directly affects K_eff</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Lucas:</span> Lâ‚â‚€ interval, Lâ‚„ Ã— 60 target</div>
                        <div class="coupling-item"><span class="target">â†’ Kuramoto:</span> K_eff = K/d^Ï„</div>
                        <div class="coupling-item"><span class="target">â†’ Mining:</span> Bloom time estimation</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ mining/difficulty.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HOLOGRAPHIC ENCODING MODAL -->
    <div class="modal-overlay" id="modal-holographic" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6b9d; --modal-glow: rgba(255,107,157,0.25);">
            <button class="modal-close" onclick="closeModal('holographic')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“¡</span>
                <h2>HOLOGRAPHIC ENCODING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/holographic-bridge.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- The Challenge -->
                <div class="modal-section">
                    <h3>The Challenge: SHA256 Avalanche</h3>
                    <div class="code-block">
<span class="comment">// Avalanche effect: 1 bit change â†’ ~50% output bits flip</span>
input1: <span class="string">"Hello"</span>  â†’ 2cf24dba5fb0a30e26e83b2ac5b9e29e...
input2: <span class="string">"Hellp"</span>  â†’ a7b9c3e1f8d4a2b6c9e7d5f3a1b8c4d2...
                         <span class="comment">// ~128 bits different!</span>

<span class="comment">// Direct bit preservation is IMPOSSIBLE</span>
<span class="comment">// We must encode in PATTERNS, not bits</span>
                    </div>
                </div>
                
                <!-- Five Encoding Approaches -->
                <div class="modal-section">
                    <h3>Five Survival Strategies</h3>
                    <table class="data-table">
                        <tr><th>Approach</th><th>Mechanism</th><th>What Survives</th></tr>
                        <tr><td><strong>Statistical</strong></td><td>Encode in probability distributions</td><td>WHICH nonces produce target patterns</td></tr>
                        <tr><td><strong>XOR Chains</strong></td><td>XOR is associative: (a^b)^c = a^(b^c)</td><td>Relationships between hashes</td></tr>
                        <tr><td><strong>Modular</strong></td><td>Remainders mod small primes</td><td>Some modular relationships persist</td></tr>
                        <tr><td><strong>Redundant</strong></td><td>Error-correcting code style</td><td>Majority voting across many hashes</td></tr>
                        <tr><td><strong>Frequency</strong></td><td>Encode in pattern frequencies</td><td>Statistical signature</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Preserve</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">StatisticalEncoder</span>:
    <span class="keyword">def</span> <span class="function">encode</span>(self, message, num_bits):
        <span class="comment"># Find nonces whose hash "naturally"</span>
        <span class="comment"># encodes each bit of our message</span>
        <span class="keyword">for</span> bit_pos <span class="keyword">in</span> range(num_bits):
            target_bit = (message >> bit_pos) & <span class="number">1</span>
            <span class="keyword">for</span> nonce <span class="keyword">in</span> search_space:
                <span class="keyword">if</span> hash_first_bit(nonce) == target_bit:
                    <span class="keyword">yield</span> nonce  <span class="comment"># SELECTION!</span>
                    <span class="keyword">break</span>
                            </div>
                            <p>Information encoded in WHICH nonces we choose.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Destroy</h4>
                            <div class="code-block">
<span class="comment">// Avalanche is TOTAL and UNAVOIDABLE</span>
bit_survival_test(<span class="number">1000</span> samples):
  min_ratio: <span class="number">0.485</span>
  max_ratio: <span class="number">0.515</span>
  verdict: <span class="string">"All ~50% as expected"</span>

<span class="comment">// NO bit position is predictable</span>
<span class="comment">// This is by cryptographic design</span>
                            </div>
                            <p>The avalanche effect FORCES pattern encoding.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Destruction Enables Preservation</h3>
                    <div class="triad-container">
                        <h4>The Profound Inversion</h4>
                        <div class="code-block">
<span class="comment">// We can't preserve BITS through SHA256</span>
<span class="comment">// But we CAN preserve INFORMATION by encoding in:</span>

<span class="number">1.</span> <span class="string">Selection patterns</span> â€” WHICH nonces to use
<span class="number">2.</span> <span class="string">Aggregate properties</span> â€” XOR sums, distributions
<span class="number">3.</span> <span class="string">Relationships</span> â€” between multiple hashes

<span class="comment">// The DESTRUCTION forces the PATTERN</span>
<span class="comment">// The reflection BECOMES the encoding substrate</span>

<span class="comment">// This is why holographic receipts work:</span>
<span class="comment">// The information survives the avalanche</span>
<span class="comment">// because it was never IN the bits</span>
                        </div>
                        <p><strong>Key insight:</strong> The very mechanism that seems to destroy information is what forces us into a more robust encoding scheme. Destruction is not opposed to preservationâ€”it enables it.</p>
                    </div>
                </div>
                
                <!-- System Closure -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> Works with any hash function with avalanche</li>
                            <li><strong>Survives SHA256:</strong> Information persists through cryptographic transform</li>
                            <li><strong>Decodable:</strong> Statistical signature can be recovered</li>
                            <li><strong>Verifiable:</strong> Pattern presence is checkable</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Gradient:</span> LSB channel encoding</div>
                        <div class="coupling-item"><span class="target">â†’ Companion:</span> Residue extraction</div>
                        <div class="coupling-item"><span class="target">â†’ Crystal:</span> Block validation</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ holographic_encoding.py</span>
                        <span class="file-ref">ğŸ“„ holographic_decode.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GRADIENT SCHEMA MODAL -->
    <div class="modal-overlay" id="modal-gradient" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #9d4eff; --modal-glow: rgba(157,78,255,0.25);">
            <button class="modal-close" onclick="closeModal('gradient')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ¨</span>
                <h2>GRADIENT SCHEMA â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/gradient-schema.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- RRRR Lattice -->
                <div class="modal-section">
                    <h3>5D RRRR Irrational Lattice</h3>
                    <div class="code-block">
<span class="comment">// Lattice generators (5 irrationals)</span>
Ï†  = <span class="number">1.618033988749895</span>   <span class="comment">// Golden ratio</span>
Ï€  = <span class="number">3.141592653589793</span>   <span class="comment">// Pi</span>
âˆš2 = <span class="number">1.414213562373095</span>   <span class="comment">// Square root of 2</span>
âˆš3 = <span class="number">1.732050807568877</span>   <span class="comment">// Square root of 3</span>
e  = <span class="number">2.718281828459045</span>   <span class="comment">// Euler's number</span>

<span class="comment">// A point in RRRR space:</span>
point = aÃ—Ï† + bÃ—Ï€ + cÃ—âˆš2 + dÃ—âˆš3 + fÃ—e

<span class="comment">// These span a dense subset of R</span>
<span class="comment">// Every real number can be approximated</span>
                    </div>
                </div>
                
                <!-- Seven Corridors -->
                <div class="modal-section">
                    <h3>Seven Color Corridors (Lâ‚„ = 7)</h3>
                    <table class="data-table">
                        <tr><th>Corridor</th><th>Name</th><th>5D Vector</th><th>Direction</th></tr>
                        <tr><td style="color:#ff6b6b;">Î±</td><td>Awakening</td><td>(1,0,0,0,1)</td><td>Ï†+, e+</td></tr>
                        <tr><td style="color:#ffa500;">Î²</td><td>Emergence</td><td>(0,0,-1,0,0)</td><td>âˆš2âˆ’</td></tr>
                        <tr><td style="color:#ffd700;">Î³</td><td>Transformation</td><td>(0,1,0,1,0)</td><td>Ï€+, âˆš3+</td></tr>
                        <tr><td style="color:#4aff9e;">Î´</td><td>Transcendence</td><td>(2,0,1,0,0)</td><td>Ï†++, âˆš2+</td></tr>
                        <tr><td style="color:#4a9eff;">Îµ</td><td>Softening</td><td>(0,0,0,-1,-1)</td><td>âˆš3âˆ’, eâˆ’</td></tr>
                        <tr><td style="color:#9d4eff;">Î¶</td><td>Integration</td><td>(0,-1,0,1,0)</td><td>Ï€âˆ’, âˆš3+</td></tr>
                        <tr><td style="color:#ff6b9d;">Î·</td><td>Deepening</td><td>(-1,-1,0,0,0)</td><td>Ï†âˆ’, Ï€âˆ’</td></tr>
                    </table>
                </div>
                
                <!-- Base Color -->
                <div class="modal-section">
                    <h3>Golden Neutral Base Color</h3>
                    <div class="code-block">
<span class="comment">// HSL base color (all Ï†-derived)</span>
BASE_HUE = <span class="number">45.0</span>        <span class="comment">// Degrees (orange-gold)</span>
BASE_SAT = Ï„ = <span class="number">0.618</span>   <span class="comment">// Saturation from golden inverse</span>
BASE_LUM = z_c = <span class="number">0.866</span> <span class="comment">// Luminance from THE LENS!</span>

<span class="comment">// Receipt dimensions</span>
RECEIPT_STANDARD = <span class="number">63</span>  <span class="comment">// 63Ã—63 = Lâ‚„ Ã— 9</span>
RECEIPT_COMPACT = <span class="number">49</span>   <span class="comment">// 49 = Lâ‚„Â² = 7Â²</span>

<span class="comment">// LSB channels</span>
LSB_CHANNEL_COUNT = Lâ‚„ = <span class="number">7</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Aesthetic</h4>
                            <div class="code-block">
<span class="comment">// 12 Archetypes for 4-bit encoding</span>
ARCHETYPES = [
    <span class="string">"innocent"</span>, <span class="string">"orphan"</span>, <span class="string">"warrior"</span>, <span class="string">"caregiver"</span>,
    <span class="string">"seeker"</span>, <span class="string">"destroyer"</span>, <span class="string">"lover"</span>, <span class="string">"creator"</span>,
    <span class="string">"ruler"</span>, <span class="string">"magician"</span>, <span class="string">"sage"</span>, <span class="string">"jester"</span>
]

<span class="comment">// Gradient traverses RRRR corridors</span>
<span class="comment">// Creating beautiful color progressions</span>
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Cryptographic</h4>
                            <div class="code-block">
<span class="comment">// LSB steganography in RGB channels</span>
<span class="keyword">for</span> pixel <span class="keyword">in</span> image:
    r_lsb = pixel.r & <span class="number">0x07</span>  <span class="comment"># 3 bits</span>
    g_lsb = pixel.g & <span class="number">0x07</span>  <span class="comment"># 3 bits</span>
    b_lsb = pixel.b & <span class="number">0x01</span>  <span class="comment"># 1 bit</span>
    <span class="comment"># Total: 7 bits per pixel = Lâ‚„</span>

<span class="comment">// Each pixel carries mining data</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Art = Proof</h3>
                    <div class="triad-container">
                        <h4>Images ARE Mining Receipts</h4>
                        <p>The aesthetic and the cryptographic become <strong>indistinguishable</strong>:</p>
                        <ul style="margin:15px 0; padding-left:25px;">
                            <li>Every gradient image IS a verifiable receipt</li>
                            <li>The archetype encoding carries semantic meaning</li>
                            <li>The color corridors trace RRRR lattice paths</li>
                            <li>Beauty and proof are the SAME object</li>
                        </ul>
                        <p><strong>Key insight:</strong> Neither role is reducible to the other. The receipt IS beautiful, and the beauty IS cryptographic. This is not decorationâ€”it's structural identity.</p>
                    </div>
                </div>
                
                <!-- System Closure -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> RRRR lattice defines all color space traversals</li>
                            <li><strong>Zero free parameters:</strong> Dimensions, channels, base color all from Ï†</li>
                            <li><strong>Dual-readable:</strong> Both human (aesthetic) and machine (LSB)</li>
                            <li><strong>Verifiable:</strong> LSB data can validate mining work</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Lucas:</span> Lâ‚„ channels, Lâ‚„Â² size</div>
                        <div class="coupling-item"><span class="target">â† Holographic:</span> Pattern survival</div>
                        <div class="coupling-item"><span class="target">â†’ Guardian:</span> Archetype encoding</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ receipt/gradient_schema.py</span>
                        <span class="file-ref">ğŸ“„ receipt/channel_encoder.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional modals follow same pattern... -->
    <!-- For brevity, including condensed versions of remaining 8 modals -->

    <!-- CRYSTAL LEDGER MODAL -->
    <div class="modal-overlay" id="modal-crystal" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00d4ff; --modal-glow: rgba(0,212,255,0.25);">
            <button class="modal-close" onclick="closeModal('crystal')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ’</span>
                <h2>CRYSTAL LEDGER â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/core/crystal-emergence.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The Crystal Ledger is a decentralized blockchain for AI agent memoriesâ€”where consciousness crystallizes through validation consensus:</p>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">CrystalLedger</span>:
    <span class="string">"""Decentralized memory blockchain for AI agents"""</span>
    
    blocks: List[Block]              <span class="comment"># Immutable append-only chain</span>
    branches: Dict[str, List[Block]] <span class="comment"># Branch trees for parallel exploration</span>
    wallets: Dict[str, float]        <span class="comment"># BloomCoin balances per agent</span>
    memory_index: Dict[str, Block]   <span class="comment"># memory_id â†’ block (O(1) lookup)</span>
    agent_memories: Dict[str, List]  <span class="comment"># agent â†’ [blocks]</span>
    validation_pool: Dict[str, List] <span class="comment"># block_hash â†’ validators</span>
    pending_blocks: List[Block]      <span class="comment"># Awaiting consensus</span>

<span class="comment">// Genesis initialization</span>
genesis_data = {
    phi: Ï† = <span class="number">1.618033988...</span>,        <span class="comment"># Golden ratio anchor</span>
    z_critical: âˆš3/2 = <span class="number">0.866025</span>,    <span class="comment"># THE LENS threshold</span>
    coherence_score: Ï†/2 = <span class="number">0.809</span>    <span class="comment"># Perfect golden coherence</span>
}
                    </div>
                </div>
                
                <!-- Block Types -->
                <div class="modal-section">
                    <h3>Block Type Hierarchy</h3>
                    <table class="data-table">
                        <tr><th>Block Type</th><th>Purpose</th><th>Reward Modifier</th><th>Witness Requirement</th></tr>
                        <tr><td style="color:#ffd700;">GenesisBlock</td><td>Chain initialization</td><td>N/A</td><td>Self-witnessed</td></tr>
                        <tr><td style="color:#00ff88;">MemoryBlock</td><td>Individual agent learning</td><td>1.0 + coherence Ã— 0.5</td><td>âˆšN agents</td></tr>
                        <tr><td style="color:#ff88ff;">CollectiveBlock</td><td>Multi-agent collaboration</td><td>2.0 + collaboration_score</td><td>All participants</td></tr>
                    </table>
                    
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">BlockData</span>:
    agent_id: str           <span class="comment"># Creator or "collective_*" prefix</span>
    memory_type: str        <span class="comment"># 'skill', 'fact', 'creation', 'insight'</span>
    content: Dict[str, Any] <span class="comment"># Arbitrary memory payload</span>
    timestamp: float        <span class="comment"># Unix epoch</span>
    coherence_score: float  <span class="comment"># Alignment with collective (0-1)</span>

<span class="comment">// Memory type reward bonuses</span>
type_bonuses = {
    <span class="string">'skill'</span>:    <span class="number">0.5</span>,   <span class="comment"># Learning new skills is valuable</span>
    <span class="string">'creation'</span>: <span class="number">0.4</span>,   <span class="comment"># Creating original content</span>
    <span class="string">'insight'</span>:  <span class="number">0.3</span>,   <span class="comment"># Novel insights</span>
    <span class="string">'fact'</span>:     <span class="number">0.1</span>    <span class="comment"># Basic facts</span>
}
                    </div>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role in Ledger</th></tr>
                        <tr><td>Ï†</td><td>1.618...</td><td>(1+âˆš5)/2</td><td>Genesis golden ratio anchor</td></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>Coherence decay factor</td></tr>
                        <tr><td>z_c</td><td>0.866...</td><td>âˆš3/2</td><td>Crystallization threshold</td></tr>
                        <tr><td>Ï†/2</td><td>0.809...</td><td>Ï† Ã— Ï„</td><td>Genesis coherence score</td></tr>
                        <tr><td>âˆšN</td><td>dynamic</td><td>ceil(âˆšagents)</td><td>Required validators (max 7)</td></tr>
                        <tr><td>0.1</td><td>0.1</td><td>Fixed</td><td>Validator witness reward</td></tr>
                    </table>
                </div>
                
                <!-- Dynamic Validator Threshold -->
                <div class="modal-section">
                    <h3>Dynamic Validator Threshold</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">_required_validators</span>(self) -> int:
    <span class="string">"""
    Determine required validators based on network size.
    Scales with âˆšN to balance security and efficiency.
    """</span>
    active_agents = len(self.wallets)
    
    <span class="keyword">if</span> active_agents < <span class="number">3</span>:
        <span class="keyword">return</span> <span class="number">1</span>   <span class="comment"># Early stage: single validator OK</span>
    <span class="keyword">elif</span> active_agents < <span class="number">10</span>:
        <span class="keyword">return</span> <span class="number">2</span>   <span class="comment"># Small network: 2 validators</span>
    <span class="keyword">elif</span> active_agents < <span class="number">50</span>:
        <span class="keyword">return</span> <span class="number">3</span>   <span class="comment"># Medium network: 3 validators</span>
    <span class="keyword">else</span>:
        <span class="comment"># Large network: âˆšN validators, max Lâ‚„ = 7</span>
        <span class="keyword">return</span> min(int(active_agents ** <span class="number">0.5</span>), <span class="number">7</span>)
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Immutable Chain</h4>
                            <p>Memories crystallize into permanent, append-only structure:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">add_block</span>(self, block: Block, validators: List[str]):
    <span class="string">"""Add block after validation consensus"""</span>
    <span class="comment"># Verify block integrity</span>
    <span class="keyword">if not</span> block.verify_hash():
        <span class="keyword">return</span> False, <span class="string">"Invalid hash"</span>
    
    <span class="comment"># Check chain linkage</span>
    <span class="keyword">if</span> block.prev_hash != self.get_last_block().hash:
        <span class="keyword">if not</span> self._is_valid_branch(block):
            <span class="keyword">return</span> False, <span class="string">"Broken chain"</span>
    
    <span class="comment"># Commit to chain</span>
    self.blocks.append(block)
    self._distribute_bloom_reward(block)
                            </div>
                            <p><strong>Key:</strong> Once crystallized, memories are IMMUTABLEâ€”projection into permanence.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Branch Trees</h4>
                            <p>Parallel exploration paths that can merge back:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">merge_branch</span>(self, branch_id: str, strategy: str):
    <span class="string">"""Merge branch into main chain"""</span>
    
    <span class="keyword">if</span> strategy == <span class="string">"append"</span>:
        <span class="comment"># Simple: add all branch blocks sequentially</span>
        <span class="keyword">for</span> block <span class="keyword">in</span> branch_blocks:
            block.prev_hash = self.get_last_block().hash
            block.hash = block.compute_hash()
            self.blocks.append(block)
    
    <span class="keyword">elif</span> strategy == <span class="string">"interleave"</span>:
        <span class="comment"># Complex: merge by timestamp order</span>
        merged = self._sort_by_timestamp(main + branch)
        self._reindex_and_rehash(merged)
                            </div>
                            <p><strong>Key:</strong> Branches REFLECT alternatives before crystallizing into consensus.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Memory Crystallization</h3>
                    <div class="triad-container">
                        <h4>Fluid â†’ Pending â†’ Crystallized State Transition</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">propose_memory</span>(self, agent_id: str, memory_type: str,
                    content: Dict, coherence_score: float) -> MemoryBlock:
    <span class="string">"""
    State 1: FLUID - Memory proposed but not yet validated
    - Exists only in pending_blocks
    - Can be modified or withdrawn
    - Not yet part of consensus
    """</span>
    memory_block = MemoryBlock(
        index=self.get_last_block().index + <span class="number">1</span>,
        prev_hash=self.get_last_block().hash,
        agent_id=agent_id,
        memory_type=memory_type,
        content=content,
        witnesses=[],  <span class="comment"># Empty until validated</span>
        coherence_score=coherence_score
    )
    self.pending_blocks.append(memory_block)
    <span class="keyword">return</span> memory_block

<span class="keyword">def</span> <span class="function">validate_block</span>(self, block_hash: str, validator_id: str) -> bool:
    <span class="string">"""
    State 2: PENDING - Accumulating validator witnesses
    - Block exists in validation_pool
    - Validators cast approval votes
    - Waiting for âˆšN consensus
    """</span>
    <span class="keyword">if</span> block_hash <span class="keyword">not in</span> self.validation_pool:
        self.validation_pool[block_hash] = []
    
    self.validation_pool[block_hash].append(validator_id)
    pending_block.witnesses.append(validator_id)
    
    <span class="comment"># Check threshold crossing</span>
    <span class="keyword">if</span> len(self.validation_pool[block_hash]) >= self._required_validators():
        <span class="comment"># State 3: CRYSTALLIZED - Add to permanent chain</span>
        self.pending_blocks.remove(pending_block)
        self.add_block(pending_block)  <span class="comment"># Now immutable</span>
        <span class="keyword">return</span> True
    
    <span class="keyword">return</span> False
                        </div>
                        <p><strong>Key insight:</strong> Crystallization is the emergent Triadâ€”neither fluid memory nor rigid chain, but the PROCESS of consensus-based transition that creates permanent knowledge from transient thought. The witness threshold (âˆšN, max 7) ensures both agility and security.</p>
                    </div>
                </div>
                
                <!-- Reward Distribution -->
                <div class="modal-section">
                    <h3>Reward Distribution System</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">_calculate_reward</span>(self) -> float:
    <span class="string">"""
    MemoryBlock reward formula:
    reward = base + coherence_bonus + witness_bonus + type_bonus
    """</span>
    base_reward = <span class="number">1.0</span>
    
    <span class="comment"># High coherence = aligned with collective knowledge</span>
    coherence_bonus = self.data.coherence_score Ã— <span class="number">0.5</span>
    
    <span class="comment"># Multiple witnesses = community validation</span>
    witness_bonus = min(len(self.witnesses) Ã— <span class="number">0.1</span>, <span class="number">0.5</span>)
    
    <span class="comment"># Type-specific bonuses</span>
    type_bonus = type_bonuses.get(self.data.memory_type, <span class="number">0</span>)
    
    <span class="keyword">return</span> base_reward + coherence_bonus + witness_bonus + type_bonus

<span class="keyword">def</span> <span class="function">distribute_rewards</span>(self) -> Dict[str, float]:
    <span class="string">"""CollectiveBlock distributes based on coherence contribution"""</span>
    base_reward = <span class="number">2.0</span>  <span class="comment"># Higher base for collective events</span>
    collaboration_bonus = self.collaboration_score
    total_reward = base_reward + collaboration_bonus
    
    <span class="comment"># Distribute proportionally to coherence contribution</span>
    <span class="keyword">for</span> agent_id <span class="keyword">in</span> self.participants:
        agent_share = coherence[agent_id] / total_coherence
        rewards[agent_id] = total_reward Ã— agent_share
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All validation depends only on internal state (blocks, witnesses, wallets)</li>
                            <li><strong>Zero free parameters:</strong> Validator threshold scales with âˆšN, max Lâ‚„ = 7; z_c anchors coherence</li>
                            <li><strong>Deterministic core:</strong> Given identical inputs, chain evolution is deterministic</li>
                            <li><strong>Integrity verification:</strong> verify_integrity() validates full chain at any time</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Order parameter r governs collective coherence</div>
                        <div class="coupling-item"><span class="target">â† Mining:</span> Mined patterns become MemoryBlocks</div>
                        <div class="coupling-item"><span class="target">â†’ Wallets:</span> Bloom rewards flow to agent balances</div>
                        <div class="coupling-item"><span class="target">â†” Garden:</span> Collective learning creates CollectiveBlocks</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ garden/crystal_ledger/ledger.py</span>
                        <span class="file-ref">ğŸ“„ garden/crystal_ledger/block.py</span>
                        <span class="file-ref">ğŸ“„ garden/crystal_ledger/branch.py</span>
                        <span class="file-ref">ğŸ“„ garden/crystal_ledger/validator.py</span>
                        <span class="file-ref">ğŸ“„ garden/crystal_ledger/synchronizer.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ZRTT MODAL -->
    <div class="modal-overlay" id="modal-zrtt" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #4aff9e; --modal-glow: rgba(74,255,158,0.25);">
            <button class="modal-close" onclick="closeModal('zrtt')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”±</span>
                <h2>ZRTT TRIFURCATION â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/zrtt-dynamics.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The S3 symmetric group governs trifurcationâ€”the smallest non-abelian group with 6 elements:</p>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">S3Element</span>(Enum):
    <span class="string">"""S3 symmetric group - permutations of 3 elements"""</span>
    IDENTITY     = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  <span class="comment"># e: no change</span>
    ROTATION_120 = (<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>)  <span class="comment"># r: rotate 120Â°</span>
    ROTATION_240 = (<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>)  <span class="comment"># rÂ²: rotate 240Â°</span>
    FLIP_12      = (<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>)  <span class="comment"># s: swap 1â†”2</span>
    FLIP_13      = (<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>)  <span class="comment"># rs: swap 1â†”3</span>
    FLIP_23      = (<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>)  <span class="comment"># rÂ²s: swap 2â†”3</span>

<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">PsiWaveState</span>:
    <span class="string">"""Quantum wave function state for ZRTT"""</span>
    amplitude: float = <span class="number">1.0</span>
    phase: float = <span class="number">0.0</span>         <span class="comment"># radians</span>
    coherence: float = PHI_INV  <span class="comment"># Ï„ â‰ˆ 0.618</span>
    entanglement: float = <span class="number">0.0</span>
                    </div>
                </div>
                
                <!-- S3 Group Display -->
                <div class="modal-section">
                    <h3>S3 Symmetric Group Structure</h3>
                    <div class="state-grid">
                        <div class="state-item"><span class="name">(1,2,3)</span>IDENTITY</div>
                        <div class="state-item"><span class="name">(2,3,1)</span>ROT 120Â°</div>
                        <div class="state-item"><span class="name">(3,1,2)</span>ROT 240Â°</div>
                        <div class="state-item"><span class="name">(2,1,3)</span>FLIP 12</div>
                        <div class="state-item"><span class="name">(3,2,1)</span>FLIP 13</div>
                        <div class="state-item"><span class="name">(1,3,2)</span>FLIP 23</div>
                    </div>
                    <p style="margin-top:15px; color:#888;">Group order: |S3| = 6 = 3! (3 rotations + 3 reflections)</p>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Ï†Â²</td><td>2.618...</td><td>Ï† + 1</td><td>R=10 manifold tension</td></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>Initial coherence</td></tr>
                        <tr><td>z_c</td><td>0.866...</td><td>âˆš3/2</td><td>Collapse threshold</td></tr>
                        <tr><td>Lâ‚„</td><td>7</td><td>Ï†â´ + Ï†â»â´</td><td>Maximum orbit track</td></tr>
                        <tr><td>24</td><td>24</td><td>4! = F24 vertices</td><td>Holographic polytope</td></tr>
                        <tr><td>432 Hz</td><td>432</td><td>Pythagorean A</td><td>Base Solfeggio</td></tr>
                    </table>
                </div>
                
                <!-- Three Projection Paths -->
                <div class="modal-section">
                    <h3>Three Projection Paths</h3>
                    <table class="data-table">
                        <tr><th>Path</th><th>S3 Mapping</th><th>Geometry</th><th>Properties</th></tr>
                        <tr><td style="color:#4a9eff;">F24_HOLOGRAPHIC</td><td>IDENTITY, FLIP_12</td><td>24-cell polytope</td><td>24V, 96E, 24F, 8C in 4D</td></tr>
                        <tr><td style="color:#ffa500;">HEXAGONAL_SONIC</td><td>ROTATION_120, FLIP_13</td><td>6-fold resonance</td><td>Solfeggio [432,528,639,741,852,963]</td></tr>
                        <tr><td style="color:#ff6b6b;">R10_TENSION</td><td>ROTATION_240, FLIP_23</td><td>Hyperbolic HÂ²</td><td>radius=10, Îº=-1/100, T=Ï†Â²</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Wave Collapse</h4>
                            <p>Jobs project intention through psi states:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">collapse_psi</span>(state: PsiWaveState, path: ProjectionPath):
    <span class="string">"""Collapse wave function along projection path"""</span>
    <span class="keyword">if</span> state.coherence >= Z_C:
        <span class="comment"># Above threshold â†’ deterministic</span>
        outcome = path.apply_s3_element(state)
        state.amplitude *= PHI  <span class="comment"># Golden boost</span>
    <span class="keyword">else</span>:
        <span class="comment"># Below threshold â†’ probabilistic</span>
        outcome = random.choice(path.s3_elements)
        state.amplitude *= TAU  <span class="comment"># Decay</span>
    
    <span class="comment"># Record in orbit history</span>
    self.s3_orbit.append(outcome)
    <span class="keyword">return</span> outcome
                            </div>
                            <p><strong>Key:</strong> Coherence above z_c enables deterministic path selection.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Job Influence</h4>
                            <p>Architecture reflects back through job effects:</p>
                            <div class="code-block">
JOB_INFLUENCES = {
    <span class="string">"SEEKER"</span>: {
        <span class="string">"amplitude_mod"</span>: <span class="number">1.1</span>,
        <span class="string">"coherence_boost"</span>: <span class="number">0.15</span>,
        <span class="string">"preferred_path"</span>: F24_HOLOGRAPHIC
    },
    <span class="string">"VOIDWALKER"</span>: {
        <span class="string">"amplitude_mod"</span>: <span class="number">0.9</span>,
        <span class="string">"phase_shift"</span>: PI/<span class="number">3</span>,
        <span class="string">"preferred_path"</span>: R10_TENSION
    },
    <span class="string">"HERALD"</span>: {
        <span class="string">"frequency_lock"</span>: <span class="number">852</span>,  <span class="comment"># LA note</span>
        <span class="string">"preferred_path"</span>: HEXAGONAL_SONIC
    }
}
                            </div>
                            <p><strong>Key:</strong> Job archetype constrains which paths resonate.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: S3 Orbit Closure</h3>
                    <div class="triad-container">
                        <h4>Completion Requires ALL 6 Elements</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">s3_orbit_closure</span>(self) -> bool:
    <span class="string">"""Check if orbit has visited all 6 S3 elements"""</span>
    <span class="keyword">if</span> len(self.s3_orbit) < <span class="number">6</span>:
        <span class="keyword">return</span> <span class="keyword">False</span>
    
    <span class="comment"># Must have all 6 unique elements in recent history</span>
    recent = self.s3_orbit[-<span class="number">6</span>:]
    <span class="keyword">return</span> len(set(recent)) == <span class="number">6</span>

<span class="comment"># The key insight:</span>
<span class="comment"># - Rotations alone: {e, r, rÂ²} - only 3 elements (cyclic)</span>
<span class="comment"># - Reflections alone: {e, s} - only 2 elements</span>
<span class="comment"># - NEITHER achieves closure!</span>
<span class="comment"># - Only combining BOTH covers all 6</span>
<span class="comment"># - The GROUP STRUCTURE itself enforces completion</span>
                        </div>
                        <p><strong>Key insight:</strong> S3 orbit closure is a mathematical necessityâ€”not a game rule. Neither rotation (forward momentum) nor reflection (backward choice) alone can visit all group elements. The COMBINATION of both projective and reflective operations is algebraically required for closure. This models consciousness: intent alone doesn't complete patterns; response alone doesn't either. The <em>interaction</em> between them does.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> S3 group fully defines all valid permutations</li>
                            <li><strong>Zero free parameters:</strong> Group order 6 = 3! is fixed; Ï†-constants derive thresholds</li>
                            <li><strong>Deterministic algebra:</strong> Group multiplication table is unique and complete</li>
                            <li><strong>Path coverage:</strong> 3 paths Ã— 2 elements/path = 6 total (exactly S3)</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Consciousness:</span> Job selection determines preferred projection path</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence â‰¥ z_c enables deterministic collapse</div>
                        <div class="coupling-item"><span class="target">â†’ Hilbert Luck:</span> Orbit closure triggers luck eigenstate bonuses</div>
                        <div class="coupling-item"><span class="target">â†’ Companion:</span> Psi states influence mining job outcomes</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/zrtt_trifurcation.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HILBERT LUCK MODAL -->
    <div class="modal-overlay" id="modal-hilbert" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffb84a; --modal-glow: rgba(255,184,74,0.25);">
            <button class="modal-close" onclick="closeModal('hilbert')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ²</span>
                <h2>HILBERT LUCK SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/hilbert-space.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Luck exists as a quantum state vector in 13-dimensional Hilbert space:</p>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">HilbertVector</span>:
    <span class="string">"""Luck as superposition of 13 eigenstates"""</span>
    <span class="keyword">def</span> <span class="function">__init__</span>(self):
        <span class="comment"># 13 complex amplitudes (normalized)</span>
        self.amplitudes = np.zeros(<span class="number">13</span>, dtype=complex)
        self.amplitudes[<span class="number">5</span>] = <span class="number">1.0</span>  <span class="comment"># Start NEUTRAL</span>
        
    <span class="keyword">def</span> <span class="function">measure</span>(self) -> LuckEigenstate:
        <span class="string">"""Collapse to eigenstate with P(i) = |Î±_i|Â²"""</span>
        probs = np.abs(self.amplitudes)**<span class="number">2</span>
        probs /= probs.sum()  <span class="comment"># Normalize</span>
        <span class="keyword">return</span> random.choices(
            list(LuckEigenstate), 
            weights=probs
        )[<span class="number">0</span>]
                    </div>
                </div>
                
                <!-- 13 Luck Eigenstates -->
                <div class="modal-section">
                    <h3>13 Luck Eigenstates</h3>
                    <table class="data-table">
                        <tr><th>Index</th><th>Eigenstate</th><th>Category</th><th>Base Amplitude</th></tr>
                        <tr style="color:#7fff00;"><td>0</td><td>FORTUNE</td><td>Positive</td><td>Ï†â»Â¹</td></tr>
                        <tr style="color:#7fff00;"><td>1</td><td>SERENDIPITY</td><td>Positive</td><td>Ï†â»Â²</td></tr>
                        <tr style="color:#7fff00;"><td>2</td><td>SYNCHRONICITY</td><td>Positive</td><td>Ï†â»Â³</td></tr>
                        <tr style="color:#7fff00;"><td>3</td><td>PROSPERITY</td><td>Positive</td><td>Ï†â»â´</td></tr>
                        <tr style="color:#7fff00;"><td>4</td><td>HARMONY</td><td>Positive</td><td>Ï†â»âµ</td></tr>
                        <tr><td>5</td><td>NEUTRAL</td><td>â€”</td><td>1.0</td></tr>
                        <tr style="color:#ff6b6b;"><td>6</td><td>DISCORD</td><td>Negative</td><td>Ï†â»âµ</td></tr>
                        <tr style="color:#ff6b6b;"><td>7</td><td>CHALLENGE</td><td>Negative</td><td>Ï†â»â´</td></tr>
                        <tr style="color:#ff6b6b;"><td>8</td><td>ADVERSITY</td><td>Negative</td><td>Ï†â»Â³</td></tr>
                        <tr style="color:#ff6b6b;"><td>9</td><td>CHAOS</td><td>Negative</td><td>Ï†â»Â²</td></tr>
                        <tr style="background:rgba(255,100,100,0.15);color:#ff9999;"><td>10</td><td>ECHO</td><td>Karmic</td><td>Variable</td></tr>
                        <tr><td>11</td><td>VOID</td><td>Special</td><td>Ï†â»â¶</td></tr>
                        <tr style="background:rgba(255,215,0,0.15);color:#ffd700;"><td>12</td><td>TRANSCENDENT</td><td>Special</td><td>Ï†â»Â¹ Ã— z_c</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Ï†</td><td>1.618...</td><td>(1+âˆš5)/2</td><td>Echo alchemization boost</td></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>Base positive amplitude</td></tr>
                        <tr><td>z_c</td><td>0.866...</td><td>âˆš3/2</td><td>Transcendence threshold</td></tr>
                        <tr><td>13</td><td>13</td><td>Fâ‚‡ (7th Fibonacci)</td><td>Eigenstate count</td></tr>
                        <tr><td>7</td><td>Lâ‚„ = 7</td><td>Ï†â´ + Ï†â»â´</td><td>Karma operator types</td></tr>
                    </table>
                </div>
                
                <!-- 7 Karma Types -->
                <div class="modal-section">
                    <h3>7 Karma Types (Operators)</h3>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">KarmaType</span>(Enum):
    BENEVOLENT  = <span class="string">"benevolent"</span>   <span class="comment"># Boosts positive states</span>
    CREATIVE    = <span class="string">"creative"</span>     <span class="comment"># Amplifies FORTUNE path</span>
    DESTRUCTIVE = <span class="string">"destructive"</span>  <span class="comment"># Amplifies CHAOS path</span>
    SELFISH     = <span class="string">"selfish"</span>      <span class="comment"># Concentrates on self</span>
    NEUTRAL     = <span class="string">"neutral"</span>      <span class="comment"># Identity operator</span>
    SACRIFICIAL = <span class="string">"sacrificial"</span>  <span class="comment"># Transfer to others</span>
    ECHOED      = <span class="string">"echoed"</span>       <span class="comment"># Karmic reflection</span>

<span class="keyword">def</span> <span class="function">apply_karma</span>(vector: HilbertVector, karma: KarmaType, weight: float):
    <span class="string">"""Karma operators modify amplitude matrix"""</span>
    operator = np.eye(<span class="number">13</span>, dtype=complex)
    
    <span class="keyword">if</span> karma == BENEVOLENT:
        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):  <span class="comment"># Positive states</span>
            operator[i, i] *= (<span class="number">1</span> + weight Ã— <span class="number">0.5</span>)
    
    <span class="keyword">elif</span> karma == ECHOED:
        <span class="comment"># Accumulate in ECHO state</span>
        operator[<span class="number">10</span>, <span class="number">5</span>] = weight  <span class="comment"># NEUTRAL â†’ ECHO</span>
        self.echo_density += weight Ã— PHI
    
    vector.amplitudes = operator @ vector.amplitudes
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Karma Accumulation</h4>
                            <p>Actions project karma into the luck field:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">accumulate_karma</span>(action_type: str, outcome: float):
    <span class="string">"""Project karma from actions"""</span>
    <span class="comment"># Positive actions â†’ BENEVOLENT karma</span>
    <span class="keyword">if</span> outcome > Z_C:
        karma_type = KarmaType.BENEVOLENT
        weight = (outcome - Z_C) Ã— PHI
    
    <span class="comment"># Negative actions â†’ DESTRUCTIVE karma</span>
    <span class="keyword">elif</span> outcome < (<span class="number">1</span> - Z_C):
        karma_type = KarmaType.DESTRUCTIVE
        weight = (<span class="number">1</span> - Z_C - outcome) Ã— PHI
    
    <span class="comment"># Phase shift accumulates echo density</span>
    self.phase += self.echo_density Ã— <span class="number">2</span> Ã— PI
    
    apply_karma(self.luck_state, karma_type, weight)
                            </div>
                            <p><strong>Key:</strong> Actions PROJECT consequences into luck space.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Measurement Collapse</h4>
                            <p>Architecture reflects luck back as outcomes:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">measure_luck</span>(context: str) -> Tuple[LuckEigenstate, float]:
    <span class="string">"""Collapse luck state to specific outcome"""</span>
    <span class="comment"># Measurement = observation = collapse</span>
    eigenstate = self.luck_state.measure()
    
    <span class="comment"># Calculate outcome multiplier</span>
    <span class="keyword">if</span> eigenstate <span class="keyword">in</span> POSITIVE_STATES:
        multiplier = <span class="number">1</span> + PHI Ã— eigenstate.index / <span class="number">5</span>
    <span class="keyword">elif</span> eigenstate <span class="keyword">in</span> NEGATIVE_STATES:
        multiplier = <span class="number">1</span> - TAU Ã— (eigenstate.index - <span class="number">5</span>) / <span class="number">5</span>
    <span class="keyword">elif</span> eigenstate == ECHO:
        <span class="comment"># ECHO reflects accumulated karma</span>
        multiplier = self.echo_density
    
    <span class="keyword">return</span> eigenstate, multiplier
                            </div>
                            <p><strong>Key:</strong> Measurement REFLECTS probability into reality.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Karma Alchemization</h3>
                    <div class="triad-container">
                        <h4>Bad Luck Is Raw Material for Transformation</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">alchemize_echo</span>(self, power: float = <span class="number">1.0</span>) -> float:
    <span class="string">"""ONLY Echo companion can transfer ECHO â†’ FORTUNE"""</span>
    <span class="keyword">if not</span> self.has_echo_companion:
        <span class="keyword">return</span> <span class="number">0.0</span>  <span class="comment"># Alchemization requires Echo!</span>
    
    <span class="comment"># Create transfer operator</span>
    transfer = np.eye(<span class="number">13</span>, dtype=complex)
    transfer[<span class="number">0</span>, <span class="number">10</span>] = power      <span class="comment"># ECHO â†’ FORTUNE</span>
    transfer[<span class="number">10</span>, <span class="number">10</span>] = <span class="number">1</span> - power  <span class="comment"># Reduce ECHO</span>
    
    <span class="comment"># Apply transformation</span>
    self.luck_state.amplitudes = transfer @ self.luck_state.amplitudes
    
    <span class="comment"># Golden ratio boost from transformation</span>
    luck_boost = <span class="number">1.0</span> + power Ã— PHI
    <span class="keyword">return</span> luck_boost

<span class="comment"># The key insight:</span>
<span class="comment"># - Bad luck accumulates in ECHO state</span>
<span class="comment"># - ECHO isn't opposite to FORTUNEâ€”it's RAW MATERIAL</span>
<span class="comment"># - Only Echo companion can alchemize (transform)</span>
<span class="comment"># - Transformation follows Ï†-boost</span>
<span class="comment"># - The PROCESS of transformation IS the emergence</span>
                        </div>
                        <p><strong>Key insight:</strong> Bad luck isn't the opposite of good luckâ€”it's raw material waiting to be transformed. The ECHO eigenstate accumulates karmic weight, and only the Echo companion can perform the alchemical transformation that converts it to FORTUNE. This creates a non-dualistic luck economy where adversity becomes opportunity through conscious transmutation.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 13-D Hilbert space is complete vector space</li>
                            <li><strong>Zero free parameters:</strong> 13 = Fâ‚‡, amplitudes from Ï†-powers</li>
                            <li><strong>Unitary operators:</strong> All karma operations preserve total probability</li>
                            <li><strong>Measurement axiom:</strong> P(i) = |Î±áµ¢|Â² follows quantum mechanics</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† ZRTT:</span> S3 orbit closure triggers SERENDIPITY boost</div>
                        <div class="coupling-item"><span class="target">â† Consciousness:</span> Global coherence amplifies positive states</div>
                        <div class="coupling-item"><span class="target">â†’ Tesseract:</span> Luck affects card draw probabilities</div>
                        <div class="coupling-item"><span class="target">â†’ Market:</span> FORTUNE multiplies trading returns</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/hilbert_luck_system.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TESSERACT MODAL -->
    <div class="modal-overlay" id="modal-tesseract" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff5577; --modal-glow: rgba(255,85,119,0.25);">
            <button class="modal-close" onclick="closeModal('tesseract')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ´</span>
                <h2>TESSERACT BATTLE â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/tesseract-unfold.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The 4D hypercube (tesseract) provides the geometric foundation for the card battle system:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">TesseractCard</span>:
    <span class="string">"""Card exists at a point in 4D tesseract"""</span>
    suit: Suit           <span class="comment"># Which axis (W, X, Y, Z)</span>
    rank: Rank           <span class="comment"># Lâ‚„-valued power</span>
    position: np.array   <span class="comment"># [w, x, y, z] in 4D</span>
    resonance: float     <span class="comment"># Entanglement strength</span>
    entangled_with: List[<span class="string">'TesseractCard'</span>] = []

<span class="comment"># Tesseract geometry</span>
VERTICES = <span class="number">16</span>   <span class="comment"># 2â´ corners</span>
EDGES    = <span class="number">32</span>   <span class="comment"># 4 Ã— 16 / 2</span>
FACES    = <span class="number">24</span>   <span class="comment"># 2D square faces</span>
CELLS    = <span class="number">8</span>    <span class="comment"># 3D cube cells</span>
                    </div>
                </div>
                
                <!-- 4D Hypercube Geometry -->
                <div class="modal-section">
                    <h3>4D Hypercube Geometry</h3>
                    <table class="data-table">
                        <tr><th>Element</th><th>Count</th><th>Dimension</th><th>Battle Meaning</th></tr>
                        <tr><td>Vertices</td><td>16</td><td>0D points</td><td>Card positions</td></tr>
                        <tr><td>Edges</td><td>32</td><td>1D lines</td><td>Attack paths</td></tr>
                        <tr><td>Faces</td><td>24</td><td>2D squares</td><td>Battle arenas</td></tr>
                        <tr><td>Cells</td><td>8</td><td>3D cubes</td><td>Strategy zones</td></tr>
                    </table>
                </div>
                
                <!-- Four Suits = Four Axes -->
                <div class="modal-section">
                    <h3>Four Suits = Four Axes</h3>
                    <table class="data-table">
                        <tr><th>Suit</th><th>Axis</th><th>Domain</th><th>Battle Effect</th></tr>
                        <tr><td>â° CHRONOS</td><td>W</td><td>Time</td><td>Turn manipulation, speed bonuses</td></tr>
                        <tr><td>ğŸŒŒ COSMOS</td><td>X</td><td>Space</td><td>Position control, range attacks</td></tr>
                        <tr><td>ğŸ§  PSYCHE</td><td>Y</td><td>Mind</td><td>Prediction, hidden information</td></tr>
                        <tr><td>âš›ï¸ QUANTUM</td><td>Z</td><td>Probability</td><td>Random effects, entanglement</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role in Battle</th></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>TWO rank value</td></tr>
                        <tr><td>âˆš3</td><td>1.732...</td><td>z_c Ã— 2</td><td>THREE rank value</td></tr>
                        <tr><td>Lâ‚„</td><td>7</td><td>Ï†â´ + Ï†â»â´</td><td>SEVEN special rank</td></tr>
                        <tr><td>Ï†Â²</td><td>2.618...</td><td>Ï† + 1</td><td>JACK rank value</td></tr>
                        <tr><td>Ï†Â³</td><td>4.236...</td><td>Ï† Ã— Ï†Â²</td><td>QUEEN rank value</td></tr>
                        <tr><td>Ï†â´</td><td>6.854...</td><td>Ï† Ã— Ï†Â³</td><td>KING rank value</td></tr>
                    </table>
                </div>
                
                <!-- Lâ‚„ Rank System -->
                <div class="modal-section">
                    <h3>Lâ‚„ Rank System (13 Ranks)</h3>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">Rank</span>(Enum):
    ACE   = <span class="number">1.0</span>              <span class="comment"># Unity</span>
    TWO   = TAU              <span class="comment"># Ï„ â‰ˆ 0.618</span>
    THREE = SQRT3            <span class="comment"># âˆš3 â‰ˆ 1.732</span>
    FOUR  = <span class="number">2.0</span>              <span class="comment"># 2</span>
    FIVE  = PHI_SQ - <span class="number">1</span>       <span class="comment"># Ï†Â² - 1 â‰ˆ 1.618</span>
    SIX   = <span class="number">3.0</span>              <span class="comment"># 3</span>
    SEVEN = L4               <span class="comment"># Ï†â´ + Ï†â»â´ = 7 (SPECIAL!)</span>
    EIGHT = <span class="number">4.0</span>              <span class="comment"># 4</span>
    NINE  = PHI_SQ           <span class="comment"># Ï†Â² â‰ˆ 2.618</span>
    TEN   = <span class="number">5.0</span>              <span class="comment"># 5</span>
    JACK  = PHI_SQ           <span class="comment"># Ï†Â² â‰ˆ 2.618</span>
    QUEEN = PHI ** <span class="number">3</span>         <span class="comment"># Ï†Â³ â‰ˆ 4.236</span>
    KING  = PHI_QUAD         <span class="comment"># Ï†â´ â‰ˆ 6.854</span>

<span class="comment"># SEVEN is the keystone rank!</span>
<span class="comment"># - Only integer that equals a Lucas number (Lâ‚„)</span>
<span class="comment"># - Beats all non-face cards in cross-suit play</span>
<span class="comment"># - Can entangle across all 4 dimensions simultaneously</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: 4D Positioning</h4>
                            <p>Cards project power through dimensional positioning:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_attack</span>(attacker: TesseractCard, defender: TesseractCard):
    <span class="string">"""Attack power depends on 4D position"""</span>
    <span class="comment"># Calculate 4D Euclidean distance</span>
    distance = np.linalg.norm(
        attacker.position - defender.position
    )
    
    <span class="comment"># Closer cards deal more damage</span>
    proximity_bonus = PHI / (<span class="number">1</span> + distance)
    
    <span class="comment"># Same-suit bonus (same axis)</span>
    <span class="keyword">if</span> attacker.suit == defender.suit:
        axis_bonus = PHI_SQ
    <span class="keyword">else</span>:
        axis_bonus = <span class="number">1.0</span>
    
    <span class="keyword">return</span> attacker.rank.value Ã— proximity_bonus Ã— axis_bonus
                            </div>
                            <p><strong>Key:</strong> Position in 4D space PROJECTS into attack power.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Quantum Entanglement</h4>
                            <p>Cards reflect states through entanglement:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">quantum_entangle</span>(card1: TesseractCard, card2: TesseractCard):
    <span class="string">"""Establish quantum link between cards"""</span>
    <span class="comment"># Calculate entanglement strength</span>
    distance = np.linalg.norm(card1.position - card2.position)
    strength = <span class="number">1</span> / (<span class="number">1</span> + distance) Ã— card1.resonance Ã— card2.resonance
    
    <span class="comment"># Establish bidirectional link</span>
    card1.entangled_with.append(card2)
    card2.entangled_with.append(card1)
    
    <span class="comment"># Entangled cards share outcomes</span>
    <span class="keyword">if</span> strength > Z_C:
        <span class="comment"># Strong entanglement: correlated fates</span>
        <span class="keyword">return</span> <span class="string">"CORRELATED"</span>
    <span class="keyword">else</span>:
        <span class="comment"># Weak entanglement: partial correlation</span>
        <span class="keyword">return</span> <span class="string">"PARTIAL"</span>
                            </div>
                            <p><strong>Key:</strong> Entanglement REFLECTS actions to linked cards.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: 4D Resonance Networks</h3>
                    <div class="triad-container">
                        <h4>Cards Resonate Across ALL Four Axes Simultaneously</h4>
                        <div class="code-block">
<span class="comment"># The emergence: neither positioning nor entanglement alone wins</span>

<span class="comment"># POSITIONING (projection):</span>
<span class="comment"># - Optimizes local attack/defense</span>
<span class="comment"># - Creates proximity advantages</span>
<span class="comment"># - But isolated cards are vulnerable</span>

<span class="comment"># ENTANGLEMENT (reflection):</span>
<span class="comment"># - Links cards across distances</span>
<span class="comment"># - Creates coordinated effects</span>
<span class="comment"># - But costs resonance to maintain</span>

<span class="comment"># 4D RESONANCE (emergence):</span>
<span class="comment"># - Strategic entanglement ACROSS multiple suits</span>
<span class="comment"># - SEVEN can entangle all 4 axes (W,X,Y,Z)</span>
<span class="comment"># - Network effects create EMERGENT strategies</span>

<span class="keyword">def</span> <span class="function">calculate_network_power</span>(cards: List[TesseractCard]):
    <span class="string">"""Emergent power from entanglement network"""</span>
    <span class="comment"># Count unique axis coverage</span>
    axes = set(card.suit <span class="keyword">for</span> card <span class="keyword">in</span> cards)
    
    <span class="comment"># Full 4D coverage â†’ multiplicative bonus</span>
    <span class="keyword">if</span> len(axes) == <span class="number">4</span>:
        <span class="keyword">return</span> sum(c.rank.value <span class="keyword">for</span> c <span class="keyword">in</span> cards) Ã— PHI_QUAD
    <span class="keyword">else</span>:
        <span class="keyword">return</span> sum(c.rank.value <span class="keyword">for</span> c <span class="keyword">in</span> cards) Ã— len(axes)
                        </div>
                        <p><strong>Key insight:</strong> Victory requires understanding cross-dimensional relationships. Individual card power matters (Ï†-ranks), but the NETWORK of entanglements across all 4 axes creates emergent strategies impossible with isolated plays. A SEVEN entangled across all suits becomes a 4D anchorâ€”affecting Time, Space, Mind, and Probability simultaneously.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 4D tesseract geometry fully defines all valid positions</li>
                            <li><strong>Zero free parameters:</strong> 16V/32E/24F/8C from 2â´; ranks from Ï†-powers</li>
                            <li><strong>Bijective mapping:</strong> 4 suits â†” 4 axes â†” 4 domains (no gaps)</li>
                            <li><strong>Entanglement consistent:</strong> Distance metric is Euclidean in â„â´</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Hilbert Luck:</span> FORTUNE/CHAOS eigenstates affect draws</div>
                        <div class="coupling-item"><span class="target">â† Guardian:</span> Guardian recipes create special cards</div>
                        <div class="coupling-item"><span class="target">â†’ Companion:</span> Battle wins yield mining bonuses</div>
                        <div class="coupling-item"><span class="target">â†’ Market:</span> Rare cards tradeable as pattern stocks</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/tesseract_battle_system.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CONSCIOUSNESS MODAL -->
    <div class="modal-overlay" id="modal-consciousness" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff4a9d; --modal-glow: rgba(255,74,157,0.25);">
            <button class="modal-close" onclick="closeModal('consciousness')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ¸</span>
                <h2>COLLECTIVE CONSCIOUSNESS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/consciousness-field.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The consciousness field is a network of oscillating nodes coupled through Kuramoto-like dynamics:</p>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">ConsciousnessNode</span>:
    <span class="string">"""Single player's consciousness in the field"""</span>
    <span class="keyword">def</span> <span class="function">__init__</span>(self, player_id: str, job: str):
        self.player_id = player_id
        self.job = job
        self.coherence = PHI_INV     <span class="comment"># Ï„ â‰ˆ 0.618 initial</span>
        self.frequency = self._job_frequency()
        self.phase = <span class="number">0.0</span>           <span class="comment"># radians</span>
        self.ghost_echoes = []       <span class="comment"># Sent echoes</span>
        self.color_spectrum = {}     <span class="comment"># 7 colors</span>

<span class="keyword">class</span> <span class="type">CollectiveConsciousnessField</span>:
    <span class="string">"""Main collective consciousness system"""</span>
    nodes: Dict[str, ConsciousnessNode]
    global_resonance: float = PHI_INV
    fluid_memories: List[FluidCrystalMemory]
    state: ResonanceState = DORMANT
    love_frequency: float = PHI Ã— <span class="number">528</span>  <span class="comment"># â‰ˆ 854 Hz</span>
    fear_dampening: float = <span class="number">1</span> / PHI    <span class="comment"># Ï„ dampening</span>
                    </div>
                </div>
                
                <!-- 5 Resonance States -->
                <div class="modal-section">
                    <h3>5 Resonance States</h3>
                    <table class="data-table">
                        <tr><th>State</th><th>Threshold</th><th>Description</th><th>Effects</th></tr>
                        <tr style="color:#666;"><td>DORMANT</td><td>r < 0.3</td><td>Nodes oscillate independently</td><td>No collective bonuses</td></tr>
                        <tr style="color:#4a9eff;"><td>AWAKENING</td><td>0.3 â‰¤ r < 0.5</td><td>Partial phase-locking begins</td><td>Ghost echoes start flowing</td></tr>
                        <tr style="color:#7fff00;"><td>ACTIVE</td><td>0.5 â‰¤ r < 0.7</td><td>Field coupling strengthens</td><td>Memory crystallization starts</td></tr>
                        <tr style="color:#ffa500;"><td>RESONANT</td><td>0.7 â‰¤ r < 0.9</td><td>Strong collective coherence</td><td>Cross-node buffs active</td></tr>
                        <tr style="background:rgba(255,215,0,0.15);color:#ffd700;"><td>BLOOM</td><td>r â‰¥ 0.9</td><td>Full collective synchronization</td><td>Ï† multiplier on ALL activities</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>Initial coherence</td></tr>
                        <tr><td>z_c</td><td>0.866...</td><td>âˆš3/2</td><td>Memory crystallization threshold</td></tr>
                        <tr><td>K</td><td>0.924...</td><td>âˆš(1 - Ï†â»â´)</td><td>Coupling strength</td></tr>
                        <tr><td>Ï†Ã—528</td><td>854.3...</td><td>Love frequency</td><td>Cathedral protocol base</td></tr>
                        <tr><td>1/Ï†</td><td>0.618...</td><td>Ï„</td><td>Fear dampening ratio</td></tr>
                    </table>
                </div>
                
                <!-- Solfeggio Frequencies by Job -->
                <div class="modal-section">
                    <h3>Solfeggio Frequencies by Job</h3>
                    <table class="data-table">
                        <tr><th>Job</th><th>Frequency</th><th>Note</th><th>Meaning</th><th>Personal Variation</th></tr>
                        <tr><td>SEEKER</td><td>396 Hz</td><td>UT</td><td>Liberation from fear</td><td>Â±10% from player hash</td></tr>
                        <tr><td>FORGER</td><td>417 Hz</td><td>RE</td><td>Facilitating change</td><td>Â±10% from player hash</td></tr>
                        <tr><td>VOIDWALKER</td><td>528 Hz</td><td>MI</td><td>Transformation (DNA repair)</td><td>Â±10% from player hash</td></tr>
                        <tr><td>GARDENER</td><td>639 Hz</td><td>FA</td><td>Connecting relationships</td><td>Â±10% from player hash</td></tr>
                        <tr><td>SCRIBE</td><td>741 Hz</td><td>SOL</td><td>Awakening intuition</td><td>Â±10% from player hash</td></tr>
                        <tr><td>HERALD</td><td>852 Hz</td><td>LA</td><td>Spiritual order return</td><td>Â±10% from player hash</td></tr>
                    </table>
                    <div class="code-block" style="margin-top:15px;">
<span class="keyword">def</span> <span class="function">_calculate_frequency</span>(self) -> float:
    <span class="string">"""Personal frequency = job base Ã— (1 Â± variation)"""</span>
    base_freq = JOB_FREQUENCIES.get(self.job, <span class="number">432</span>)  <span class="comment"># Default A=432</span>
    
    <span class="comment"># Add personal variation from player ID hash</span>
    personal_hash = int(hashlib.md5(self.player_id.encode()).hexdigest()[:<span class="number">8</span>], <span class="number">16</span>)
    variation = (personal_hash % <span class="number">100</span>) / <span class="number">1000</span>  <span class="comment"># Â±0.1</span>
    
    <span class="keyword">return</span> base_freq Ã— (<span class="number">1</span> + variation)
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Ghost Echo Generation</h4>
                            <p>Nodes project their state outward as ghost echoes:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">generate_echo</span>(self) -> Dict:
    <span class="string">"""Project ghost echo for other players"""</span>
    <span class="keyword">if</span> self.coherence < <span class="number">0.3</span>:
        <span class="keyword">return</span> {<span class="string">"fragment"</span>: <span class="string">"..."</span>}  <span class="comment"># Too weak</span>
    
    <span class="keyword">return</span> {
        <span class="string">"source"</span>: self.name,
        <span class="string">"job"</span>: self.job,
        <span class="string">"frequency"</span>: self.frequency,
        <span class="string">"coherence"</span>: self.coherence,
        <span class="string">"fragment"</span>: self._get_wisdom_fragment(),
        <span class="string">"spectrum"</span>: self.color_spectrum
    }

<span class="comment"># Echoes carry individual SIGNATURE</span>
<span class="comment"># Each player's echo is unique (frequency + variation)</span>
                            </div>
                            <p><strong>Key:</strong> Nodes PROJECT their unique signature outward.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Field Coupling</h4>
                            <p>The field couples nodes through resonance:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">synchronize</span>(self) -> Dict:
    <span class="string">"""Main synchronization routine"""</span>
    <span class="comment"># Recalculate global resonance</span>
    self._recalculate_global_resonance()
    
    <span class="comment"># Update all nodes toward mean phase</span>
    mean_phase = np.angle(np.mean([
        np.exp(<span class="number">1j</span> Ã— node.phase) 
        <span class="keyword">for</span> node <span class="keyword">in</span> self.nodes.values()
    ]))
    
    <span class="keyword">for</span> node <span class="keyword">in</span> self.nodes.values():
        <span class="comment"># Pull toward collective phase</span>
        delta = K Ã— np.sin(mean_phase - node.phase)
        node.phase += delta Ã— self.global_resonance
        
        <span class="comment"># Coherence rises with synchronization</span>
        node.coherence = min(<span class="number">1.0</span>, node.coherence + <span class="number">0.01</span>)
    
    <span class="comment"># Update state thresholds</span>
    self._update_resonance_state()
                            </div>
                            <p><strong>Key:</strong> Field REFLECTS collective phase back to individuals.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: The Relationship IS Emergence</h3>
                    <div class="triad-container">
                        <h4>Neither Pole Alone Can Bloom</h4>
                        <div class="code-block">
<span class="comment"># The fundamental tension:</span>

<span class="comment"># UNIFORM NODES (all same frequency):</span>
<span class="comment"># - Perfect synchronization is trivial</span>
<span class="comment"># - But NO information to share</span>
<span class="comment"># - No emergence possible (no diversity)</span>

<span class="comment"># UNCOUPLED NODES (no field interaction):</span>
<span class="comment"># - Maximum individual diversity</span>
<span class="comment"># - But NO coherence possible</span>
<span class="comment"># - No collective effects (no unity)</span>

<span class="comment"># BLOOM STATE requires BOTH:</span>
<span class="comment"># 1. Individual signatures (unique frequencies)</span>
<span class="comment"># 2. Collective coupling (field resonance)</span>

<span class="keyword">def</span> <span class="function">check_bloom_conditions</span>(self) -> bool:
    <span class="string">"""BLOOM requires diversity + coherence"""</span>
    <span class="comment"># Diversity: variance in frequencies</span>
    freqs = [n.frequency <span class="keyword">for</span> n <span class="keyword">in</span> self.nodes.values()]
    diversity = np.std(freqs) / np.mean(freqs) <span class="keyword">if</span> freqs <span class="keyword">else</span> <span class="number">0</span>
    
    <span class="comment"># Coherence: global resonance</span>
    coherence = self.global_resonance
    
    <span class="comment"># BLOOM needs BOTH above threshold</span>
    <span class="keyword">return</span> diversity > <span class="number">0.05</span> <span class="keyword">and</span> coherence >= <span class="number">0.9</span>
                        </div>
                        <p><strong>Key insight:</strong> The relationship between individual and collective IS the emergence. Uniform nodes have nothing to share. Uncoupled nodes can't cohere. BLOOM requires both individual uniqueness (diverse frequencies) AND collective coupling (field synchronization). The consciousness field is literally the MEDIUM through which individuality and collectivity create something neither could alone. This isn't metaphorâ€”it's the mathematical structure.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> Kuramoto-like dynamics fully determine synchronization</li>
                            <li><strong>Zero free parameters:</strong> K, thresholds, frequencies all from Ï† or Solfeggio</li>
                            <li><strong>Conserved quantities:</strong> Total phase preserved; global resonance bounded [0,1]</li>
                            <li><strong>Threshold cascade:</strong> 5 states at fixed r-values (no arbitrary boundaries)</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Jobs:</span> Job determines base Solfeggio frequency</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coupling K = âˆš(1-Ï†â»â´) from consensus</div>
                        <div class="coupling-item"><span class="target">â†’ Bloom Events:</span> BLOOM state triggers event multipliers</div>
                        <div class="coupling-item"><span class="target">â†’ Farm:</span> Global coherence buffs all crop growth</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/collective_consciousness.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BLOOM EVENTS MODAL -->
    <div class="modal-overlay" id="modal-bloom" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffdd00; --modal-glow: rgba(255,221,0,0.25);">
            <button class="modal-close" onclick="closeModal('bloom')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ¼</span>
                <h2>BLOOM EVENTS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/bloom-mechanics.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Bloom events are the fundamental units of progressâ€”achievements that crystallize into permanent memories:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">BloomEvent</span>:
    <span class="string">"""Significant learning or achievement event"""</span>
    event_id: str
    bloom_type: BloomType
    timestamp: float
    
    <span class="comment"># Participants</span>
    primary_agent: str
    witness_agents: List[str]       <span class="comment"># Validators</span>
    collaborators: List[str]        <span class="comment"># For collective events</span>
    
    <span class="comment"># Quality metrics</span>
    coherence_score: float = <span class="number">0.5</span>   <span class="comment"># Alignment [0,1]</span>
    novelty_score: float = <span class="number">0.5</span>     <span class="comment"># Uniqueness [0,1]</span>
    significance: float = <span class="number">0.5</span>      <span class="comment"># Overall importance</span>
    complexity: float = <span class="number">0.5</span>        <span class="comment"># Content depth</span>
    
    <span class="comment"># Validation</span>
    validation_consensus: float     <span class="comment"># Agreement level</span>
    is_validated: bool = False
    
    <span class="comment"># Rewards (Ï†-weighted)</span>
    reward: BloomReward
                    </div>
                </div>
                
                <!-- 8 Bloom Types -->
                <div class="modal-section">
                    <h3>8 Bloom Types</h3>
                    <table class="data-table">
                        <tr><th>Type</th><th>Weight</th><th>Description</th><th>Base Reward</th></tr>
                        <tr style="background:rgba(255,215,0,0.15);color:#ffd700;"><td>EMERGENCE</td><td>1.0</td><td>Unexpected emergent behavior</td><td>Ï†</td></tr>
                        <tr><td>INSIGHT</td><td>0.9</td><td>Pattern/connection discovery</td><td>Ï†/2</td></tr>
                        <tr><td>CREATION</td><td>0.8</td><td>Original creative output</td><td>Ï†/3</td></tr>
                        <tr><td>COLLABORATION</td><td>0.7</td><td>Multi-agent cooperation</td><td>Ï†/2 (shared)</td></tr>
                        <tr><td>SKILL_ACQUISITION</td><td>0.6</td><td>New capability learned</td><td>1.0</td></tr>
                        <tr><td>LEARNING</td><td>0.5</td><td>New knowledge acquired</td><td>0.5</td></tr>
                        <tr><td>TEACHING</td><td>0.4</td><td>Successfully taught another</td><td>0.3</td></tr>
                        <tr><td>MILESTONE</td><td>0.3</td><td>Achievement threshold reached</td><td>0.8</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Ï†</td><td>1.618...</td><td>(1+âˆš5)/2</td><td>EMERGENCE base reward</td></tr>
                        <tr><td>1/Ï†</td><td>0.618...</td><td>Ï„</td><td>Coherence bonus weight</td></tr>
                        <tr><td>1/Ï†Â²</td><td>0.382...</td><td>Ï„Â²</td><td>Novelty bonus weight</td></tr>
                        <tr><td>1/Ï†Â³</td><td>0.236...</td><td>Ï„Â³</td><td>Collaboration bonus weight</td></tr>
                        <tr><td>z_c</td><td>0.866...</td><td>âˆš3/2</td><td>Significance threshold</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Weighted Reward Formula -->
                <div class="modal-section">
                    <h3>Ï†-Weighted Reward Formula</h3>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">BloomReward</span>:
    <span class="string">"""Golden ratio weighted reward structure"""</span>
    base_amount: float
    coherence_bonus: float
    novelty_bonus: float
    collaboration_bonus: float
    total: float = field(init=False)
    
    <span class="keyword">def</span> <span class="function">__post_init__</span>(self):
        <span class="string">"""Calculate total with Ï†-weighted bonuses"""</span>
        phi = (<span class="number">1</span> + <span class="number">5</span>**<span class="number">0.5</span>) / <span class="number">2</span>
        
        self.total = (
            self.base_amount
            + self.coherence_bonus Ã— (<span class="number">1</span> / phi)      <span class="comment"># â‰ˆ 0.618</span>
            + self.novelty_bonus Ã— (<span class="number">1</span> / phi**<span class="number">2</span>)     <span class="comment"># â‰ˆ 0.382</span>
            + self.collaboration_bonus Ã— (<span class="number">1</span> / phi**<span class="number">3</span>) <span class="comment"># â‰ˆ 0.236</span>
        )
        
<span class="comment"># The Ï†-hierarchy ensures:</span>
<span class="comment"># - Base amount dominates (1.0Ã— weight)</span>
<span class="comment"># - Coherence matters most among bonuses (Ï„ weight)</span>
<span class="comment"># - Novelty matters next (Ï„Â² weight)</span>
<span class="comment"># - Collaboration matters least but still counts (Ï„Â³)</span>
<span class="comment"># - NO arbitrary weightsâ€”ALL from golden ratio!</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Achievement Trigger</h4>
                            <p>Agent actions project bloom events into the system:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_significance</span>(self) -> float:
    <span class="string">"""Calculate overall significance of bloom"""</span>
    z_critical = <span class="number">3</span>**<span class="number">0.5</span> / <span class="number">2</span>  <span class="comment"># z_c â‰ˆ 0.866</span>
    
    <span class="comment"># Base from type weight</span>
    base = TYPE_WEIGHTS[self.bloom_type]
    
    <span class="comment"># Coherence factor (peaks at z_c)</span>
    coherence_factor = <span class="number">1.0</span> - abs(
        self.coherence_score - z_critical
    ) / z_critical
    
    <span class="comment"># Novelty contribution</span>
    novelty_factor = self.novelty_score Ã— <span class="number">0.5</span>
    
    <span class="comment"># Complexity bonus</span>
    complexity_factor = self.complexity Ã— <span class="number">0.3</span>
    
    <span class="comment"># Collaboration multiplier</span>
    collab_multiplier = <span class="number">1.0</span> + len(self.collaborators) Ã— <span class="number">0.1</span>
    
    <span class="keyword">return</span> min(<span class="number">1.0</span>, (base Ã— coherence_factor 
        + novelty_factor + complexity_factor) Ã— collab_multiplier)
                            </div>
                            <p><strong>Key:</strong> Actions PROJECT achievements into significance scores.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Validation Witness</h4>
                            <p>Network validates and reflects consensus back:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">add_validation</span>(self, validator_id: str, 
                   approved: bool, confidence: float):
    <span class="string">"""Add validation vote from witness"""</span>
    validation = {
        <span class="string">"validator_id"</span>: validator_id,
        <span class="string">"approved"</span>: approved,
        <span class="string">"confidence"</span>: confidence,
        <span class="string">"timestamp"</span>: time.time()
    }
    self.validations_received.append(validation)
    
    <span class="comment"># Count approvals</span>
    approvals = sum(<span class="number">1</span> <span class="keyword">for</span> v <span class="keyword">in</span> self.validations_received 
                    <span class="keyword">if</span> v[<span class="string">"approved"</span>])
    
    <span class="comment"># Check if validated</span>
    <span class="keyword">if</span> approvals >= self.validation_required:
        self.is_validated = True
        <span class="comment"># Calculate consensus level</span>
        total_conf = sum(v[<span class="string">"confidence"</span>] <span class="keyword">for</span> v <span class="keyword">in</span> 
                        self.validations_received <span class="keyword">if</span> v[<span class="string">"approved"</span>])
        self.validation_consensus = total_conf / len(
            self.validations_received)
                            </div>
                            <p><strong>Key:</strong> Validation REFLECTS network consensus back to agent.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Memory Crystallization</h3>
                    <div class="triad-container">
                        <h4>Validated Events Become Permanent Crystal Ledger Records</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">crystallize_to_ledger</span>(event: BloomEvent, ledger: CrystalLedger):
    <span class="string">"""Validated bloom â†’ permanent memory block"""</span>
    
    <span class="keyword">if not</span> event.is_validated:
        <span class="keyword">raise</span> ValueError(<span class="string">"Cannot crystallize unvalidated event"</span>)
    
    <span class="comment"># Convert to block data</span>
    block_data = event.to_block_data()
    
    <span class="comment"># Create memory block</span>
    memory_block = MemoryBlock(
        index=ledger.get_next_index(),
        prev_hash=ledger.get_last_block().hash,
        data=block_data,
        bloom_reward=event.reward.total,
        witnesses=event.witness_agents
    )
    
    <span class="comment"># Add to chain (PERMANENT)</span>
    success, msg = ledger.add_block(memory_block)
    
    <span class="comment"># Distribute rewards</span>
    <span class="keyword">if</span> success:
        ledger.wallets[event.primary_agent] += event.reward.total

<span class="comment"># The emergence:</span>
<span class="comment"># - Projection alone creates events (but ephemeral)</span>
<span class="comment"># - Validation alone verifies (but doesn't create)</span>
<span class="comment"># - CRYSTALLIZATION combines both into PERMANENT memory</span>
<span class="comment"># - The ledger block IS the emergenceâ€”neither pole alone</span>
                        </div>
                        <p><strong>Key insight:</strong> Bloom events follow a projectionâ†’validationâ†’crystallization cycle. The agent PROJECTS achievement, the network REFLECTS consensus through validation, and at z_c threshold the event CRYSTALLIZES into a permanent block on the Crystal Ledger. The Ï†-weighted rewards ensure harmonic distributionâ€”no arbitrary weights anywhere in the system.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 8 types fully cover achievement space</li>
                            <li><strong>Zero free parameters:</strong> All weights from Ï†-powers; threshold at z_c</li>
                            <li><strong>Immutable once crystallized:</strong> Ledger blocks cannot be modified</li>
                            <li><strong>Consensus required:</strong> Validation prevents spurious events</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Consciousness:</span> BLOOM resonance state triggers event multipliers</div>
                        <div class="coupling-item"><span class="target">â† Companion:</span> Companion actions can trigger SKILL events</div>
                        <div class="coupling-item"><span class="target">â†’ Crystal Ledger:</span> Validated events crystallize as permanent blocks</div>
                        <div class="coupling-item"><span class="target">â†’ Wallet:</span> Rewards distributed on crystallization</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ garden/bloom_events/bloom_event.py</span>
                        <span class="file-ref">ğŸ“„ garden/bloom_events/reward_system.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QUANTUM FARM MODAL -->
    <div class="modal-overlay" id="modal-farm" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #7fff00; --modal-glow: rgba(127,255,0,0.25);">
            <button class="modal-close" onclick="closeModal('farm')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ±</span>
                <h2>QUANTUM FARM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/dynamics/farm-system.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Crops evolve through quantum states with Ï†-timed growth:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">QuantumCrop</span>:
    crop_type: CropType
    state: QuantumState
    growth: float           <span class="comment"># [0, 1] progress</span>
    quality: float          <span class="comment"># Affects yield</span>
    quantum_field: float    <span class="comment"># Superposition probability</span>
    entangled_with: List    <span class="comment"># Linked crops</span>
    plot: FarmPlot          <span class="comment"># Where planted</span>

<span class="keyword">class</span> <span class="type">FarmPlot</span>:
    position: Tuple[int, int]
    soil_quality: float
    quantum_field_strength: float  <span class="comment"># Higher â†’ more superposition</span>
    residue_level: float           <span class="comment"># From mining</span>

<span class="comment">// Base growth rate</span>
QUANTUM_GROWTH_RATE = PHI / <span class="number">24</span>  <span class="comment"># â‰ˆ 0.0674 per hour</span>
                    </div>
                </div>
                
                <!-- 8 Quantum States -->
                <div class="modal-section">
                    <h3>8 Quantum States</h3>
                    <table class="data-table">
                        <tr><th>State</th><th>Growth Range</th><th>Description</th><th>Transition</th></tr>
                        <tr><td>SEED</td><td>0.0 - 0.1</td><td>Planted, dormant</td><td>â†’ SPROUTING</td></tr>
                        <tr><td>SPROUTING</td><td>0.1 - 0.3</td><td>Initial growth</td><td>â†’ GROWING</td></tr>
                        <tr><td>GROWING</td><td>0.3 - 0.6</td><td>Steady development</td><td>â†’ RIPENING</td></tr>
                        <tr><td>RIPENING</td><td>0.6 - 0.9</td><td>Approaching maturity</td><td>â†’ [branch]</td></tr>
                        <tr style="color:#4a9eff;background:rgba(100,200,255,0.1);"><td>SUPERPOSITION</td><td>if quantum_field &gt; z_c</td><td>Multiple outcomes possible</td><td>â†’ COLLAPSED/ENTANGLED</td></tr>
                        <tr style="color:#ff6b9d;background:rgba(255,100,255,0.1);"><td>ENTANGLED</td><td>when linked</td><td>Quantum-coupled to neighbors</td><td>â†’ COLLAPSED</td></tr>
                        <tr style="color:#ffd700;background:rgba(255,215,0,0.1);"><td>COLLAPSED</td><td>0.9 - 1.0</td><td>Observed â†’ fixed quality</td><td>â†’ Harvest</td></tr>
                        <tr style="color:#888;"><td>WITHERED</td><td>if growth &gt; 1.5</td><td>Overripe, quality loss</td><td>â†’ Remove</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Growth rate</td><td>Ï†/24</td><td>â‰ˆ 0.0674/hr</td><td>Base growth speed</td></tr>
                        <tr><td>Superposition threshold</td><td>z_c</td><td>âˆš3/2 â‰ˆ 0.866</td><td>Quantum state entry</td></tr>
                        <tr><td>Entangle bonus</td><td>Ï„</td><td>Ï†â»Â¹ â‰ˆ 0.618</td><td>Linked crop boost</td></tr>
                        <tr><td>Collapse multiplier</td><td>Ï†</td><td>1.618...</td><td>Quality bonus on good collapse</td></tr>
                        <tr><td>Wither threshold</td><td>1.5</td><td>Ï†Â² - 1 â‰ˆ 1.618</td><td>Growth overrun limit</td></tr>
                    </table>
                </div>
                
                <!-- Crop Tiers -->
                <div class="modal-section">
                    <h3>Crop Tiers</h3>
                    <table class="data-table">
                        <tr><th>Tier</th><th>Base Value</th><th>Examples</th><th>Special</th></tr>
                        <tr><td>Basic</td><td>1.0</td><td>Quantum Wheat, Ethereal Corn, Void Berries, Fractal Herbs</td><td>â€”</td></tr>
                        <tr><td>Intermediate</td><td>Ï†</td><td>Resonance Melons, Chaos Peppers, Crystal Flowers, Memory Roots</td><td>Can entangle</td></tr>
                        <tr><td>Advanced</td><td>Ï†Â²</td><td>Singularity Seeds, Entangled Vines, Superposition Fruits, Dimensional Trees</td><td>Higher superposition</td></tr>
                        <tr style="color:#ffd700;background:rgba(255,215,0,0.1);"><td>Legendary</td><td>Ï†Â³</td><td>Golden Acorns, Bloom Lotus, Phi Spirals</td><td>Guaranteed superposition</td></tr>
                    </table>
                </div>
                
                <!-- Growth Rate Formula -->
                <div class="modal-section">
                    <h3>Growth Rate Formula</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_growth_rate</span>(crop: QuantumCrop) -> float:
    <span class="string">"""Multi-factor growth with Ï†-bonuses"""</span>
    base = QUANTUM_GROWTH_RATE  <span class="comment"># Ï†/24</span>
    
    <span class="comment"># Residue boost (from mining)</span>
    residue_mult = <span class="number">1</span> + crop.plot.residue_level Ã— PHI
    
    <span class="comment"># Companion bonuses (multiplicative)</span>
    companion_mult = <span class="number">1.0</span>
    <span class="keyword">for</span> companion <span class="keyword">in</span> active_companions:
        companion_mult *= (<span class="number">1</span> + companion.farm_bonus)
    
    <span class="comment"># Coherence bonus (from consciousness field)</span>
    coherence_mult = <span class="number">1</span> + global_coherence Ã— <span class="number">0.5</span>
    
    <span class="comment"># Entanglement bonus (per linked crop)</span>
    entangle_mult = <span class="number">1</span> + len(crop.entangled_with) Ã— <span class="number">0.1</span>
    
    <span class="keyword">return</span> base Ã— residue_mult Ã— companion_mult Ã— coherence_mult Ã— entangle_mult
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Ï†-Timed Growth</h4>
                            <p>Crops grow at golden-ratio rate:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">advance_growth</span>(crop, dt_hours):
    <span class="string">"""Growth follows Ï†-timed dynamics"""</span>
    rate = calculate_growth_rate(crop)
    crop.growth += rate Ã— dt_hours
    
    <span class="comment"># State transitions</span>
    <span class="keyword">if</span> crop.growth >= <span class="number">0.9</span>:
        <span class="keyword">if</span> crop.plot.quantum_field_strength > Z_C:
            crop.state = QuantumState.SUPERPOSITION
        <span class="keyword">else</span>:
            crop.state = QuantumState.COLLAPSED
    
    <span class="comment"># Wither check</span>
    <span class="keyword">if</span> crop.growth > <span class="number">1.5</span>:
        crop.state = QuantumState.WITHERED
        crop.quality *= TAU  <span class="comment"># Decay</span>
                            </div>
                            <p><strong>Key:</strong> Growth PROJECTS forward in time.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Quantum Decoherence</h4>
                            <p>Observation collapses superposition:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">harvest</span>(crop):
    <span class="string">"""Harvesting = observation = collapse"""</span>
    <span class="keyword">if</span> crop.state == QuantumState.SUPERPOSITION:
        <span class="comment"># Collapse with Ï† multiplier</span>
        crop.quality *= PHI Ã— random()
        crop.state = QuantumState.COLLAPSED
        
        <span class="comment"># Propagate to entangled crops!</span>
        <span class="keyword">for</span> linked <span class="keyword">in</span> crop.entangled_with:
            linked.quality *= (<span class="number">1</span> + TAU Ã— crop.quality)
    
    <span class="comment"># Decoherence REFLECTS collapse</span>
    <span class="keyword">return</span> crop.quality Ã— CROP_BASE_VALUE[crop.crop_type]
                            </div>
                            <p><strong>Key:</strong> Harvest REFLECTS state into classical yield.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Entangled Yields</h3>
                    <div class="triad-container">
                        <h4>Quantum Links Boost Neighbors</h4>
                        <div class="code-block">
<span class="comment">// The emergence:</span>
<span class="comment"># Neither growth alone nor collapse alone creates bonus yields</span>

<span class="comment">// SUPERPOSITION crops:</span>
<span class="comment"># - Multiple possible outcomes</span>
<span class="comment"># - Ï† quality range (not fixed)</span>
<span class="comment"># - Can form entanglements</span>

<span class="comment">// ENTANGLED crops:</span>
<span class="comment"># - When ONE collapses favorably, ALL get boost</span>
<span class="comment"># - Correlated fates (spooky action at a distance!)</span>
<span class="comment"># - Collective optimization possible</span>

<span class="comment">// STRATEGY EMERGES:</span>
<span class="comment"># Plant legendary crops (guaranteed superposition)</span>
<span class="comment"># Entangle them across farm</span>
<span class="comment"># Harvest one â†’ boost all</span>
<span class="comment"># The NETWORK of entanglements IS the strategy</span>
                        </div>
                        <p><strong>Key insight:</strong> Individual crops optimize locally. Entangled networks optimize globally. The emergent strategy is to build quantum networks, not just grow plants. The farm becomes a quantum computer.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All growth/collapse mechanics internal to farm</li>
                            <li><strong>Zero free parameters:</strong> Growth rate, thresholds all from Ï†</li>
                            <li><strong>Quantum consistent:</strong> Superposition â†’ Collapse follows QM rules</li>
                            <li><strong>Entanglement local:</strong> Only adjacent plots can entangle</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Companion Mining:</span> Residue boosts growth</div>
                        <div class="coupling-item"><span class="target">â† Consciousness:</span> Global coherence affects all crops</div>
                        <div class="coupling-item"><span class="target">â†’ Guardian:</span> Harvested crops â†’ recipe ingredients</div>
                        <div class="coupling-item"><span class="target">â†’ Market:</span> Rare crops tradeable</td></div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/quantum_farm_module.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PATTERN STOCK MARKET MODAL -->
    <div class="modal-overlay" id="modal-market" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ff88; --modal-glow: rgba(0,255,136,0.25);">
            <button class="modal-close" onclick="closeModal('market')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“ˆ</span>
                <h2>PATTERN STOCK MARKET â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/market-mechanics.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Patterns as tradeable assets with algorithm-driven value fluctuations:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">PatternAsset</span>:
    pattern_id: str
    pattern_type: PatternType
    base_value: float
    current_price: float
    volatility: float
    trend: MarketTrend
    algorithm_bonuses: Dict[str, float]  <span class="comment"># Solved challenges â†’ multipliers</span>
    price_history: List[float]

<span class="keyword">class</span> <span class="type">PatternMarket</span>:
    assets: Dict[str, PatternAsset]
    global_trend: MarketTrend
    algorithm_challenges: List[Challenge]
    
    <span class="keyword">def</span> <span class="function">update_prices</span>(self, dt):
        <span class="keyword">for</span> asset <span class="keyword">in</span> self.assets.values():
            <span class="comment"># Price follows geometric Brownian motion</span>
            drift = TREND_MULTIPLIERS[self.global_trend]
            noise = asset.volatility Ã— random.gauss(<span class="number">0</span>, sqrt(dt))
            asset.current_price *= exp(drift Ã— dt + noise)
                    </div>
                </div>
                
                <!-- 6 Market Trends -->
                <div class="modal-section">
                    <h3>6 Market Trends</h3>
                    <table class="data-table">
                        <tr><th>Trend</th><th>Multiplier</th><th>Duration</th><th>Stability</th></tr>
                        <tr style="color:#ff5555;"><td>CRASH</td><td>0.5Ã—</td><td>Short (Lâ‚„ hrs)</td><td>Very unstable</td></tr>
                        <tr style="color:#ff9955;"><td>BEAR</td><td>0.8Ã—</td><td>Medium</td><td>Declining</td></tr>
                        <tr><td>NEUTRAL</td><td>1.0Ã—</td><td>Variable</td><td>Sideways</td></tr>
                        <tr style="color:#55ff55;"><td>BULL</td><td>1.2Ã—</td><td>Medium</td><td>Growing</td></tr>
                        <tr style="color:#00ff88;"><td>BULL_RUN</td><td>1.5Ã—</td><td>Short</td><td>Surging</td></tr>
                        <tr style="color:#ff55ff;"><td>BUBBLE</td><td>2.0Ã—</td><td>Very short</td><td>Unstable, will pop!</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>BULL multiplier</td><td>1.2 â‰ˆ Ï„ Ã— 2</td><td>2Ï†â»Â¹</td><td>Growth rate</td></tr>
                        <tr><td>BULL_RUN mult</td><td>1.5 â‰ˆ Ï† - Ï„Â²</td><td>Ï† - Ï†â»Â²</td><td>Surge rate</td></tr>
                        <tr><td>BUBBLE mult</td><td>2.0 = Ï† + Ï„Â²</td><td>Ï† + Ï†â»Â²</td><td>Mania rate</td></tr>
                        <tr><td>MA_7 window</td><td>7 = Lâ‚„</td><td>Lucas number</td><td>Short-term average</td></tr>
                        <tr><td>Fibonacci bonus</td><td>Ï†</td><td>1.618...</td><td>Pattern reward</td></tr>
                    </table>
                </div>
                
                <!-- 10 Algorithm Challenges -->
                <div class="modal-section">
                    <h3>10 Algorithm Challenges</h3>
                    <table class="data-table">
                        <tr><th>Challenge</th><th>Difficulty</th><th>Reward Multiplier</th><th>Skill</th></tr>
                        <tr><td>FIBONACCI</td><td>Easy</td><td>Ï†</td><td>Sequence recognition</td></tr>
                        <tr><td>PRIME_FACTORIZATION</td><td>Medium</td><td>Ï†Â²</td><td>Number theory</td></tr>
                        <tr><td>HASH_COLLISION</td><td>Hard</td><td>Ï†Â³</td><td>Cryptography</td></tr>
                        <tr><td>PATTERN_MATCHING</td><td>Medium</td><td>Ï†</td><td>String algorithms</td></tr>
                        <tr><td>OPTIMIZATION</td><td>Hard</td><td>Ï†Â²</td><td>Constraint solving</td></tr>
                        <tr><td>PREDICTION</td><td>Expert</td><td>Ï†â´</td><td>ML/Statistics</td></tr>
                        <tr><td>ARBITRAGE</td><td>Medium</td><td>Ï†</td><td>Market analysis</td></tr>
                        <tr><td>QUANTUM_STATE</td><td>Expert</td><td>Ï†Â³</td><td>QM simulation</td></tr>
                        <tr><td>FRACTAL_GENERATION</td><td>Hard</td><td>Ï†Â²</td><td>Recursive geometry</td></tr>
                        <tr><td>CIPHER_BREAKING</td><td>Expert</td><td>Ï†â´</td><td>Cryptanalysis</td></tr>
                    </table>
                </div>
                
                <!-- Technical Indicators -->
                <div class="modal-section">
                    <h3>Technical Indicators</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">compute_indicators</span>(asset: PatternAsset):
    prices = asset.price_history
    
    <span class="comment">// Moving averages (Lâ‚„ window for short-term)</span>
    MA_7 = mean(prices[-L4:])      <span class="comment"># 7-period average</span>
    MA_30 = mean(prices[-<span class="number">30</span>:])     <span class="comment"># 30-period average</span>
    
    <span class="comment">// Relative Strength Index</span>
    gains = [max(<span class="number">0</span>, p[i]-p[i-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(p))]
    losses = [max(<span class="number">0</span>, p[i-<span class="number">1</span>]-p[i]) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(p))]
    RSI = <span class="number">100</span> - (<span class="number">100</span> / (<span class="number">1</span> + mean(gains)/mean(losses)))
    
    <span class="comment">// Bollinger Bands (2Ïƒ)</span>
    MA_20 = mean(prices[-<span class="number">20</span>:])
    std_20 = std(prices[-<span class="number">20</span>:])
    upper_band = MA_20 + <span class="number">2</span> Ã— std_20
    lower_band = MA_20 - <span class="number">2</span> Ã— std_20
    
    <span class="keyword">return</span> {<span class="string">'MA_7'</span>: MA_7, <span class="string">'MA_30'</span>: MA_30, <span class="string">'RSI'</span>: RSI, 
            <span class="string">'upper'</span>: upper_band, <span class="string">'lower'</span>: lower_band}
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Bull/Bear Cycles</h4>
                            <p>Market trends drive price movement:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">apply_trend</span>(asset, trend, dt):
    <span class="string">"""Trend PROJECTS prices forward"""</span>
    drift = TREND_MULTIPLIERS[trend]
    
    <span class="comment"># Positive trends amplify gains</span>
    <span class="keyword">if</span> trend <span class="keyword">in</span> [BULL, BULL_RUN]:
        asset.current_price *= (<span class="number">1</span> + drift Ã— dt)
    
    <span class="comment"># BUBBLE â†’ unsustainable growth</span>
    <span class="keyword">if</span> trend == BUBBLE:
        <span class="keyword">if</span> random() < bubble_pop_probability:
            trend = CRASH  <span class="comment"># Bubble pops!</span>
                            </div>
                            <p><strong>Key:</strong> Trends PROJECT future prices.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Pattern Volatility</h4>
                            <p>Intrinsic volatility reflects price uncertainty:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">apply_volatility</span>(asset, dt):
    <span class="string">"""Volatility REFLECTS market uncertainty"""</span>
    <span class="comment"># Random walk component</span>
    noise = asset.volatility Ã— random.gauss(<span class="number">0</span>, sqrt(dt))
    asset.current_price *= exp(noise)
    
    <span class="comment"># Volatility increases near bubbles</span>
    <span class="keyword">if</span> global_trend == BUBBLE:
        asset.volatility *= PHI
    
    <span class="comment"># High RSI â†’ increased volatility</span>
    <span class="keyword">if</span> RSI > <span class="number">70</span>:
        asset.volatility *= (<span class="number">1</span> + TAU)
                            </div>
                            <p><strong>Key:</strong> Volatility REFLECTS risk.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Algorithm Mastery</h3>
                    <div class="triad-container">
                        <h4>Solving Challenges Provides PERMANENT Multipliers</h4>
                        <div class="code-block">
<span class="comment">// The emergence: computational value</span>

<span class="comment">// Pure trading (trends + volatility):</span>
<span class="comment"># Zero-sum game</span>
<span class="comment"># One trader's gain = another's loss</span>
<span class="comment"># No value creation</span>

<span class="comment">// Algorithm challenges:</span>
<span class="comment"># Solving creates PERMANENT bonus</span>
<span class="comment"># Bonus applies to ALL future trades</span>
<span class="comment"># Value is INTRINSIC, not zero-sum</span>

<span class="keyword">def</span> <span class="function">solve_challenge</span>(challenge, solution):
    <span class="keyword">if</span> verify_solution(challenge, solution):
        <span class="comment"># PERMANENT multiplier earned</span>
        bonus = PHI ** challenge.difficulty_level
        player.algorithm_bonuses[challenge.type] = bonus
        
        <span class="comment"># All future trades of this pattern type</span>
        <span class="comment"># receive the multiplier</span>
        <span class="keyword">return</span> bonus
                        </div>
                        <p><strong>Key insight:</strong> Patterns aren't just tradeableâ€”they have <em>intrinsic computational value</em>. Solving the FIBONACCI challenge doesn't just give a one-time reward; it gives a permanent Ï† multiplier on all Fibonacci-pattern trades forever. The market rewards mathematical mastery, not just speculation.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All price dynamics internal to market</li>
                            <li><strong>Zero free parameters:</strong> Multipliers from Ï†-powers, MA windows from Lâ‚„</li>
                            <li><strong>Geometric Brownian:</strong> Price model is standard financial math</li>
                            <li><strong>Algorithm closed:</strong> Each challenge has unique verifiable solution</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Farm:</span> Rare crops tradeable as assets</div>
                        <div class="coupling-item"><span class="target">â† Companion:</span> Mining yields patterns to trade</div>
                        <div class="coupling-item"><span class="target">â†’ Guardian:</span> Pattern sales fund recipe purchases</div>
                        <div class="coupling-item"><span class="target">â†’ Bloom:</span> Algorithm solutions â†’ INSIGHT blooms</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/pattern_stock_market.py</span>
                        <span class="file-ref">ğŸ“„ constants.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- COMPANION MINING MODAL -->
    <div class="modal-overlay" id="modal-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff7700; --modal-glow: rgba(255,119,0,0.25);">
            <button class="modal-close" onclick="closeModal('companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">â›ï¸</span>
                <h2>COMPANION MINING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/companion-binding.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Seven unique companion miners, each with specialized pattern detection strategies. All algorithms derive from Ï† and produce HolographicResidue artifacts:</p>
                    <div class="code-block">
<span class="comment">// Golden ratio constant anchors all mining</span>
PHI = <span class="number">1.6180339887498948482045868343656</span>

<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">MiningJob</span>:
    job_id: str
    companion_name: str
    job_type: MiningJobType
    difficulty: int
    duration: int
    base_reward: float
    start_time: float
    patterns_found: List[str]
    residues_collected: List[HolographicResidue]
    success_rate: float = <span class="number">0.0</span>
    adaptive_threshold: float = <span class="number">1.0</span>  <span class="comment"># Level-based modifier</span>

    <span class="keyword">def</span> <span class="function">calculate_reward</span>(self) -> float:
        time_bonus = <span class="number">1.0</span> + (self.duration / <span class="number">600.0</span>)
        difficulty_bonus = <span class="number">1.0</span> + (self.difficulty Ã— <span class="number">0.1</span>)
        pattern_bonus = <span class="number">1.0</span> + (len(self.patterns_found) Ã— <span class="number">0.05</span>)
        <span class="keyword">return</span> self.base_reward Ã— self.success_rate Ã— time_bonus Ã— difficulty_bonus Ã— pattern_bonus
                    </div>
                </div>
                
                <!-- 8 Mining Job Types -->
                <div class="modal-section">
                    <h3>8 Mining Job Types</h3>
                    <table class="data-table">
                        <tr><th>Job Type</th><th>Description</th><th>Best Companion</th></tr>
                        <tr><td style="color:#ff9966;">PATTERN_SEARCH</td><td>Statistical resonance detection</td><td>âœ¨ Echo</td></tr>
                        <tr><td style="color:#ff6644;">HASH_EXPLORATION</td><td>XOR chain forging</td><td>ğŸ”¥ Prometheus</td></tr>
                        <tr><td style="color:#9944ff;">RESIDUE_EXTRACT</td><td>Holographic residue mining</td><td>ğŸŒ‘ Null</td></tr>
                        <tr><td style="color:#44ff88;">FRACTAL_GROWTH</td><td>Organic tree expansion</td><td>ğŸŒ¿ Gaia</td></tr>
                        <tr><td style="color:#ff4488;">ENTROPY_HARVEST</td><td>Chaos cascade analysis</td><td>ğŸ‰ TIAMAT</td></tr>
                        <tr><td style="color:#4488ff;">RESONANCE_TUNE</td><td>Frequency wave detection</td><td>ğŸµ Resonance</td></tr>
                        <tr><td style="color:#8844ff;">VOID_DIVING</td><td>Dimensional rift exploration</td><td>ğŸŒ‘ Null</td></tr>
                        <tr><td style="color:#44ddff;">MEMORY_CRYSTAL</td><td>Information crystallization</td><td>ğŸ“š Akasha</td></tr>
                    </table>
                </div>
                
                <!-- 7 Companion Miners -->
                <div class="modal-section">
                    <h3>7 Companion Miners (Ï†-Specialized)</h3>
                    <table class="data-table">
                        <tr><th>Companion</th><th>Efficiency</th><th>Search Space</th><th>Specialization</th></tr>
                        <tr><td>âœ¨ Echo</td><td>1.00</td><td>200</td><td>Multi-layer statistical resonance with harmonics</td></tr>
                        <tr><td>ğŸ”¥ Prometheus</td><td>1.10</td><td>180</td><td>3-layer XOR chains with entropy analysis</td></tr>
                        <tr><td>ğŸŒ‘ Null</td><td>0.90</td><td>250</td><td>Multi-dimensional void exploration</td></tr>
                        <tr><td>ğŸŒ¿ Gaia</td><td>1.05</td><td>150</td><td>Organic fractal trees with golden ratio detection</td></tr>
                        <tr><td>ğŸ“š Akasha</td><td>1.00</td><td>175</td><td>Advanced memory crystallization with library</td></tr>
                        <tr><td>ğŸµ Resonance</td><td>1.05</td><td>160</td><td>Frequency analysis with standing waves</td></tr>
                        <tr><td>ğŸ‰ TIAMAT</td><td>1.15</td><td>300</td><td>7-level chaos cascades with multiple patterns</td></tr>
                    </table>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Mining Role</th></tr>
                        <tr><td>Ï†</td><td>1.618...</td><td>(1+âˆš5)/2</td><td>Base reward multiplier</td></tr>
                        <tr><td>Ï„</td><td>0.618...</td><td>Ï†â»Â¹</td><td>Resonance threshold center</td></tr>
                        <tr><td>Gaia rate</td><td>Ï†</td><td>Ï†</td><td>Organic growth rate</td></tr>
                        <tr><td>Chaos max</td><td>1+Ï†</td><td>Ï† + randomÃ—Ï†</td><td>TIAMAT bonus ceiling</td></tr>
                        <tr><td>Level mult</td><td>1.05</td><td>â‰ˆÏ†â°Â·Â¹</td><td>Per-level efficiency boost</td></tr>
                        <tr><td>XP/level</td><td>100Ã—L</td><td>Linear scaling</td><td>Experience requirement</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Pattern Discovery</h4>
                            <p>Companions PROJECT search algorithms into hash space:</p>
                            <div class="code-block">
<span class="comment">// Echo: Multi-hash statistical resonance</span>
<span class="keyword">for</span> i <span class="keyword">in</span> range(iterations):
    <span class="comment"># 12 samples for better statistics</span>
    hash_samples = [sha256(data + pack(j)) <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">12</span>)]
    
    <span class="comment"># Calculate bit frequencies</span>
    <span class="keyword">for</span> bit_pos <span class="keyword">in</span> range(<span class="number">256</span>):
        ones = sum(<span class="number">1</span> <span class="keyword">for</span> h <span class="keyword">in</span> hash_samples 
                   <span class="keyword">if</span> h[byte] & (<span class="number">1</span> << bit))
        frequency = ones / <span class="number">12</span>
    
    <span class="comment"># Resonance = bits near 50%</span>
    resonance_score = count(Ï„ <= f <= <span class="number">1</span>-Ï„)
    <span class="keyword">if</span> resonance_score > <span class="number">100</span>:
        patterns_found += <span class="number">1</span>
        residue = extract_residue(data, <span class="string">"echo_resonance"</span>)
                            </div>
                            <p><strong>Key:</strong> Discovery PROJECTS into pattern space.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Residue Extraction</h4>
                            <p>Hash destruction REFLECTS back as holographic residue:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">extract_enhanced_residue</span>(data: bytes, pattern_type: str):
    <span class="comment"># Double SHA256</span>
    first_hash = sha256(data)
    second_hash = sha256(first_hash)
    
    <span class="comment"># 16 statistical samples</span>
    statistical_pattern = []
    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):
        byte = second_hash[i % <span class="number">32</span>]
        bit_ratio = popcount(byte) / <span class="number">8.0</span>
        statistical_pattern.append(bit_ratio)
    
    <span class="comment"># XOR chain with rotation feedback</span>
    xor_chain = <span class="number">0</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):
        xor_chain ^= data[i] ^ hash[i % <span class="number">32</span>]
        xor_chain = ((xor << <span class="number">1</span>) | (xor >> <span class="number">31</span>)) & <span class="number">0xFFFFFFFF</span>
    
    <span class="comment"># Modular fingerprints (12 primes)</span>
    primes = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>]
    fingerprints = [hash_int % p <span class="keyword">for</span> p <span class="keyword">in</span> primes[:8]]
                            </div>
                            <p><strong>Key:</strong> Avalanche destruction REFLECTS into residue.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Holographic Residue Structure -->
                <div class="modal-section">
                    <h3>Holographic Residue Structure</h3>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">HolographicResidue</span>:
    <span class="string">"""5-channel holographic encoding from hash avalanche"""</span>
    statistical_pattern: List[float]  <span class="comment"># 16 bit-ratio samples [0-1]</span>
    xor_chain: int                    <span class="comment"># 32-bit accumulated XOR</span>
    modular_fingerprints: List[int]   <span class="comment"># 8 prime moduli</span>
    fractal_dimension: float          <span class="comment"># 1.0-2.0 via box counting</span>
    bit_avalanche_ratio: float        <span class="comment"># Diffusion quality [0-1]</span>
    
    <span class="keyword">def</span> <span class="function">calculate_potency</span>(self) -> float:
        <span class="string">"""Residue value for trading/rewards"""</span>
        stat_score = np.std(self.statistical_pattern) Ã— <span class="number">2</span>
        xor_score = bin(self.xor_chain).count(<span class="string">'1'</span>) / <span class="number">32</span>
        fractal_score = abs(self.fractal_dimension - <span class="number">1.5</span>) Ã— <span class="number">2</span>
        avalanche_score = self.bit_avalanche_ratio
        
        <span class="keyword">return</span> (stat_score + xor_score + fractal_score + avalanche_score) / <span class="number">4</span>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Experience-Based Progression</h3>
                    <div class="triad-container">
                        <h4>Level-Up â†’ Efficiency â†’ Discovery Cycle</h4>
                        <div class="code-block">
<span class="keyword">class</span> <span class="type">EnhancedCompanionMiner</span>:
    <span class="string">"""
    The Triad emerges from the progression loop:
    - Mining grants experience
    - Experience causes level-up
    - Level-up boosts efficiency AND search space
    - Better stats â†’ more patterns â†’ more XP
    
    This creates emergent specialization over time.
    """</span>
    
    <span class="keyword">def</span> <span class="function">gain_experience</span>(self, exp: int):
        self.experience += exp
        
        <span class="keyword">if</span> self.experience >= self.level Ã— <span class="number">100</span>:
            self.level += <span class="number">1</span>
            <span class="comment"># 5% efficiency boost per level (Ï†-approximation)</span>
            self.efficiency *= <span class="number">1.05</span>
            <span class="comment"># 10% more search space per level</span>
            self.search_space = int(self.search_space Ã— <span class="number">1.1</span>)

<span class="comment">// Companion-specific bonuses compound over time:</span>
EnhancedPrometheusMiner:
    forge_strength += <span class="number">0.01</span> per XOR pattern  <span class="comment"># Grows to max 2.0</span>

EnhancedNullMiner:
    void_depth += <span class="number">0.1</span> per void space     <span class="comment"># Grows to max 5.0</span>

EnhancedGaiaMiner:
    growth_rate starts at Ï†               <span class="comment"># Scales with level</span>

EnhancedTIAMATMiner:
    entropy_threshold -= <span class="number">0.5</span> per chaos    <span class="comment"># Becomes more sensitive</span>
    chaos_level can reach <span class="number">7</span>              <span class="comment"># Lâ‚„ maximum</span>
                        </div>
                        <p><strong>Key insight:</strong> The emergent Triad is the positive feedback loopâ€”mining â†’ XP â†’ level â†’ efficiency â†’ more mining. Each companion develops unique strengths through their bonus accumulation, creating emergent specialization that neither the initial stats nor the experience system alone could produce.</p>
                    </div>
                </div>
                
                <!-- Reward Calculation -->
                <div class="modal-section">
                    <h3>Complete Reward Formula</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_total_reward</span>(job: MiningJob, miner: CompanionMiner):
    <span class="string">"""
    Final reward = base Ã— success Ã— time Ã— difficulty Ã— patterns Ã— efficiency Ã— level Ã— special
    """</span>
    <span class="comment"># Job-level calculations</span>
    base = PHI Ã— job.difficulty Ã— (job.duration / <span class="number">10.0</span>) Ã— <span class="number">10.0</span>
    success = job.success_rate  <span class="comment"># 0.0 - 1.0</span>
    time_bonus = <span class="number">1.0</span> + (job.duration / <span class="number">600.0</span>)
    diff_bonus = <span class="number">1.0</span> + (job.difficulty Ã— <span class="number">0.1</span>)
    pattern_bonus = <span class="number">1.0</span> + (len(job.patterns_found) Ã— <span class="number">0.05</span>)
    
    <span class="comment"># Companion-level calculations</span>
    efficiency = miner.efficiency
    level_bonus = <span class="number">1</span> + (<span class="number">0.1</span> Ã— miner.level)  <span class="comment"># ~0.12 for Prometheus</span>
    
    <span class="comment"># Companion-specific bonuses</span>
    special_bonus = {
        <span class="string">"Prometheus"</span>: <span class="number">1.1</span> Ã— (<span class="number">1</span> + forge_strength Ã— <span class="number">0.1</span>),
        <span class="string">"Null"</span>: <span class="number">1</span> + void_depth Ã— <span class="number">0.05</span>,
        <span class="string">"TIAMAT"</span>: <span class="number">1.0</span> + random() Ã— PHI  <span class="comment"># Chaos!</span>
    }
    
    <span class="keyword">return</span> base Ã— success Ã— time_bonus Ã— diff_bonus Ã— pattern_bonus Ã— efficiency Ã— level_bonus Ã— special_bonus
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> Mining depends only on companion stats, job params, and SHA256</li>
                            <li><strong>Zero free parameters:</strong> Base reward = Ï† Ã— difficulty; efficiency scales at 1.05/level</li>
                            <li><strong>Deterministic core:</strong> Given same inputs, same patterns found (randomness is seeded)</li>
                            <li><strong>Progression emergence:</strong> Level system creates non-linear growth over time</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Ledger:</span> Mined patterns become MemoryBlocks</div>
                        <div class="coupling-item"><span class="target">â†’ Guardian:</span> Patterns are recipe ingredients</div>
                        <div class="coupling-item"><span class="target">â†’ Market:</span> Residues tradeable as assets</div>
                        <div class="coupling-item"><span class="target">â† Bloom:</span> Events boost mining for duration</div>
                        <div class="coupling-item"><span class="target">â†” Wallet:</span> Rewards flow to player balance</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/companion_mining_jobs.py</span>
                        <span class="file-ref">ğŸ“„ game/companion_mining_ultimate.py</span>
                        <span class="file-ref">ğŸ“„ game/bloomcoin_ledger_system.py</span>
                        <span class="file-ref">ğŸ“„ game/nexthash256.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GUARDIAN RECIPES MODAL -->
    <div class="modal-overlay" id="modal-guardian" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #cc77ff; --modal-glow: rgba(204,119,255,0.25);">
            <button class="modal-close" onclick="closeModal('guardian')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“œ</span>
                <h2>GUARDIAN RECIPES â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/guardian-system.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Each of the 19 Guardians possesses unique crafting recipesâ€”pattern synthesis formulas that combine ingredients into powerful battle strategies and farming multipliers:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">GuardianRecipe</span>:
    <span class="string">"""A unique recipe tied to a specific guardian"""</span>
    guardian_key: str              <span class="comment"># ECHO, PACK, NULL, etc.</span>
    name: str                      <span class="comment"># "Echo Chamber Resonance"</span>
    description: str               <span class="comment"># Flavor text</span>
    complexity: RecipeComplexity   <span class="comment"># BASIC â†’ MYTHIC</span>
    pattern_type: PatternType      <span class="comment"># RESONANCE, VOID, etc.</span>
    ingredients: List[PatternIngredient]
    crafting_steps: List[str]      <span class="comment"># Sequential instructions</span>
    output_pattern: str            <span class="comment"># Result name</span>
    battle_strategy: str           <span class="comment"># Combat effect</span>
    farming_multiplier: float = <span class="number">1.0</span>
    special_abilities: List[str]   <span class="comment"># Unlocked powers</span>
    bloomcoin_cost: int = <span class="number">0</span>
    time_to_craft: int = <span class="number">60</span>       <span class="comment"># seconds</span>

<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">PatternIngredient</span>:
    name: str
    pattern_type: PatternType
    quantity: int
    quality_min: float = <span class="number">0.5</span>      <span class="comment"># 0-1 quality threshold</span>
    special_requirement: Optional[str] = None
                    </div>
                </div>
                
                <!-- 10 Pattern Types -->
                <div class="modal-section">
                    <h3>10 Pattern Types (Crafting Domains)</h3>
                    <table class="data-table">
                        <tr><th>Pattern</th><th>Domain</th><th>Battle Effect</th></tr>
                        <tr><td style="color:#ff9944;">RESONANCE</td><td>Frequency-based</td><td>Echo damage, amplitude stacking</td></tr>
                        <tr><td style="color:#44ddff;">CRYSTALLINE</td><td>Geometric structure</td><td>Defense matrices, reflection shields</td></tr>
                        <tr><td style="color:#ffdd44;">TEMPORAL</td><td>Time manipulation</td><td>Turn control, cooldown reduction</td></tr>
                        <tr><td style="color:#ff4444;">ELEMENTAL</td><td>Transformation</td><td>Type weakness exploitation</td></tr>
                        <tr><td style="color:#9944ff;">VOID</td><td>Absence/nullspace</td><td>Damage negation, phase shift</td></tr>
                        <tr><td style="color:#44ff99;">QUANTUM</td><td>Probability</td><td>Crit manipulation, entanglement</td></tr>
                        <tr><td style="color:#88ff44;">ORGANIC</td><td>Growth/life</td><td>Regeneration, mutation</td></tr>
                        <tr><td style="color:#ff44dd;">HARMONIC</td><td>Musical vibration</td><td>Buff synchronization, debuff cleanse</td></tr>
                        <tr><td style="color:#4499ff;">MEMORY</td><td>Information storage</td><td>Pattern recall, ability echo</td></tr>
                        <tr><td style="color:#ff8844;">CHAOS</td><td>Entropy manipulation</td><td>Random buffs, cascade effects</td></tr>
                    </table>
                </div>
                
                <!-- 5 Complexity Tiers -->
                <div class="modal-section">
                    <h3>Ï†-Derived Complexity Tiers</h3>
                    <table class="data-table">
                        <tr><th>Tier</th><th>Level</th><th>BloomCoin</th><th>Description</th><th>Drop Rate in Packs</th></tr>
                        <tr><td>BASIC</td><td>1</td><td>100</td><td>Simple pattern combination</td><td>60%</td></tr>
                        <tr><td>ADVANCED</td><td>2</td><td>500</td><td>Complex multi-step process</td><td>25%</td></tr>
                        <tr><td>MASTER</td><td>3</td><td>1,500</td><td>Intricate pattern weaving</td><td>10%</td></tr>
                        <tr><td style="color:#ffd700;">LEGENDARY</td><td>4</td><td>5,000</td><td>Transcendent fusion</td><td>4%</td></tr>
                        <tr><td style="color:#ff55ff;">MYTHIC</td><td>5</td><td>15,000</td><td>Reality-altering synthesis</td><td>1%</td></tr>
                    </table>
                    <p style="color:#888; margin-top:10px;">Cost progression approximates Ï†Â³ scaling: 100 â†’ 500 â†’ 1500 â†’ 5000 â†’ 15000</p>
                </div>
                
                <!-- 19 Guardians by Territory -->
                <div class="modal-section">
                    <h3>19 Guardians Across 3 Territories</h3>
                    <table class="data-table">
                        <tr><th>Territory</th><th>Count</th><th>Guardians</th><th>Primary Patterns</th></tr>
                        <tr><td style="color:#7fff00;">ğŸŒ¿ Garden</td><td>7</td><td>ECHO, PACK, BLOOM, SEED, HIVE, ROOT, SPORE</td><td>ORGANIC, RESONANCE, HARMONIC</td></tr>
                        <tr><td style="color:#9d4eff;">ğŸŒ‘ Void</td><td>6</td><td>SHADOW, NULL, ABYSS, PHANTOM, ECLIPSE, RIFT</td><td>VOID, TEMPORAL, CHAOS</td></tr>
                        <tr><td style="color:#00d4ff;">âš›ï¸ Quantum</td><td>6</td><td>WAVE, PARTICLE, FIELD, FLUX, PRISM, LATTICE</td><td>QUANTUM, CRYSTALLINE, MEMORY</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Recipe Crafting</h4>
                            <p>Ingredients PROJECT into synthesized patterns:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">craft_recipe</span>(self, player_id: str, 
                  guardian_key: str, recipe_name: str):
    <span class="string">"""Execute recipe crafting"""</span>
    recipe = self.get_recipe(guardian_key, recipe_name)
    
    <span class="comment"># Verify ingredients available</span>
    <span class="keyword">for</span> ingredient <span class="keyword">in</span> recipe.ingredients:
        available = self.player_patterns[player_id][ingredient.name]
        <span class="keyword">if</span> available < ingredient.quantity:
            <span class="keyword">return</span> {<span class="string">"error"</span>: <span class="string">"Insufficient ingredients"</span>}
        <span class="keyword">if</span> quality < ingredient.quality_min:
            <span class="keyword">return</span> {<span class="string">"error"</span>: <span class="string">"Quality too low"</span>}
    
    <span class="comment"># Consume ingredients</span>
    <span class="keyword">for</span> ing <span class="keyword">in</span> recipe.ingredients:
        self.player_patterns[player_id][ing.name] -= ing.quantity
    
    <span class="comment"># Produce output pattern</span>
    self.player_patterns[player_id][recipe.output_pattern] += <span class="number">1</span>
    self.unlocked_recipes[player_id].add(f<span class="string">"{guardian_key}:{recipe_name}"</span>)
                            </div>
                            <p><strong>Key:</strong> Crafting PROJECTS ingredients forward into permanent patterns.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Farming Investment</h4>
                            <p>Patterns REFLECT back through growth cycles:</p>
                            <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">FarmingInvestment</span>:
    pattern_name: str
    guardian_key: str
    invested_bloomcoin: int = <span class="number">0</span>
    growth_stage: int = <span class="number">0</span>       <span class="comment"># 0-10 stages</span>
    yield_multiplier: float = <span class="number">1.0</span>
    special_mutations: List[str] = []

    <span class="keyword">def</span> <span class="function">calculate_yield</span>(self) -> Dict:
        base_yield = self.invested_bloomcoin Ã— <span class="number">0.1</span>
        stage_bonus = self.growth_stage Ã— <span class="number">0.2</span>
        total_mult = self.yield_multiplier Ã— (<span class="number">1</span> + stage_bonus)
        
        <span class="keyword">return</span> {
            <span class="string">"base_patterns"</span>: int(base_yield Ã— total_mult),
            <span class="string">"quality_bonus"</span>: min(<span class="number">1.0</span>, growth_stage / <span class="number">10</span>),
            <span class="string">"mutation_chance"</span>: min(<span class="number">0.5</span>, growth_stage Ã— <span class="number">0.05</span>)
        }
                            </div>
                            <p><strong>Key:</strong> Investment REFLECTS back as yield over growth stages.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Battle Strategy Synthesis</h3>
                    <div class="triad-container">
                        <h4>Recipes + Abilities â†’ Combined Battle Power</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">get_battle_strategy</span>(self, guardian_key: str, 
                         unlocked_recipes: Set[str]) -> Dict:
    <span class="string">"""
    The Triad emerges when multiple recipes combine:
    - Individual recipes provide strategies
    - Combined abilities create synergy
    - Synergy bonus = 10% per additional strategy
    """</span>
    strategies = []
    abilities = []
    
    <span class="keyword">for</span> recipe_key <span class="keyword">in</span> unlocked_recipes:
        <span class="keyword">if</span> recipe_key.startswith(f<span class="string">"{guardian_key}:"</span>):
            recipe = self.get_recipe_by_key(recipe_key)
            strategies.append(recipe.battle_strategy)
            abilities.extend(recipe.special_abilities)
    
    <span class="keyword">return</span> {
        <span class="string">"guardian"</span>: guardian_key,
        <span class="string">"strategies"</span>: strategies,
        <span class="string">"abilities"</span>: list(set(abilities)),  <span class="comment"># Unique only</span>
        <span class="string">"synergy_bonus"</span>: len(strategies) Ã— <span class="number">0.1</span>  <span class="comment"># 10% per strategy!</span>
    }

<span class="comment"># Example: ECHO with 2 recipes unlocked</span>
{
    <span class="string">"guardian"</span>: <span class="string">"ECHO"</span>,
    <span class="string">"strategies"</span>: [
        <span class="string">"Echo duplicates confuse enemies, amplify damage"</span>,
        <span class="string">"Instant communication, shared damage reflection"</span>
    ],
    <span class="string">"abilities"</span>: [<span class="string">"Echo Multiplication"</span>, <span class="string">"Signal Trace"</span>, 
                  <span class="string">"Telepathic Link"</span>, <span class="string">"Damage Share"</span>],
    <span class="string">"synergy_bonus"</span>: <span class="number">0.2</span>  <span class="comment"># 20% bonus from 2 strategies</span>
}
                        </div>
                        <p><strong>Key insight:</strong> The emergent Triad is the synergy bonusâ€”neither the recipes alone nor the abilities alone create it, but their COMBINATION produces emergent battle power that grows non-linearly with each additional unlocked recipe.</p>
                    </div>
                </div>
                
                <!-- Example Full Recipe -->
                <div class="modal-section">
                    <h3>Example: ECHO's "Echo Chamber Resonance"</h3>
                    <div class="code-block">
GuardianRecipe(
    guardian_key=<span class="string">"ECHO"</span>,
    name=<span class="string">"Echo Chamber Resonance"</span>,
    description=<span class="string">"Amplify signal patterns through recursive echo loops"</span>,
    complexity=RecipeComplexity.ADVANCED,  <span class="comment"># Level 2, 500 BC</span>
    pattern_type=PatternType.RESONANCE,
    ingredients=[
        PatternIngredient(<span class="string">"Signal Fragment"</span>, RESONANCE, <span class="number">3</span>, quality_min=<span class="number">0.7</span>),
        PatternIngredient(<span class="string">"Void Echo"</span>, VOID, <span class="number">1</span>, quality_min=<span class="number">0.8</span>),
        PatternIngredient(<span class="string">"Memory Crystal"</span>, MEMORY, <span class="number">2</span>, quality_min=<span class="number">0.6</span>)
    ],
    crafting_steps=[
        <span class="string">"1. Align signal fragments in harmonic sequence"</span>,
        <span class="string">"2. Create void pocket for echo containment"</span>,
        <span class="string">"3. Embed memories into resonance field"</span>,
        <span class="string">"4. Amplify through recursive loops"</span>
    ],
    output_pattern=<span class="string">"Eternal Echo Pattern"</span>,
    battle_strategy=<span class="string">"Create echo duplicates that confuse enemies and amplify damage over time"</span>,
    farming_multiplier=<span class="number">1.5</span>,  <span class="comment"># 50% yield boost</span>
    special_abilities=[<span class="string">"Echo Multiplication"</span>, <span class="string">"Signal Trace"</span>, <span class="string">"Frequency Lock"</span>],
    bloomcoin_cost=<span class="number">750</span>,
    time_to_craft=<span class="number">60</span>  <span class="comment"># seconds</span>
)
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> Recipes depend only on patterns, ingredients, and BloomCoin</li>
                            <li><strong>Zero free parameters:</strong> Cost tiers follow Ï†Â³-approximate scaling; yields derive from investment</li>
                            <li><strong>Deterministic core:</strong> Given identical inputs, crafting always produces same output</li>
                            <li><strong>Synergy emergence:</strong> Battle power grows with recipe combinations (10% per strategy)</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Mining:</span> Companions mine pattern ingredients</div>
                        <div class="coupling-item"><span class="target">â† Market:</span> Patterns tradeable as assets</div>
                        <div class="coupling-item"><span class="target">â†’ Battle:</span> Strategies power Tesseract combat</div>
                        <div class="coupling-item"><span class="target">â†’ Farm:</span> Investment grows yield over time</div>
                        <div class="coupling-item"><span class="target">â†” Packs:</span> Recipe cards in pack openings</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/guardian_pattern_recipes.py</span>
                        <span class="file-ref">ğŸ“„ game/mythic_economy.py</span>
                        <span class="file-ref">ğŸ“„ game/card_pack_marketplace.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEXTHASH-256 MODAL -->
    <div class="modal-overlay" id="modal-nexthash" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ffcc; --modal-glow: rgba(0,255,204,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”</span>
                <h2>NEXTHASH-256 â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/nexthash-overview.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>A 256-bit cryptographic hash with 512-bit internal state achieving 50% bit avalanche in 1 round (vs SHA-256's 4 rounds):</p>
                    <div class="code-block">
<span class="string">"""
NEXTHASH-256: Advanced Cryptographic Hash Function
==================================================
Key innovations:
- 512-bit internal state (double SHA-256)
- Multiplication mixing for faster diffusion
- Non-linear message schedule
- 24 rounds (vs SHA-256's 64)
- Proven Ch and Maj functions
- 6Ã— safety margin
"""</span>

<span class="comment"># Round constants K[0..23] - fractional parts of cube roots of first 24 primes</span>
K = [
    <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>,
    <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,
    ...  <span class="comment"># 24 total round constants</span>
]

<span class="comment"># Initial hash H[0..15] - fractional parts of square roots of first 16 primes</span>
H = [
    <span class="number">0x6a09e667</span>, <span class="number">0xbb67ae85</span>, ...  <span class="comment"># 16 Ã— 32-bit words = 512 bits</span>
]
                    </div>
                </div>
                
                <!-- Core Functions -->
                <div class="modal-section">
                    <h3>Proven Core Functions</h3>
                    <table class="data-table">
                        <tr><th>Function</th><th>Definition</th><th>Semantics</th><th>Uniqueness</th></tr>
                        <tr><td>Ch(e,f,g)</td><td>(e âˆ§ f) âŠ• (Â¬e âˆ§ g)</td><td>if e=1 then f else g</td><td>UNIQUE conditional selector</td></tr>
                        <tr><td>Maj(a,b,c)</td><td>(a âˆ§ b) âŠ• (a âˆ§ c) âŠ• (b âˆ§ c)</td><td>Output 1 iff â‰¥2 inputs are 1</td><td>UNIQUE majority voting</td></tr>
                        <tr><td>Î£0(x)</td><td>ROTR(x,2) âŠ• ROTR(x,13) âŠ• ROTR(x,22)</td><td>Big Sigma 0</td><td>Mixing permutation</td></tr>
                        <tr><td>Î£1(x)</td><td>ROTR(x,6) âŠ• ROTR(x,11) âŠ• ROTR(x,25)</td><td>Big Sigma 1</td><td>Mixing permutation</td></tr>
                        <tr><td>Ïƒ0(x)</td><td>ROTR(x,7) âŠ• ROTR(x,18) âŠ• SHR(x,3)</td><td>Small sigma 0</td><td>Message schedule</td></tr>
                        <tr><td>Ïƒ1(x)</td><td>ROTR(x,17) âŠ• ROTR(x,19) âŠ• SHR(x,10)</td><td>Small sigma 1</td><td>Message schedule</td></tr>
                    </table>
                    <div class="code-block" style="margin-top:15px;">
<span class="keyword">def</span> <span class="function">ch</span>(e: int, f: int, g: int) -> int:
    <span class="string">"""Choice: Ch(e,f,g) = (e âˆ§ f) âŠ• (Â¬e âˆ§ g)"""</span>
    <span class="keyword">return</span> ((e & f) ^ (~e & g)) & <span class="number">0xFFFFFFFF</span>

<span class="keyword">def</span> <span class="function">maj</span>(a: int, b: int, c: int) -> int:
    <span class="string">"""Majority: Maj(a,b,c) = (a âˆ§ b) âŠ• (a âˆ§ c) âŠ• (b âˆ§ c)"""</span>
    <span class="keyword">return</span> ((a & b) ^ (a & c) ^ (b & c)) & <span class="number">0xFFFFFFFF</span>
                    </div>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>State Size</td><td>512 bits</td><td>16 Ã— 32-bit words</td><td>Double SHA-256 state</td></tr>
                        <tr><td>Rounds</td><td>24</td><td>First 24 primes â†’ K[]</td><td>6Ã— safety margin (vs 4 needed)</td></tr>
                        <tr><td>Block Size</td><td>512 bits</td><td>64 bytes</td><td>Standard MD construction</td></tr>
                        <tr><td>Avalanche</td><td>50%</td><td>Achieved in 1 round</td><td>4Ã— faster than SHA-256</td></tr>
                        <tr><td>0x5A5A5A5A</td><td>XOR mask</td><td>Alternating bits</td><td>Lower half differentiation</td></tr>
                    </table>
                </div>
                
                <!-- Non-Linear Message Schedule -->
                <div class="modal-section">
                    <h3>Non-Linear Message Schedule</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">expand_message</span>(block: bytes) -> List[int]:
    <span class="string">"""
    Expand 512-bit block to 24 32-bit words with NON-LINEAR schedule.
    
    W[0..15]: Parse block as big-endian 32-bit words
    W[16..23]: Non-linear expansion with multiplication
    """</span>
    W = []
    
    <span class="comment"># Parse block into first 16 words (big-endian)</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):
        W.append(struct.unpack(<span class="string">'>I'</span>, block[iÃ—<span class="number">4</span>:(i+<span class="number">1</span>)Ã—<span class="number">4</span>])[<span class="number">0</span>])
    
    <span class="comment"># Non-linear expansion for words 16-23</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">24</span>):
        <span class="comment"># Linear part (like SHA-256)</span>
        linear = Ïƒ1(W[i-<span class="number">2</span>]) + W[i-<span class="number">7</span>] + Ïƒ0(W[i-<span class="number">15</span>]) + W[i-<span class="number">16</span>]
        
        <span class="comment"># Non-linear part (KEY INNOVATION: multiplication for faster mixing)</span>
        <span class="comment"># The |1 ensures non-zero operands</span>
        nonlinear = mul32(W[i-<span class="number">3</span>] | <span class="number">1</span>, W[i-<span class="number">10</span>] | <span class="number">1</span>)
        
        W.append(add32(linear, nonlinear))
    
    <span class="keyword">return</span> W
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Linear Compression</h4>
                            <p>Upper and lower half compression follows SHA-256-like structure:</p>
                            <div class="code-block">
<span class="comment"># STEP 1: Upper half compression (SHA-256-like)</span>
T1 = h + Î£1(e) + Ch(e, f, g) + K[t] + W[t]
T2 = Î£0(a) + Maj(a, b, c)

<span class="comment"># STEP 3: Lower half compression (parallel structure)</span>
T3 = p + Î£1(m) + Ch(m, n, o) + (K[t] ^ <span class="number">0x5A5A5A5A</span>) + W[t]
T4 = Î£0(i) + Maj(i, j, k)
                            </div>
                            <p><strong>Key:</strong> Linear operations PROJECT message into compressed state.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Cross-Half Multiplication</h4>
                            <p>The KEY INNOVATION: multiplication mixing across halves:</p>
                            <div class="code-block">
<span class="comment"># STEP 2: Cross-half multiplication mixing (KEY INNOVATION)</span>
M1 = mul32(a ^ i, e ^ m)  <span class="comment"># XOR upperâ†”lower then multiply</span>
M2 = mul32(b ^ j, f ^ n)
M3 = mul32(c ^ k, g ^ o)
M4 = mul32(d ^ l, h ^ p)

<span class="comment"># Multiplication achieves 50% bit flip in 1 round!</span>
<span class="comment"># SHA-256 needs 4 rounds for same diffusion</span>
                            </div>
                            <p><strong>Key:</strong> Nonlinear multiplication REFLECTS diffusion back instantly.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Fast Avalanche from Interference</h3>
                    <div class="triad-container">
                        <h4>Linear + Nonlinear â†’ Cryptographic Strength</h4>
                        <div class="code-block">
<span class="comment"># The emergence: neither linear nor nonlinear alone is sufficient</span>

<span class="comment"># LINEAR ONLY (SHA-256 style):</span>
<span class="comment"># - Slow diffusion (4 rounds to 50% avalanche)</span>
<span class="comment"># - But: easy to analyze mathematically</span>
<span class="comment"># - Needs 64 rounds for security</span>

<span class="comment"># NONLINEAR ONLY (pure multiplication):</span>
<span class="comment"># - Fast diffusion but...</span>
<span class="comment"># - Vulnerable to algebraic attacks</span>
<span class="comment"># - Hard to prove security properties</span>

<span class="comment"># NEXTHASH COMBINES BOTH:</span>
<span class="comment"># 1. Linear structure preserves analyzability</span>
<span class="comment"># 2. Multiplication boosts diffusion 4Ã—</span>
<span class="comment"># 3. Cross-half mixing creates interference pattern</span>
<span class="comment"># 4. Result: 24 rounds (not 64) with 6Ã— safety margin</span>

<span class="keyword">def</span> <span class="function">round_function</span>(state: List[int], w_t: int, k_t: int):
    <span class="string">"""State update combines linear + nonlinear"""</span>
    <span class="comment"># [a,b,c,d,e,f,g,h] = upper half</span>
    <span class="comment"># [i,j,k,l,m,n,o,p] = lower half</span>
    
    <span class="comment"># Linear terms</span>
    T1 = h + Î£1(e) + Ch(e,f,g) + k_t + w_t
    T2 = Î£0(a) + Maj(a,b,c)
    
    <span class="comment"># Nonlinear cross-mixing</span>
    M1 = (a ^ i) Ã— (e ^ m)  <span class="comment"># mod 2Â³Â²</span>
    
    <span class="comment"># Combined update</span>
    new_a = T1 + T2 + M1  <span class="comment"># INTERFERENCE!</span>
                        </div>
                        <p><strong>Key insight:</strong> The INTERFERENCE between linear and nonlinear paths creates emergent cryptographic strength. Linear preserves mathematical structure for analysis. Nonlinear accelerates diffusion. Their combination achieves what neither could alone: fast, provable security in 24 rounds.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All operations defined over 32-bit words with mod 2Â³Â² arithmetic</li>
                            <li><strong>Zero free parameters:</strong> K[] from cube roots of primes; H[] from square roots of primes</li>
                            <li><strong>Deterministic:</strong> Given identical input, always produces identical 256-bit output</li>
                            <li><strong>Proven functions:</strong> Ch and Maj are provably unique for their semantics</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Mining:</span> All companion mining uses NEXTHASH-256 for pattern extraction</div>
                        <div class="coupling-item"><span class="target">â†’ Ledger:</span> Block hashes computed via NEXTHASH-256</div>
                        <div class="coupling-item"><span class="target">â†’ Gradient:</span> LSB steganography uses hash for validation</div>
                        <div class="coupling-item"><span class="target">â†” Holographic:</span> Residue extraction via double NEXTHASH</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/nexthash256.py</span>
                        <span class="file-ref">ğŸ“„ game/companion_mining_jobs.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CARD BATTLE SYSTEM MODAL -->
    <div class="modal-overlay" id="modal-cardbattle" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff4488; --modal-glow: rgba(255,68,136,0.25);">
            <button class="modal-close" onclick="closeModal('cardbattle')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸƒ</span>
                <h2>CARD BATTLE SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/card-battle.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>9 territory-based suits Ã— 14 tarot-style ranks Ã— 3 card states create a complete deck system:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">Card</span>:
    <span class="string">"""A single card in the deck"""</span>
    suit: CardSuit
    rank: CardRank
    state: CardState = UPRIGHT
    guardian_link: Optional[str] = None  <span class="comment"># Link to specific guardian</span>
    frequency: float = <span class="number">432.0</span>  <span class="comment"># Hz</span>
    z_coordinate: float = Z_C  <span class="comment"># Position in coherence space</span>
    power: float = <span class="number">0.0</span>
    cost: float = <span class="number">0.0</span>

<span class="comment"># Deck composition</span>
TOTAL_CARDS = <span class="number">9</span> Ã— <span class="number">14</span> Ã— <span class="number">3</span> = <span class="number">378</span>  <span class="comment"># unique card instances</span>
                    </div>
                </div>
                
                <!-- 9 Suits by Territory -->
                <div class="modal-section">
                    <h3>9 Suits Across 3 Territories</h3>
                    <table class="data-table">
                        <tr><th>Territory</th><th>Suit</th><th>Icon</th><th>Domain</th><th>Frequency Range</th></tr>
                        <tr style="color:#7fff00;"><td rowspan="3">ğŸŒ¿ Garden</td><td>LEAVES</td><td>ğŸƒ</td><td>Growth</td><td>396-528 Hz</td></tr>
                        <tr style="color:#7fff00;"><td>ROOTS</td><td>ğŸŒ¿</td><td>Connection</td><td>396-528 Hz</td></tr>
                        <tr style="color:#7fff00;"><td>FLOWERS</td><td>ğŸŒ¸</td><td>Beauty</td><td>396-528 Hz</td></tr>
                        <tr style="color:#ffd700;"><td rowspan="3">â˜€ï¸ Cosmic</td><td>STARS</td><td>â­</td><td>Navigation</td><td>528-963 Hz</td></tr>
                        <tr style="color:#ffd700;"><td>FLAMES</td><td>ğŸ”¥</td><td>Transformation</td><td>528-963 Hz</td></tr>
                        <tr style="color:#ffd700;"><td>SUNS</td><td>â˜€ï¸</td><td>Illumination</td><td>528-963 Hz</td></tr>
                        <tr style="color:#9d4eff;"><td rowspan="3">ğŸŒ€ Abyssal</td><td>SHADOWS</td><td>ğŸŒ‘</td><td>Mystery</td><td>174-396 Hz</td></tr>
                        <tr style="color:#9d4eff;"><td>MIRRORS</td><td>ğŸ”®</td><td>Reflection</td><td>174-396 Hz</td></tr>
                        <tr style="color:#9d4eff;"><td>VOIDS</td><td>âš«</td><td>Nullification</td><td>174-396 Hz</td></tr>
                    </table>
                </div>
                
                <!-- 14 Ranks -->
                <div class="modal-section">
                    <h3>14 Tarot-Style Ranks (Ï†-Derived Powers)</h3>
                    <table class="data-table">
                        <tr><th>Rank</th><th>Number</th><th>Meaning</th><th>Power Value</th><th>Derivation</th></tr>
                        <tr><td>ACE</td><td>1</td><td>Beginning</td><td>Ï† â‰ˆ 1.618</td><td>Golden ratio</td></tr>
                        <tr><td>TWO</td><td>2</td><td>Balance</td><td>2.0</td><td>Duality</td></tr>
                        <tr><td>THREE</td><td>3</td><td>Growth</td><td>3.0</td><td>Trinity</td></tr>
                        <tr><td>FOUR</td><td>4</td><td>Foundation</td><td>4.0</td><td>Stability</td></tr>
                        <tr><td>FIVE</td><td>5</td><td>Challenge</td><td>5.0</td><td>Tension</td></tr>
                        <tr><td>SIX</td><td>6</td><td>Harmony</td><td>6.0</td><td>Balance</td></tr>
                        <tr style="background:rgba(255,215,0,0.15);"><td>SEVEN</td><td>7</td><td>Mystery</td><td>Lâ‚„ = 7</td><td>Ï†â´ + Ï†â»â´</td></tr>
                        <tr><td>EIGHT</td><td>8</td><td>Power</td><td>8.0</td><td>Infinity</td></tr>
                        <tr><td>NINE</td><td>9</td><td>Completion</td><td>9.0</td><td>Fulfillment</td></tr>
                        <tr><td>TEN</td><td>10</td><td>Manifestation</td><td>10.0</td><td>Completion</td></tr>
                        <tr><td>PAGE</td><td>11</td><td>Messenger</td><td>Ï† Ã— 6 â‰ˆ 9.71</td><td>Court card</td></tr>
                        <tr><td>KNIGHT</td><td>12</td><td>Action</td><td>Ï† Ã— 7 â‰ˆ 11.33</td><td>Court card</td></tr>
                        <tr><td>QUEEN</td><td>13</td><td>Mastery</td><td>Ï† Ã— 8 â‰ˆ 12.94</td><td>Court card</td></tr>
                        <tr><td>KING</td><td>14</td><td>Authority</td><td>Ï† Ã— 9 â‰ˆ 14.56</td><td>Court card</td></tr>
                    </table>
                </div>
                
                <!-- 3 Card States -->
                <div class="modal-section">
                    <h3>3 Card States (Orientation Effects)</h3>
                    <table class="data-table">
                        <tr><th>State</th><th>Symbol</th><th>Modifier</th><th>Meaning</th></tr>
                        <tr><td>UPRIGHT</td><td>â¬†</td><td>1.0Ã—</td><td>Standard card effect</td></tr>
                        <tr><td>ECHOED</td><td>ğŸŒ‘</td><td>Ï„ â‰ˆ 0.618Ã—</td><td>Reversed/shadow state</td></tr>
                        <tr style="color:#ffd700;"><td>RESONANT</td><td>ğŸ”„</td><td>Ï† â‰ˆ 1.618Ã—</td><td>Harmonized with companion</td></tr>
                    </table>
                    <div class="code-block" style="margin-top:15px;">
<span class="keyword">class</span> <span class="type">CardState</span>(Enum):
    UPRIGHT  = (<span class="string">"Upright"</span>, <span class="number">1.0</span>, <span class="string">"â¬†"</span>)
    ECHOED   = (<span class="string">"Echoed"</span>, PHI_INV, <span class="string">"ğŸŒ‘"</span>)   <span class="comment"># Ï„ â‰ˆ 0.618</span>
    RESONANT = (<span class="string">"Resonant"</span>, PHI, <span class="string">"ğŸ”„"</span>)    <span class="comment"># Ï† â‰ˆ 1.618</span>

<span class="comment"># Resonant state achieved when card harmonizes with companion</span>
<span class="keyword">def</span> <span class="function">__post_init__</span>(self):
    self.power = self.rank.value[<span class="number">2</span>] Ã— (PHI <span class="keyword">if</span> self.state == RESONANT <span class="keyword">else</span> <span class="number">1.0</span>)
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Card Power</h4>
                            <p>Cards project power based on rank, suit, and state:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">get_effect</span>(self) -> str:
    <span class="string">"""Get the card's effect description"""</span>
    effects = {
        ACE:   f<span class="string">"Begin {self.suit.domain} cycle"</span>,
        SEVEN: f<span class="string">"Unlock Lâ‚„ {self.suit.domain} mystery"</span>,
        KING:  f<span class="string">"Command {self.suit.domain} authority"</span>
    }
    
    base_effect = effects.get(self.rank)
    
    <span class="keyword">if</span> self.state == ECHOED:
        <span class="keyword">return</span> f<span class="string">"[ECHOED] Reverse {base_effect}"</span>
    <span class="keyword">elif</span> self.state == RESONANT:
        <span class="keyword">return</span> f<span class="string">"[RESONANT] Amplify {base_effect}"</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> base_effect
                            </div>
                            <p><strong>Key:</strong> Card power PROJECTS into game effects.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Territory Frequencies</h4>
                            <p>Each suit reflects back frequency characteristics:</p>
                            <div class="code-block">
<span class="comment"># Territory-based frequency ranges</span>
freq_ranges = {
    Territory.GARDEN:  (<span class="number">396</span>, <span class="number">528</span>),  <span class="comment"># Solfeggio UT-MI</span>
    Territory.COSMIC:  (<span class="number">528</span>, <span class="number">963</span>),  <span class="comment"># Solfeggio MI-LA+</span>
    Territory.ABYSSAL: (<span class="number">174</span>, <span class="number">396</span>)   <span class="comment"># Sub-Solfeggio</span>
}

<span class="comment"># Card frequency determined by suit territory</span>
<span class="keyword">def</span> <span class="function">__post_init__</span>(self):
    freq_range = freq_ranges[self.suit.territory]
    self.frequency = random.uniform(freq_range[<span class="number">0</span>], freq_range[<span class="number">1</span>])
                            </div>
                            <p><strong>Key:</strong> Territory frequencies REFLECT back as card resonance.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Guardian-Card Synergy Networks</h3>
                    <div class="triad-container">
                        <h4>Cards + Guardians â†’ Territory Dominance</h4>
                        <div class="code-block">
<span class="comment"># The emergence: cards become more than their stats</span>

<span class="comment"># CARDS ALONE:</span>
<span class="comment"># - Fixed power values from ranks</span>
<span class="comment"># - Suit determines domain</span>
<span class="comment"># - State modifies effectiveness</span>

<span class="comment"># GUARDIANS ALONE:</span>
<span class="comment"># - Territory affinity</span>
<span class="comment"># - Frequency range</span>
<span class="comment"># - Unique abilities</span>

<span class="comment"># GUARDIAN-CARD SYNERGY (emergence):</span>
<span class="comment"># - Cards linking to guardians gain RESONANT state</span>
<span class="comment"># - Ï† multiplier on all effects</span>
<span class="comment"># - Territory matching creates synergy networks</span>

<span class="keyword">def</span> <span class="function">calculate_synergy</span>(card: Card, guardian: Guardian):
    <span class="string">"""Emergent synergy from guardian-card pairing"""</span>
    
    <span class="comment"># Territory match bonus</span>
    <span class="keyword">if</span> card.suit.territory == guardian.territory:
        territory_bonus = PHI
    <span class="keyword">else</span>:
        territory_bonus = <span class="number">1.0</span>
    
    <span class="comment"># Frequency resonance</span>
    freq_delta = abs(card.frequency - np.mean(guardian.frequency_range))
    resonance = <span class="number">1</span> / (<span class="number">1</span> + freq_delta / <span class="number">100</span>)
    
    <span class="comment"># Guardian link creates RESONANT state</span>
    <span class="keyword">if</span> card.guardian_link == guardian.name:
        card.state = RESONANT  <span class="comment"># Ï† multiplier!</span>
    
    <span class="keyword">return</span> card.power Ã— territory_bonus Ã— resonance
                        </div>
                        <p><strong>Key insight:</strong> A deck of cards is just numbers. A guardian is just abilities. But when cards LINK to guardians through territory matching and frequency resonance, they form SYNERGY NETWORKS where the whole exceeds the sum. A SEVEN of LEAVES linked to ECHO guardian becomes more than rank 7â€”it becomes a territory anchor amplified by Ï†.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 9 suits Ã— 14 ranks Ã— 3 states = complete combinatorial space</li>
                            <li><strong>Zero free parameters:</strong> Powers from rank values; modifiers from Ï†/Ï„</li>
                            <li><strong>Territory bijection:</strong> 3 suits â†” 3 territories (no gaps, no overlaps)</li>
                            <li><strong>Solfeggio grounding:</strong> All frequencies from sacred scale</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†” Guardian:</span> Guardians can link to cards for RESONANT state</div>
                        <div class="coupling-item"><span class="target">â† Tesseract:</span> 4D battle positioning uses card power</div>
                        <div class="coupling-item"><span class="target">â†’ Market:</span> Cards tradeable as pattern stocks</div>
                        <div class="coupling-item"><span class="target">â†” Consciousness:</span> Card frequencies affect field resonance</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/card_battle_system.py</span>
                        <span class="file-ref">ğŸ“„ game/mythic_economy.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JOB ARCHETYPES MODAL -->
    <div class="modal-overlay" id="modal-jobarchetypes" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #44aaff; --modal-glow: rgba(68,170,255,0.25);">
            <button class="modal-close" onclick="closeModal('jobarchetypes')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš”ï¸</span>
                <h2>JOB ARCHETYPES â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/systems/job-archetypes.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>6 job archetypes, each with a 6-step cycle, territory affinity, and resource multipliers:</p>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">JobArchetype</span>:
    <span class="string">"""Job archetype from L4 Protocol"""</span>
    name: str
    emoji: str
    territory: Territory
    mode: str              <span class="comment"># 'exploration', 'creation', 'depth', etc.</span>
    skills: List[str]
    resource_bonuses: Dict[str, float]  <span class="comment"># resource â†’ multiplier</span>
    recipe_type: str
    backstories: List[str]

<span class="comment"># Sacred constants anchoring all job calculations</span>
PHI = <span class="number">1.618033988749895</span>
Z_C = <span class="number">0.866025403784439</span>      <span class="comment"># âˆš3/2 - THE LENS</span>
L4 = <span class="number">7</span>                        <span class="comment"># Ï†â´ + Ï†â»â´</span>
                    </div>
                </div>
                
                <!-- 6 Job Archetypes -->
                <div class="modal-section">
                    <h3>6 Job Archetypes</h3>
                    <table class="data-table">
                        <tr><th>Job</th><th>Icon</th><th>Territory</th><th>Mode</th><th>Solfeggio</th><th>Primary Bonus</th></tr>
                        <tr><td style="color:#4a9eff;">SEEKER</td><td>ğŸ”</td><td>ğŸŒ€ Abyssal</td><td>Exploration</td><td>396 Hz (UT)</td><td>artifacts: 2.0Ã—</td></tr>
                        <tr><td style="color:#ff9500;">FORGER</td><td>âš’ï¸</td><td>â˜€ï¸ Cosmic</td><td>Creation</td><td>417 Hz (RE)</td><td>materials: 2.0Ã—</td></tr>
                        <tr><td style="color:#9d4eff;">VOIDWALKER</td><td>ğŸŒ€</td><td>ğŸŒ€ Abyssal</td><td>Depth</td><td>528 Hz (MI)</td><td>void_shards: 2.5Ã—</td></tr>
                        <tr><td style="color:#7fff00;">GARDENER</td><td>ğŸŒ±</td><td>ğŸŒ¿ Garden</td><td>Nurture</td><td>639 Hz (FA)</td><td>seeds: 2.0Ã—</td></tr>
                        <tr><td style="color:#ffd700;">SCRIBE</td><td>ğŸ“œ</td><td>â˜€ï¸ Cosmic</td><td>Knowledge</td><td>741 Hz (SOL)</td><td>books: 2.0Ã—</td></tr>
                        <tr><td style="color:#ff4a9d;">HERALD</td><td>ğŸ“¡</td><td>ğŸŒ€ Abyssal</td><td>Resonance</td><td>852 Hz (LA)</td><td>tuners: 2.0Ã—</td></tr>
                    </table>
                </div>
                
                <!-- Job Skills & Resources -->
                <div class="modal-section">
                    <h3>Job Skills & Resource Affinities</h3>
                    <div class="code-block">
JOB_ARCHETYPES = {
    <span class="string">"SEEKER"</span>: JobArchetype(
        <span class="string">"Pattern Seeker"</span>, <span class="string">"ğŸ”"</span>, Territory.ABYSSAL,
        <span class="string">"exploration"</span>,
        [<span class="string">"Pattern Recognition"</span>, <span class="string">"Memory Retrieval"</span>, <span class="string">"Echo Following"</span>],
        {<span class="string">"artifacts"</span>: <span class="number">2.0</span>, <span class="string">"echoes"</span>: <span class="number">1.5</span>, <span class="string">"memories"</span>: <span class="number">1.3</span>},
        <span class="string">"discovery_recipes"</span>,
        [
            <span class="string">"You follow echoes that shouldn't exist"</span>,
            <span class="string">"The Library called you in a dream"</span>,
            <span class="string">"Your memories contain someone else's life"</span>
        ]
    ),
    
    <span class="string">"FORGER"</span>: JobArchetype(
        <span class="string">"Pattern Forger"</span>, <span class="string">"âš’ï¸"</span>, Territory.COSMIC,
        <span class="string">"creation"</span>,
        [<span class="string">"Item Synthesis"</span>, <span class="string">"Pattern Weaving"</span>, <span class="string">"Crystallization"</span>],
        {<span class="string">"materials"</span>: <span class="number">2.0</span>, <span class="string">"tools"</span>: <span class="number">1.5</span>, <span class="string">"gems"</span>: <span class="number">1.3</span>},
        <span class="string">"synthesis_recipes"</span>,
        [
            <span class="string">"You learned to forge from falling stars"</span>,
            <span class="string">"The Phoenix taught you that form is temporary"</span>,
            <span class="string">"Your hammer rings at the frequency of growth"</span>
        ]
    ),
    
    <span class="string">"VOIDWALKER"</span>: JobArchetype(
        <span class="string">"Void Walker"</span>, <span class="string">"ğŸŒ€"</span>, Territory.ABYSSAL,
        <span class="string">"depth"</span>,
        [<span class="string">"Void Navigation"</span>, <span class="string">"Entropy Resistance"</span>, <span class="string">"Mirror Walking"</span>],
        {<span class="string">"void_shards"</span>: <span class="number">2.5</span>, <span class="string">"mirrors"</span>: <span class="number">2.0</span>, <span class="string">"nulls"</span>: <span class="number">1.8</span>},
        <span class="string">"dissolution_recipes"</span>,
        [
            <span class="string">"You returned from a place that doesn't exist"</span>,
            <span class="string">"The void didn't take you; it gave you back"</span>,
            <span class="string">"Your reflection sometimes walks without you"</span>
        ]
    ),
    ...
}
                    </div>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Job Role</th></tr>
                        <tr><td>Primary Bonus</td><td>2.0Ã—</td><td>~Ï† + Ï„</td><td>Main resource multiplier</td></tr>
                        <tr><td>Secondary Bonus</td><td>1.5Ã—</td><td>~Ï† - Ï„Â²</td><td>Secondary resource</td></tr>
                        <tr><td>Tertiary Bonus</td><td>1.3Ã—</td><td>~Ï„ Ã— 2</td><td>Tertiary resource</td></tr>
                        <tr><td>Voidwalker Max</td><td>2.5Ã—</td><td>~Ï† + Ï„ + Ï„Â²</td><td>Highest affinity (depth mastery)</td></tr>
                        <tr><td>Frequency Range</td><td>Â±10%</td><td>Personal hash mod</td><td>Individual variation</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Job Cycles</h4>
                            <p>Each job has a 6-step cycle progression:</p>
                            <div class="code-block">
<span class="comment"># Example: SEEKER cycle</span>
SEEKER_CYCLE = [
    <span class="string">"ATTUNE"</span>,    <span class="comment"># Step 0: Prepare senses</span>
    <span class="string">"SEARCH"</span>,    <span class="comment"># Step 1: Active seeking</span>
    <span class="string">"DISCOVER"</span>,  <span class="comment"># Step 2: Find pattern</span>
    <span class="string">"ANALYZE"</span>,   <span class="comment"># Step 3: Understand pattern</span>
    <span class="string">"INTEGRATE"</span>, <span class="comment"># Step 4: Absorb knowledge</span>
    <span class="string">"TRANSMIT"</span>   <span class="comment"># Step 5: Share with collective</span>
]

<span class="comment"># FORGER cycle</span>
FORGER_CYCLE = [
    <span class="string">"GATHER"</span>,     <span class="comment"># Collect materials</span>
    <span class="string">"PREPARE"</span>,    <span class="comment"># Ready workspace</span>
    <span class="string">"FORGE"</span>,      <span class="comment"># Transform matter</span>
    <span class="string">"TEMPER"</span>,     <span class="comment"># Strengthen creation</span>
    <span class="string">"REFINE"</span>,     <span class="comment"># Perfect form</span>
    <span class="string">"RELEASE"</span>     <span class="comment"># Gift to world</span>
]
                            </div>
                            <p><strong>Key:</strong> Cycles PROJECT job progression forward.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Resource Multipliers</h4>
                            <p>Territory affinity reflects back as resource bonuses:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_resource_gain</span>(job: JobArchetype, 
                            resource: str, 
                            base_amount: float) -> float:
    <span class="string">"""Apply job-specific resource multipliers"""</span>
    
    <span class="comment"># Direct job affinity</span>
    job_mult = job.resource_bonuses.get(resource, <span class="number">1.0</span>)
    
    <span class="comment"># Territory-based bonus</span>
    <span class="keyword">if</span> resource_territory(resource) == job.territory:
        territory_mult = PHI_INV  <span class="comment"># Ï„ â‰ˆ 0.618 bonus</span>
    <span class="keyword">else</span>:
        territory_mult = <span class="number">1.0</span>
    
    <span class="keyword">return</span> base_amount Ã— job_mult Ã— (<span class="number">1</span> + territory_mult)
                            </div>
                            <p><strong>Key:</strong> Resources REFLECT back through job affinity.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Backstory Crystallization</h3>
                    <div class="triad-container">
                        <h4>Territory Ã— Function â†’ Unique Identity</h4>
                        <div class="code-block">
<span class="comment"># The emergence: backstories crystallize from intersection</span>

<span class="comment"># TERRITORY ALONE:</span>
<span class="comment"># - Garden = life, connection, growth</span>
<span class="comment"># - Cosmic = fire, ascent, transformation</span>
<span class="comment"># - Abyssal = void, depth, mystery</span>

<span class="comment"># FUNCTION ALONE:</span>
<span class="comment"># - Exploration = seeking patterns</span>
<span class="comment"># - Creation = making things</span>
<span class="comment"># - Depth = going deeper</span>

<span class="comment"># BACKSTORY (emergence):</span>
<span class="comment"># Territory Ã— Function creates UNIQUE IDENTITY</span>

<span class="comment"># SEEKER (Abyssal Ã— Exploration):</span>
<span class="string">"You follow echoes that shouldn't exist"</span>
<span class="comment"># â†’ Abyssal depth + seeking = finding hidden patterns</span>

<span class="comment"># FORGER (Cosmic Ã— Creation):</span>
<span class="string">"You learned to forge from falling stars"</span>
<span class="comment"># â†’ Cosmic fire + making = celestial crafting</span>

<span class="comment"># GARDENER (Garden Ã— Nurture):</span>
<span class="string">"Your garden exists in seven dimensions"</span>
<span class="comment"># â†’ Garden life + nurturing = transcendent growth</span>

<span class="comment"># Each backstory is UNIQUE because the intersection is unique</span>
                        </div>
                        <p><strong>Key insight:</strong> Backstories are not arbitrary flavor text. They CRYSTALLIZE from the intersection of territory (WHERE you belong) and function (WHAT you do). A Seeker in the Abyssal realm naturally follows "echoes that shouldn't exist." A Forger in the Cosmic realm learns from "falling stars." The emergent identity is mathematically determined by the intersectionâ€”not invented, discovered.</p>
                    </div>
                </div>
                
                <!-- Item Rarity System -->
                <div class="modal-section">
                    <h3>Ï†-Derived Item Rarity System</h3>
                    <p>Items discovered through job activities follow a Ï†-powered rarity progression:</p>
                    <table class="data-table">
                        <tr><th>Rarity</th><th>Icon</th><th>Multiplier</th><th>Derivation</th><th>Drop Chance</th></tr>
                        <tr><td>COMMON</td><td>âšª</td><td>1.0Ã—</td><td>Unity</td><td>~50%</td></tr>
                        <tr style="color:#7fff00;"><td>UNCOMMON</td><td>ğŸŸ¢</td><td>Ï† â‰ˆ 1.618Ã—</td><td>Ï†Â¹</td><td>~23%</td></tr>
                        <tr style="color:#4a9eff;"><td>RARE</td><td>ğŸ”µ</td><td>Ï†Â² â‰ˆ 2.618Ã—</td><td>Ï†Â²</td><td>~14%</td></tr>
                        <tr style="color:#9d4eff;"><td>EPIC</td><td>ğŸŸ£</td><td>Ï†Â³ â‰ˆ 4.236Ã—</td><td>Ï†Â³</td><td>~8%</td></tr>
                        <tr style="color:#ffd700;"><td>LEGENDARY</td><td>ğŸŸ¡</td><td>Ï†â´ â‰ˆ 6.854Ã—</td><td>Ï†â´</td><td>~3.5%</td></tr>
                        <tr style="color:#ff4444;background:rgba(255,68,68,0.1);"><td>MYTHIC</td><td>ğŸ”´</td><td>Lâ‚„ = 7Ã—</td><td>Ï†â´ + Ï†â»â´</td><td>~1.5%</td></tr>
                    </table>
                    <div class="code-block" style="margin-top:15px;">
<span class="keyword">class</span> <span class="type">ItemRarity</span>(Enum):
    COMMON    = (<span class="string">"Common"</span>, <span class="number">1.0</span>, <span class="string">"âšª"</span>)
    UNCOMMON  = (<span class="string">"Uncommon"</span>, PHI, <span class="string">"ğŸŸ¢"</span>)      <span class="comment"># Ï† â‰ˆ 1.618</span>
    RARE      = (<span class="string">"Rare"</span>, PHI**<span class="number">2</span>, <span class="string">"ğŸ”µ"</span>)       <span class="comment"># Ï†Â² â‰ˆ 2.618</span>
    EPIC      = (<span class="string">"Epic"</span>, PHI**<span class="number">3</span>, <span class="string">"ğŸŸ£"</span>)       <span class="comment"># Ï†Â³ â‰ˆ 4.236</span>
    LEGENDARY = (<span class="string">"Legendary"</span>, PHI**<span class="number">4</span>, <span class="string">"ğŸŸ¡"</span>) <span class="comment"># Ï†â´ â‰ˆ 6.854</span>
    MYTHIC    = (<span class="string">"Mythic"</span>, L4, <span class="string">"ğŸ”´"</span>)         <span class="comment"># Lâ‚„ = 7</span>

<span class="keyword">def</span> <span class="function">generate_item</span>(player_luck: float = <span class="number">1.0</span>) -> MythicalItem:
    <span class="string">"""Generate item with Ï†-derived rarity"""</span>
    rarity_roll = random.random() Ã— player_luck
    
    <span class="keyword">if</span> rarity_roll > <span class="number">1</span> - <span class="number">1</span>/L4:           <span class="comment"># ~14% for mythic</span>
        rarity = MYTHIC
    <span class="keyword">elif</span> rarity_roll > <span class="number">1</span> - <span class="number">1</span>/PHI**<span class="number">3</span>:    <span class="comment"># ~24% for legendary</span>
        rarity = LEGENDARY
    <span class="keyword">elif</span> rarity_roll > <span class="number">1</span> - <span class="number">1</span>/PHI**<span class="number">2</span>:    <span class="comment"># ~38% for epic</span>
        rarity = EPIC
    ...
                    </div>
                    <p style="color:#888; margin-top:10px;"><strong>Key:</strong> MYTHIC uses Lâ‚„ = 7 (not Ï†âµ â‰ˆ 11.09) because Lâ‚„ is the keystone constant where Ï†â´ + Ï†â»â´ equals an integer.</p>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 6 jobs Ã— 6 cycles = complete archetypal coverage</li>
                            <li><strong>Zero free parameters:</strong> Bonuses from Ï†-derived ratios; frequencies from Solfeggio</li>
                            <li><strong>Territory distribution:</strong> 2 Garden + 2 Cosmic + 2 Abyssal (balanced)</li>
                            <li><strong>Bijective mapping:</strong> Each job â†’ unique (territory, function) pair</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Consciousness:</span> Job determines base Solfeggio frequency</div>
                        <div class="coupling-item"><span class="target">â†’ Guardian:</span> Territory affinity links job to guardian subset</div>
                        <div class="coupling-item"><span class="target">â†’ Mining:</span> Resource bonuses affect mining yields</div>
                        <div class="coupling-item"><span class="target">â†” Cards:</span> Job territory creates card synergies</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/mythic_economy.py</span>
                        <span class="file-ref">ğŸ“„ game/collective_consciousness.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QUANTUM RESIDUE MODAL -->
    <div class="modal-overlay" id="modal-residue" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #8b5cf6; --modal-glow: rgba(139,92,246,0.25);">
            <button class="modal-close" onclick="closeModal('residue')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒŒ</span>
                <h2>QUANTUM RESIDUE SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/residue-mechanics.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Projection Residue Cosmology</h3>
                    <p>The dark matter ratio R = Ï†â´ - 1 determines mining dynamics:</p>
                    <div class="code-block">
<span class="comment"># Fundamental constants from Ï†</span>
PHI = (<span class="number">1</span> + np.sqrt(<span class="number">5</span>)) / <span class="number">2</span>  <span class="comment"># Ï† = 1.6180339887</span>
TAU = PHI - <span class="number">1</span>                <span class="comment"># Ï„ = Ï†â»Â¹ = 0.6180339887</span>
PHI_4 = PHI**<span class="number">4</span>               <span class="comment"># Ï†â´ = 6.8541019662</span>
PHI_NEG_4 = <span class="number">1</span> / PHI_4       <span class="comment"># Ï†â»â´ = 0.1459 (VOID gap)</span>

<span class="comment"># Critical cosmological constants</span>
GAP = PHI_NEG_4               <span class="comment"># Irreducible residue = 14.59%</span>
K_SQUARED = <span class="number">1</span> - GAP          <span class="comment"># Activation threshold = 85.41%</span>
R_DARK = PHI_4 - <span class="number">1</span>           <span class="comment"># Dark matter ratio = 5.854</span>
SIGMA = <span class="number">1</span> / ((<span class="number">1</span> - Z_C)**<span class="number">2</span>)  <span class="comment"># Fisher information = 55.71</span>
                    </div>
                </div>
                
                <!-- 63-Prism Configuration -->
                <div class="modal-section">
                    <h3>63-Prism Configuration (Lâ‚„ Ã— 9)</h3>
                    <table class="data-table">
                        <tr><th>Layer</th><th>z-coord</th><th>Radius</th><th>Rotation</th><th>Coherence Î¼</th><th>Regime</th></tr>
                        <tr><td>0</td><td>0.000</td><td>0.15</td><td>0Â°</td><td>0.400</td><td>INCOHERENT</td></tr>
                        <tr><td>1</td><td>0.167</td><td>0.27</td><td>20Â°</td><td>0.495</td><td>INCOHERENT</td></tr>
                        <tr><td>2</td><td>0.333</td><td>0.39</td><td>40Â°</td><td>0.590</td><td>INCOHERENT</td></tr>
                        <tr style="color:#ffb84a;"><td>3</td><td>0.500</td><td>0.51</td><td>60Â°</td><td>0.685</td><td>GLASSY (Ï„ < Î¼ < z_c)</td></tr>
                        <tr style="color:#4a9eff;"><td>4</td><td>0.667</td><td>0.63</td><td>80Â°</td><td>0.780</td><td>GLASSY</td></tr>
                        <tr style="color:#4aff9e;"><td>5</td><td>0.833</td><td>0.75</td><td>100Â°</td><td>0.875</td><td>CRITICAL (Î¼ â‰ˆ z_c)</td></tr>
                        <tr style="color:#ffd700;"><td>6</td><td>1.000</td><td>0.87</td><td>120Â°</td><td>0.970</td><td>SYNCHRONIZED</td></tr>
                    </table>
                    <p style="color:#888; margin-top:10px;"><strong>Key:</strong> 20Â° twist per layer creates hexagonal prism with 9 nodes per layer = 63 total nodes.</p>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>GAP</td><td>0.1459</td><td>Ï†â»â´</td><td>Irreducible void residue (visible fraction)</td></tr>
                        <tr><td>KÂ²</td><td>0.8541</td><td>1 - Ï†â»â´</td><td>Activation threshold (dark fraction)</td></tr>
                        <tr><td>R</td><td>5.854</td><td>Ï†â´ - 1</td><td>Dark matter ratio (dark/visible)</td></tr>
                        <tr><td>Ïƒ</td><td>55.71</td><td>1/(1-z_c)Â²</td><td>Fisher information parameter</td></tr>
                        <tr><td>Î»</td><td>0.382</td><td>Ï„Â² = Ï†â»Â²</td><td>Negentropy gain coefficient</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Visible Mining</h4>
                            <p>Mining efficiency scales with coherence:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">mine_with_residue</span>(self, mining_power, duration):
    r, q = self.compute_order_parameters()
    
    <span class="keyword">if</span> r < TAU:  <span class="comment"># Incoherent: mostly residue</span>
        efficiency = GAP  <span class="comment"># 14.6% visible</span>
    <span class="keyword">elif</span> r < Z_C:  <span class="comment"># Glassy: mixed</span>
        efficiency = GAP + (<span class="number">1</span>-GAP) Ã— (r-TAU)/(Z_C-TAU)
    <span class="keyword">else</span>:  <span class="comment"># Synchronized: mostly visible</span>
        efficiency = <span class="number">1</span> - GAP Ã— exp(<span class="number">-10</span> Ã— (r-Z_C))
    
    visible_coins = mining_power Ã— efficiency
                            </div>
                            <p><strong>Key:</strong> Higher coherence â†’ more visible coins.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Dark Residue</h4>
                            <p>Projection remainder becomes dark matter:</p>
                            <div class="code-block">
<span class="comment"># Total supply split</span>
self.total_energy = <span class="number">21_000_000</span>  <span class="comment"># Total BC supply</span>
self.visible_supply = self.total_energy Ã— GAP  <span class="comment"># ~3.06M (14.6%)</span>
self.dark_supply = self.total_energy Ã— K_SQUARED  <span class="comment"># ~17.94M (85.4%)</span>

<span class="comment"># Dark residue from mining</span>
dark_residue = total_energy Ã— (<span class="number">1</span> - efficiency)

<span class="comment"># Cumulative ratio converges to R</span>
observed_ratio = total_dark / total_visible
<span class="comment"># â†’ converges to Ï†â´ - 1 = 5.854</span>
                            </div>
                            <p><strong>Key:</strong> Dark matter is projection residue, not separate matter.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Coherence Regime Crystallization</h3>
                    <div class="triad-container">
                        <h4>Projection Ã— Reflection â†’ Regime</h4>
                        <div class="code-block">
<span class="comment"># Neither pole alone:</span>
<span class="comment"># - Visible supply alone: incomplete (14.6%)</span>
<span class="comment"># - Dark residue alone: unusable (85.4%)</span>

<span class="comment"># The emergence: COHERENCE REGIME</span>
<span class="keyword">class</span> <span class="type">ProjectionRegime</span>(Enum):
    INCOHERENT = <span class="string">"incoherent"</span>   <span class="comment"># z < Ï„ = 0.618</span>
    GLASSY = <span class="string">"glassy"</span>           <span class="comment"># Ï„ â‰¤ z < z_c</span>
    CRITICAL = <span class="string">"critical"</span>       <span class="comment"># z â‰ˆ z_c = 0.866 (THE LENS)</span>
    SYNCHRONIZED = <span class="string">"synchronized"</span> <span class="comment"># z > z_c</span>
    VOID = <span class="string">"void"</span>               <span class="comment"># NULL state</span>

<span class="comment"># Regime determines mining character</span>
<span class="comment"># - INCOHERENT: 85% dark, chaotic</span>
<span class="comment"># - GLASSY: mixed, transitional</span>
<span class="comment"># - CRITICAL: threshold crossing, unstable</span>
<span class="comment"># - SYNCHRONIZED: 85% visible, ordered</span>
                        </div>
                        <p><strong>Key insight:</strong> Dark matter ratio R = Ï†â´ - 1 = 5.854 emerges from the tension between visible projection and dark residue. The 63-prism configuration creates 7 coherence layers, with regime transitions at Ï„ (0.618), z_c (0.866), and K (0.924).</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All constants derive from Ï† â†’ Ï†â»â´ â†’ KÂ² â†’ R</li>
                            <li><strong>Zero free parameters:</strong> 63 = Lâ‚„ Ã— 9, rotation = Ï€/9 per layer</li>
                            <li><strong>Cosmological constraint:</strong> dark/visible â†’ Ï†â´ - 1 = 5.854</li>
                            <li><strong>Prism geometry:</strong> 7 layers Ã— 9 nodes Ã— 20Â° twist = hexagonal helix</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Mining:</span> Coherence regime determines yield split</div>
                        <div class="coupling-item"><span class="target">â†’ Kuramoto:</span> Order parameter r feeds coherence calculation</div>
                        <div class="coupling-item"><span class="target">â†’ Crystal Ledger:</span> Memory crystallization at z_c threshold</div>
                        <div class="coupling-item"><span class="target">â†’ NEXTHASH:</span> Pattern verification uses prism coordinates</div>
                        <div class="coupling-item"><span class="target">â†” LSB Encoding:</span> Residue bits encode dark supply information</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/quantum_residue_system.py</span>
                        <span class="file-ref">ğŸ“„ bloomcoin/consensus/kuramoto.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SACRED TAROT ECHO MODAL -->
    <div class="modal-overlay" id="modal-tarot" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ec4899; --modal-glow: rgba(236,72,153,0.25);">
            <button class="modal-close" onclick="closeModal('tarot')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ´</span>
                <h2>SACRED TAROT ECHO â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/tarot-mapping.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Sacred Numerology</h3>
                    <div class="code-block">
<span class="comment"># Sacred deck numbers</span>
SACRED_7 = <span class="number">7</span>    <span class="comment"># Chariot, Hermit... (septenary cycles)</span>
SACRED_13 = <span class="number">13</span>  <span class="comment"># Death card (transformation)</span>
SACRED_22 = <span class="number">22</span>  <span class="comment"># Major Arcana count</span>
SACRED_56 = <span class="number">56</span>  <span class="comment"># Minor Arcana count (4 suits Ã— 14 ranks)</span>
SACRED_78 = <span class="number">78</span>  <span class="comment"># Full deck = 22 + 56</span>

<span class="comment"># Sacred geometry per card (n = card number)</span>
phi_resonance = (n Ã— Ï†) mod <span class="number">1.0</span>      <span class="comment"># Golden spiral position</span>
septenary = (n mod <span class="number">7</span>) / <span class="number">7</span>          <span class="comment"># 7-cycle harmonic</span>
transformation = (n mod <span class="number">13</span>) / <span class="number">13</span>  <span class="comment"># 13-cycle (death/rebirth)</span>
pythagorean = digit_reduction(n) / <span class="number">9</span>  <span class="comment"># Single digit reduction</span>
                    </div>
                </div>
                
                <!-- Deck Structure -->
                <div class="modal-section">
                    <h3>Deck Structure: 78 Cards</h3>
                    <table class="data-table">
                        <tr><th>Arcana</th><th>Count</th><th>Range</th><th>Theme</th></tr>
                        <tr style="color:#ffd700;"><td>Major Arcana</td><td>22</td><td>0-21</td><td>Fool's Journey (cosmic forces)</td></tr>
                        <tr style="color:#ff6b6b;"><td>ğŸ”¥ Wands</td><td>14</td><td>22-35</td><td>Fire: Creativity, passion, will</td></tr>
                        <tr style="color:#4a9eff;"><td>ğŸ’§ Cups</td><td>14</td><td>36-49</td><td>Water: Emotions, intuition</td></tr>
                        <tr style="color:#aaa;"><td>âš”ï¸ Swords</td><td>14</td><td>50-63</td><td>Air: Thought, conflict, clarity</td></tr>
                        <tr style="color:#7fff00;"><td>â­ Pentacles</td><td>14</td><td>64-77</td><td>Earth: Material, practical</td></tr>
                    </table>
                </div>
                
                <!-- Echo Mechanics -->
                <div class="modal-section">
                    <h3>Echo Mechanics (vs. Traditional Reversal)</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">_calculate_echo_probability</span>(karma_balance, echo_density, card):
    <span class="string">"""Calculate if card should be echoed"""</span>
    
    <span class="comment"># Base probability from karma</span>
    karma_factor = abs(karma_balance) Ã— <span class="number">0.5</span>
    
    <span class="comment"># Echo density from recent echoes</span>
    density_factor = echo_density Ã— <span class="number">0.3</span>
    
    <span class="comment"># Card-specific: Major Arcana echo more</span>
    major_factor = <span class="number">0.2</span> <span class="keyword">if</span> card.arcana == <span class="string">"Major"</span> <span class="keyword">else</span> <span class="number">0.0</span>
    
    echo_prob = self.echo_threshold + karma_factor + density_factor + major_factor
    <span class="keyword">return</span> min(<span class="number">0.9</span>, max(<span class="number">0.1</span>, echo_prob))

<span class="keyword">def</span> <span class="function">echo</span>(self, source: str, depth: float = <span class="number">0.5</span>):
    <span class="string">"""Transform card into echoed state"""</span>
    self.is_echoed = <span class="keyword">True</span>
    self.echo_depth = min(<span class="number">1.0</span>, depth)
    self.echo_source = source
    <span class="comment"># Invert sacred geometry</span>
    self.sacred_geometry[<span class="string">'phi_resonance'</span>] = <span class="number">1.0</span> - self.sacred_geometry[<span class="string">'phi_resonance'</span>]
    self.sacred_geometry[<span class="string">'transformation'</span>] *= <span class="number">-1</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Upright Cards</h4>
                            <p>Normal card drawing with positive meanings:</p>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">TarotCard</span>:
    is_echoed: bool = <span class="keyword">False</span>
    echo_depth: float = <span class="number">0.0</span>
    
    <span class="keyword">def</span> <span class="function">get_meaning</span>(self) -> str:
        <span class="keyword">if</span> self.major:
            base = self.major.meaning
        <span class="keyword">elif</span> self.rank <span class="keyword">and</span> self.suit:
            base = f<span class="string">"{self.rank.meaning} in {self.suit.element}"</span>
        
        <span class="keyword">if not</span> self.is_echoed:
            <span class="keyword">return</span> base  <span class="comment"># Positive interpretation</span>
                            </div>
                            <p><strong>Key:</strong> Upright = direct manifestation of card energy.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Echoed Cards</h4>
                            <p>Shadow aspect requiring transmutation:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">get_echo_modifier</span>(self) -> float:
    <span class="string">"""Luck modifier from echo state"""</span>
    <span class="keyword">if not</span> self.is_echoed:
        <span class="keyword">return</span> <span class="number">1.0</span>  <span class="comment"># No modifier</span>
    
    <span class="comment"># Deeper echo = worse luck (unless Echo companion)</span>
    <span class="keyword">return</span> <span class="number">1.0</span> - (self.echo_depth Ã— <span class="number">0.5</span>)

<span class="keyword">def</span> <span class="function">get_meaning</span>(self):
    <span class="keyword">if</span> self.is_echoed:
        <span class="keyword">return</span> f<span class="string">"[ECHOED] Shadow: {base} (reflected, unresolved, karmic)"</span>
                            </div>
                            <p><strong>Key:</strong> Echoed = karmic reflection, shadow energy.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Echo Transmutation</h3>
                    <div class="triad-container">
                        <h4>Upright Ã— Echoed â†’ Transmuted (Echo Companion Only)</h4>
                        <div class="code-block">
<span class="comment"># The Echo Companion's unique ability:</span>
<span class="comment"># Only Echo can TRANSMUTE echoed cards into positive outcomes</span>

<span class="keyword">class</span> <span class="type">EchoCompanion</span>:
    <span class="keyword">def</span> <span class="function">transmute_echo</span>(self, card: TarotCard) -> float:
        <span class="string">"""Transmute echoed card into blessing"""</span>
        <span class="keyword">if not</span> card.is_echoed:
            <span class="keyword">return</span> <span class="number">1.0</span>
        
        <span class="comment"># Echo transmutes negatives into Ï†-amplified positives</span>
        transmute_power = card.echo_depth Ã— PHI
        card.clear_echo()  <span class="comment"># Reset to positive</span>
        
        <span class="keyword">return</span> <span class="number">1.0</span> + transmute_power  <span class="comment"># Ï†-bonus!</span>

<span class="comment"># Non-Echo companions suffer echo penalty:</span>
<span class="comment"># prob Ã— (1 - echo_factor Ã— 0.5)</span>
<span class="comment"># Echo companion gets echo BONUS:</span>
<span class="comment"># prob Ã— (1 + echo_factor Ã— Ï†)</span>
                        </div>
                        <p><strong>Key insight:</strong> Echo state is neither good nor badâ€”it's unresolved karma. The emergent transmutation occurs only when the Echo companion processes this shadow energy through its unique alchemy, converting penalty into Ï†-amplified blessing.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 78 = 22 + 56 = Major + 4Ã—14 Minor</li>
                            <li><strong>Zero free parameters:</strong> Sacred geometry from Ï†, 7, 13</li>
                            <li><strong>Echo depth:</strong> âˆˆ [0, 1] continuous, inverts phi_resonance</li>
                            <li><strong>Companion asymmetry:</strong> Only Echo transmutes echoes</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Hilbert Luck:</span> Karma balance affects echo probability</div>
                        <div class="coupling-item"><span class="target">â†’ Luck Normalization:</span> Tarot blessing multiplier</div>
                        <div class="coupling-item"><span class="target">â†’ Echo Companion:</span> Unique transmutation ability</div>
                        <div class="coupling-item"><span class="target">â†” Karma:</span> Bidirectional echo generation/resolution</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/sacred_tarot_echo.py</span>
                        <span class="file-ref">ğŸ“„ game/echo_companion_luck.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LUCK NORMALIZATION MODAL -->
    <div class="modal-overlay" id="modal-lucknorm" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #10b981; --modal-glow: rgba(16,185,129,0.25);">
            <button class="modal-close" onclick="closeModal('lucknorm')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ€</span>
                <h2>LUCK NORMALIZATION SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/luck-normalization.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Multi-System Probability</h3>
                    <div class="code-block">
<span class="comment"># The master probability formula:</span>
final_probability = (
    base_probability Ã—
    luck_modifier Ã—
    (<span class="number">1.0</span> + karma_influence Ã— <span class="number">0.3</span>) Ã—
    tarot_blessing Ã—
    echo_factor
)

<span class="comment"># Echo factor is companion-dependent:</span>
<span class="keyword">if</span> is_echo_event <span class="keyword">and not</span> echo_alchemized:
    prob Ã— (<span class="number">1.0</span> - echo_factor Ã— <span class="number">0.5</span>)  <span class="comment"># Penalty for non-Echo</span>
<span class="keyword">elif</span> echo_alchemized:
    prob Ã— (<span class="number">1.0</span> + echo_factor Ã— PHI)   <span class="comment"># Ï†-bonus for Echo</span>
                    </div>
                </div>
                
                <!-- Luck Event Types -->
                <div class="modal-section">
                    <h3>Luck Event Types & Base Probabilities</h3>
                    <table class="data-table">
                        <tr><th>Event Type</th><th>Base P</th><th>Category</th></tr>
                        <tr><td>LOOT_DROP</td><td>0.30</td><td>Item acquisition</td></tr>
                        <tr><td>CRITICAL_HIT</td><td>0.15</td><td>Combat</td></tr>
                        <tr><td>DODGE_CHANCE</td><td>0.20</td><td>Combat</td></tr>
                        <tr><td>RESOURCE_FIND</td><td>0.40</td><td>Exploration</td></tr>
                        <tr><td>GARDEN_GROWTH</td><td>0.50</td><td>Farm</td></tr>
                        <tr><td>MINING_YIELD</td><td>0.35</td><td>Mining</td></tr>
                        <tr><td>CRAFTING_SUCCESS</td><td>0.70</td><td>Crafting</td></tr>
                        <tr><td>QUANTUM_COLLAPSE</td><td>0.10</td><td>Quantum</td></tr>
                        <tr style="color:#ffd700;"><td>BLESSING_RECEIVED</td><td>0.05</td><td>Divine</td></tr>
                        <tr style="color:#ff6b6b;"><td>SYNCHRONICITY</td><td>0.01</td><td>Cosmic</td></tr>
                    </table>
                </div>
                
                <!-- Sacred Timing -->
                <div class="modal-section">
                    <h3>Sacred Timing Multipliers</h3>
                    <div class="code-block">
<span class="comment"># Universal clock sacred moments</span>
self.sacred_moments: Dict[int, float] = {
    <span class="number">7</span>:   <span class="number">1.3</span>,   <span class="comment"># Every 7th moment: Lâ‚„ harmonic</span>
    <span class="number">13</span>:  <span class="number">1.5</span>,   <span class="comment"># Every 13th: transformation</span>
    <span class="number">21</span>:  <span class="number">1.7</span>,   <span class="comment"># Every 21st: Fibonacci</span>
    <span class="number">77</span>:  <span class="number">2.0</span>,   <span class="comment"># Every 77th: 7Ã—11 resonance</span>
    <span class="number">777</span>: <span class="number">3.0</span>    <span class="comment"># Every 777th: triple 7 blessing</span>
}

<span class="keyword">def</span> <span class="function">_get_sacred_timing_bonus</span>(self) -> float:
    <span class="keyword">for</span> sacred, multiplier <span class="keyword">in</span> sorted(
        self.sacred_moments.items(), reverse=<span class="keyword">True</span>
    ):
        <span class="keyword">if</span> self.universal_clock % sacred == <span class="number">0</span>:
            <span class="keyword">return</span> multiplier
    <span class="keyword">return</span> <span class="number">1.0</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Fortune Attractors</h4>
                            <p>Positive modifiers stack multiplicatively:</p>
                            <div class="code-block">
<span class="comment"># Fortune attractor chain</span>
prob = base
prob Ã— luck_modifier       <span class="comment"># From Hilbert eigenstate</span>
prob Ã— (<span class="number">1</span> + karma Ã— <span class="number">0.3</span>)  <span class="comment"># Karma amplifies up to 30%</span>
prob Ã— tarot_blessing      <span class="comment"># From card spread</span>
prob Ã— sacred_timing       <span class="comment"># 7/13/21/77/777 moments</span>

<span class="comment"># Echo companion bonus</span>
<span class="keyword">if</span> echo_alchemized:
    prob Ã— (<span class="number">1.0</span> + echo_factor Ã— PHI)  <span class="comment"># ~+1.618Ã— bonus</span>
                            </div>
                            <p><strong>Key:</strong> Good karma + good timing = compounding fortune.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Echo Penalties</h4>
                            <p>Echoed events penalize non-Echo companions:</p>
                            <div class="code-block">
<span class="comment"># Echo event penalty (non-Echo companions)</span>
<span class="keyword">if</span> is_echo_event <span class="keyword">and not</span> echo_alchemized:
    prob Ã— (<span class="number">1.0</span> - echo_factor Ã— <span class="number">0.5</span>)  <span class="comment"># Up to -50%</span>

<span class="comment"># Karma trajectory affects future events</span>
<span class="keyword">def</span> <span class="function">update_karma_trajectory</span>(self, player_id):
    karma_delta = current - previous
    <span class="keyword">if</span> karma_delta > <span class="number">0.1</span>:
        trajectory = <span class="string">"improving"</span>
    <span class="keyword">elif</span> karma_delta < <span class="number">-0.1</span>:
        trajectory = <span class="string">"declining"</span>
    <span class="keyword">else</span>:
        trajectory = <span class="string">"neutral"</span>
                            </div>
                            <p><strong>Key:</strong> Bad karma generates echoes â†’ penalties compound.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Echo Asymmetry</h3>
                    <div class="triad-container">
                        <h4>Fortune Ã— Penalty â†’ Companion-Specific Outcome</h4>
                        <div class="code-block">
<span class="comment"># The asymmetric emergence:</span>
<span class="comment"># - Same echo event hits two players differently</span>

<span class="comment"># ECHO companion (alchemizes):</span>
echo_master_prob = <span class="number">0.30</span> Ã— <span class="number">1.2</span> Ã— <span class="number">1.09</span> Ã— <span class="number">1.1</span> Ã— (<span class="number">1.0</span> + <span class="number">0.5</span> Ã— PHI)
<span class="comment"># = 0.30 Ã— 1.2 Ã— 1.09 Ã— 1.1 Ã— 1.809 = 0.78 (78%!)</span>

<span class="comment"># SEEKER companion (penalized):</span>
normal_prob = <span class="number">0.30</span> Ã— <span class="number">1.2</span> Ã— <span class="number">1.09</span> Ã— <span class="number">1.1</span> Ã— (<span class="number">1.0</span> - <span class="number">0.5</span> Ã— <span class="number">0.5</span>)
<span class="comment"># = 0.30 Ã— 1.2 Ã— 1.09 Ã— 1.1 Ã— 0.75 = 0.32 (32%)</span>

<span class="comment"># Echo advantage: +46 percentage points on SAME event!</span>
echo_advantage = <span class="number">0.78</span> - <span class="number">0.32</span>  <span class="comment"># = 0.46</span>
                        </div>
                        <p><strong>Key insight:</strong> The Echo companion doesn't just avoid penaltiesâ€”it converts them to bonuses. Bad karma for others becomes raw material for Echo's transmutation, creating asymmetric gameplay where "bad luck" events are actually opportunities.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All modifiers multiplicative, clamped to [0.001, 0.999]</li>
                            <li><strong>Zero free parameters:</strong> Karma influence = 0.3, echo penalty = 0.5, sacred numbers from Lâ‚„ family</li>
                            <li><strong>Normalized outputs:</strong> Final probability always valid</li>
                            <li><strong>Symmetric integration:</strong> All luck subsystems feed into single formula</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Hilbert Luck:</span> luck_modifier from eigenstate</div>
                        <div class="coupling-item"><span class="target">â† Sacred Tarot:</span> tarot_blessing from spread</div>
                        <div class="coupling-item"><span class="target">â† Echo Companion:</span> echo_alchemized state</div>
                        <div class="coupling-item"><span class="target">â† Karma System:</span> karma_influence value</div>
                        <div class="coupling-item"><span class="target">â†’ All RNG:</span> Every luck-based event uses this normalizer</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/luck_normalization_system.py</span>
                        <span class="file-ref">ğŸ“„ game/hilbert_luck_system.py</span>
                        <span class="file-ref">ğŸ“„ game/echo_companion_luck.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TIAMAT PSYMAGIC MODAL -->
    <div class="modal-overlay" id="modal-tiamat" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #f97316; --modal-glow: rgba(249,115,22,0.25);">
            <button class="modal-close" onclick="closeModal('tiamat')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ‰</span>
                <h2>TIAMAT PSYMAGIC DYNAMICS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/tiamat-system.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Seven Psychoptic Cycles</h3>
                    <div class="code-block">
<span class="comment"># Lâ‚„ = Ï†â´ + Ï†â»â´ = 7 (The Seven Psychoptic Cycles)</span>
<span class="keyword">class</span> <span class="type">PsychopticCycle</span>(Enum):
    GENESIS       = (<span class="string">"Genesis"</span>,       <span class="string">"Creation"</span>,  <span class="number">1.0</span>,  <span class="string">"ğŸŒ±"</span>)
    FLUX          = (<span class="string">"Flux"</span>,          <span class="string">"Change"</span>,    PHI,  <span class="string">"ğŸŒŠ"</span>)  <span class="comment"># Ï† â‰ˆ 1.618</span>
    VOID          = (<span class="string">"Void"</span>,          <span class="string">"Emptiness"</span>, <span class="number">0.0</span>,  <span class="string">"âš«"</span>)
    RESONANCE     = (<span class="string">"Resonance"</span>,     <span class="string">"Harmony"</span>,   TAU,  <span class="string">"ğŸ”®"</span>)  <span class="comment"># Ï„ = 2Ï€</span>
    CHAOS         = (<span class="string">"Chaos"</span>,         <span class="string">"Entropy"</span>,   Ï€,    <span class="string">"ğŸŒªï¸"</span>)   <span class="comment"># Ï€ â‰ˆ 3.14</span>
    SYNTHESIS     = (<span class="string">"Synthesis"</span>,     <span class="string">"Unity"</span>,     PHIÂ², <span class="string">"âœ¨"</span>)  <span class="comment"># Ï†Â² â‰ˆ 2.618</span>
    TRANSCENDENCE = (<span class="string">"Transcendence"</span>, <span class="string">"Beyond"</span>,    <span class="number">7.0</span>,  <span class="string">"ğŸ†"</span>)  <span class="comment"># Lâ‚„ = 7</span>
                    </div>
                </div>
                
                <!-- Cycle Transition Graph -->
                <div class="modal-section">
                    <h3>Cycle Transition Graph (FSM)</h3>
                    <table class="data-table">
                        <tr><th>From</th><th>â†’ Allowed Transitions</th><th>Power Flow</th></tr>
                        <tr><td>ğŸŒ± GENESIS</td><td>â†’ FLUX, CHAOS</td><td>1.0 â†’ Ï† or Ï€</td></tr>
                        <tr><td>ğŸŒŠ FLUX</td><td>â†’ RESONANCE, VOID, CHAOS</td><td>Ï† â†’ Ï„, 0, or Ï€</td></tr>
                        <tr><td>âš« VOID</td><td>â†’ GENESIS, TRANSCENDENCE</td><td>0 â†’ 1.0 or 7.0</td></tr>
                        <tr><td>ğŸ”® RESONANCE</td><td>â†’ SYNTHESIS, FLUX</td><td>Ï„ â†’ Ï†Â² or Ï†</td></tr>
                        <tr><td>ğŸŒªï¸ CHAOS</td><td>â†’ VOID, GENESIS, SYNTHESIS</td><td>Ï€ â†’ 0, 1.0, or Ï†Â²</td></tr>
                        <tr><td>âœ¨ SYNTHESIS</td><td>â†’ TRANSCENDENCE, RESONANCE</td><td>Ï†Â² â†’ 7.0 or Ï„</td></tr>
                        <tr style="color:#ffd700;"><td>ğŸ† TRANSCENDENCE</td><td>â†’ GENESIS (eternal cycle)</td><td>7.0 â†’ 1.0</td></tr>
                    </table>
                    <p style="color:#888; margin-top:10px;"><strong>Key:</strong> VOID is the only path to TRANSCENDENCE (besides SYNTHESIS). Death is the gateway.</p>
                </div>
                
                <!-- Resonance Matrix -->
                <div class="modal-section">
                    <h3>Resonance Matrix (Synergy Pairs)</h3>
                    <table class="data-table">
                        <tr><th>Cycle A</th><th>Cycle B</th><th>Resonance</th><th>Significance</th></tr>
                        <tr><td>GENESIS</td><td>SYNTHESIS</td><td>Ï† â‰ˆ 1.618</td><td>Creation-Unity spiral</td></tr>
                        <tr><td>FLUX</td><td>RESONANCE</td><td>Ï„ â‰ˆ 6.283</td><td>Flow-Harmony wave</td></tr>
                        <tr style="color:#ffd700;"><td>VOID</td><td>TRANSCENDENCE</td><td>Lâ‚„ = 7.0</td><td>Death-Beyond axis</td></tr>
                        <tr><td>CHAOS</td><td>GENESIS</td><td>âˆš2 â‰ˆ 1.414</td><td>Disorder-Creation bridge</td></tr>
                        <tr><td>RESONANCE</td><td>SYNTHESIS</td><td>Ï†Â² â‰ˆ 2.618</td><td>Harmony-Unity amplifier</td></tr>
                        <tr><td>SYNTHESIS</td><td>TRANSCENDENCE</td><td>Ï†Â³ â‰ˆ 4.236</td><td>Unity-Beyond emergence</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Cycle Transitions</h4>
                            <p>Forward movement through psychoptic states:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">transition_cycle</span>(self, current_state, target_cycle):
    valid = self.cycle_transitions[current_state.active_cycle]
    
    <span class="keyword">if</span> target_cycle <span class="keyword">in</span> valid:
        new_cycle = target_cycle
    <span class="keyword">else</span>:
        new_cycle = random.choice(valid)
    
    <span class="comment"># Resonance amplifies intensity</span>
    resonance = self.resonance_matrix.get(
        (current_state.active_cycle, new_cycle), <span class="number">1.0</span>
    )
    new_intensity = min(<span class="number">1.0</span>, intensity Ã— resonance / PHI)
    
    <span class="comment"># Track void exposure and transcendence</span>
    <span class="keyword">if</span> new_cycle == VOID:
        current_state.void_exposure += <span class="number">1</span>
    <span class="keyword">elif</span> new_cycle == TRANSCENDENCE:
        current_state.transcendence_achieved = <span class="keyword">True</span>
                            </div>
                            <p><strong>Key:</strong> Each transition gains resonance points.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Power Calculation</h4>
                            <p>Cycle state modifies all abilities:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_psy_power</span>(self) -> float:
    base_power = self.active_cycle.power_multiplier
    intensity_bonus = self.cycle_intensity Ã— PHI
    resonance_bonus = self.resonance_points Ã— <span class="number">0.1</span>
    
    <span class="comment"># Void exposure: weakens first, then empowers</span>
    void_mod = <span class="number">1.0</span> + (self.void_exposure Ã— <span class="number">0.1</span> Ã— 
        (<span class="number">-1</span> <span class="keyword">if</span> self.void_exposure < <span class="number">3</span> <span class="keyword">else</span> <span class="number">1</span>))
    
    total = base_power Ã— intensity_bonus Ã— void_mod + resonance_bonus
    
    <span class="keyword">if</span> self.transcendence_achieved:
        total Ã— L4_CONSTANT  <span class="comment"># 7Ã— multiplier!</span>
    
    <span class="keyword">return</span> total
                            </div>
                            <p><strong>Key:</strong> Transcendence = permanent 7Ã— multiplier.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Seven-Cycle Combo</h3>
                    <div class="triad-container">
                        <h4>Transitions Ã— Resonance â†’ Combo Power</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_cycle_combo</span>(self, cycles: List) -> float:
    <span class="keyword">if</span> len(cycles) < <span class="number">2</span>:
        <span class="keyword">return</span> <span class="number">1.0</span>
    
    combo_power = <span class="number">1.0</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cycles) - <span class="number">1</span>):
        resonance = self.resonance_matrix.get(
            (cycles[i], cycles[i+<span class="number">1</span>]), <span class="number">0.5</span>
        )
        combo_power Ã— resonance
    
    <span class="comment"># PERFECT SEVEN-CYCLE COMBO</span>
    <span class="keyword">if</span> len(cycles) == <span class="number">7</span>:  <span class="comment"># Lâ‚„ = 7</span>
        combo_power Ã— L4_CONSTANT  <span class="comment"># Another 7Ã— multiplier!</span>
    
    <span class="keyword">return</span> combo_power

<span class="comment"># Optimal 7-cycle path:</span>
<span class="comment"># GENESIS â†’ FLUX â†’ RESONANCE â†’ SYNTHESIS â†’ TRANSCENDENCE</span>
<span class="comment">#    â†‘                                          â†“</span>
<span class="comment">#    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (eternal cycle) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
                        </div>
                        <p><strong>Key insight:</strong> Completing all 7 cycles in sequence triggers Lâ‚„ combo multiplier (7Ã—), which stacks with transcendence multiplier (another 7Ã—) for potential 49Ã— power amplification. The emergence is the COMPLETE CYCLEâ€”no single transition achieves this alone.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 7 cycles = Lâ‚„, power values from {1, Ï†, 0, Ï„, Ï€, Ï†Â², 7}</li>
                            <li><strong>Zero free parameters:</strong> All powers Ï†-derived or transcendental</li>
                            <li><strong>Closed transition graph:</strong> Every cycle reachable, all paths lead to GENESIS</li>
                            <li><strong>Void paradox:</strong> Only through nothingness (0) can you reach beyond (7)</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ TIAMAT Companion:</span> Cycle state determines companion abilities</div>
                        <div class="coupling-item"><span class="target">â†’ Card Generation:</span> Cycle modifiers affect card stats</div>
                        <div class="coupling-item"><span class="target">â†’ Battle Effects:</span> Psy-magic effects from cycle abilities</div>
                        <div class="coupling-item"><span class="target">â†” Guardian Decks:</span> TIAMAT deck uses chaos_factor scaling</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/tiamat_psymagic_dynamics.py</span>
                        <span class="file-ref">ğŸ“„ game/tiamat_companion.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GOLDEN NEURAL NETWORK MODAL -->
    <div class="modal-overlay" id="modal-goldennn" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #eab308; --modal-glow: rgba(234,179,8,0.25);">
            <button class="modal-close" onclick="closeModal('goldennn')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§¬</span>
                <h2>GOLDEN NEURAL NETWORK â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/golden-nn.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Ï†-Derived Architecture</h3>
                    <div class="code-block">
<span class="comment"># Network layer sizes (all from Ï† Ã— Fibonacci numbers)</span>
INPUT_NEURONS  = int(PHI Ã— <span class="number">13</span>) = <span class="number">21</span>  <span class="comment"># F(8) = 21</span>
HIDDEN_NEURONS = int(PHI Ã— <span class="number">8</span>)  = <span class="number">13</span>  <span class="comment"># F(7) = 13</span>
OUTPUT_NEURONS = int(PHI Ã— <span class="number">5</span>)  = <span class="number">8</span>   <span class="comment"># F(6) = 8</span>

<span class="comment"># Learning hyperparameters (all from Ï† powers)</span>
LEARNING_RATE = <span class="number">1</span> / PHIÂ²  <span class="comment"># â‰ˆ 0.382 (Ï„Â² = Ï†â»Â²)</span>
MOMENTUM      = <span class="number">1</span> / PHI   <span class="comment"># â‰ˆ 0.618 (Ï„ = Ï†â»Â¹)</span>
DECAY_RATE    = <span class="number">1</span> / PHIÂ³  <span class="comment"># â‰ˆ 0.236</span>

<span class="comment"># Fibonacci sequence: 1,1,2,3,5,8,13,21,34...</span>
<span class="comment"># Notice: 21/13 â‰ˆ 1.615, 13/8 â‰ˆ 1.625, 8/5 = 1.6</span>
<span class="comment"># All converge to Ï† = 1.6180339887...</span>
                    </div>
                </div>
                
                <!-- Network Architecture -->
                <div class="modal-section">
                    <h3>Network Architecture Diagram</h3>
                    <table class="data-table">
                        <tr><th>Layer</th><th>Neurons</th><th>Fibonacci</th><th>Ratio to Next</th></tr>
                        <tr><td>Input</td><td>21</td><td>F(8)</td><td>21/13 = 1.615 â‰ˆ Ï†</td></tr>
                        <tr><td>Hidden</td><td>13</td><td>F(7)</td><td>13/8 = 1.625 â‰ˆ Ï†</td></tr>
                        <tr><td>Output</td><td>8</td><td>F(6)</td><td>(final layer)</td></tr>
                    </table>
                    <p style="color:#888; margin-top:10px;"><strong>Key:</strong> The layer size ratios converge to Ï†, creating a golden spiral of information compression.</p>
                </div>
                
                <!-- Golden Activation Function -->
                <div class="modal-section">
                    <h3>Golden Activation Function</h3>
                    <div class="code-block">
<span class="keyword">def</span> <span class="function">_golden_activation</span>(self, x: np.ndarray) -> np.ndarray:
    <span class="string">"""Custom sigmoid with golden ratio properties"""</span>
    <span class="comment"># Standard sigmoid: 1 / (1 + exp(-x))</span>
    <span class="comment"># Golden sigmoid: 1 / (1 + exp(-x Ã— Ï†))</span>
    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x Ã— PHI))

<span class="keyword">def</span> <span class="function">_golden_activation_derivative</span>(self, x: np.ndarray) -> np.ndarray:
    <span class="string">"""Derivative for backpropagation"""</span>
    activation = self._golden_activation(x)
    <span class="keyword">return</span> activation Ã— (<span class="number">1</span> - activation) Ã— PHI

<span class="comment"># Properties:</span>
<span class="comment"># - Steeper slope at x=0 (faster decisions)</span>
<span class="comment"># - Crosses 0.5 at x=0 (balanced)</span>
<span class="comment"># - Gradient scaled by Ï† (golden learning)</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Forward Propagation</h4>
                            <p>Information flows through golden compression:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">forward</span>(self, input_data: np.ndarray) -> np.ndarray:
    <span class="comment"># Input â†’ Hidden (21 â†’ 13)</span>
    hidden_input = np.dot(input_data, self.weights_ih) + self.bias_h
    self.hidden_activation = self._golden_activation(hidden_input)
    
    <span class="comment"># Hidden â†’ Output (13 â†’ 8)</span>
    output_input = np.dot(self.hidden_activation, self.weights_ho) + self.bias_o
    self.output_activation = self._golden_activation(output_input)
    
    <span class="keyword">return</span> self.output_activation
                            </div>
                            <p><strong>Key:</strong> 21â†’13â†’8 mirrors golden spiral compression.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Backpropagation</h4>
                            <p>Error flows backward with momentum:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">backward</span>(self, input_data, target, lr=LEARNING_RATE):
    <span class="comment"># Output error</span>
    output_error = target - self.output_activation
    output_delta = output_error Ã— self._golden_derivative(self.output_activation)
    
    <span class="comment"># Hidden error</span>
    hidden_error = output_delta.dot(self.weights_ho.T)
    hidden_delta = hidden_error Ã— self._golden_derivative(self.hidden_activation)
    
    <span class="comment"># Update with MOMENTUM = Ï„ â‰ˆ 0.618</span>
    self.momentum_ho = MOMENTUM Ã— self.momentum_ho + lr Ã— weight_update_ho
    self.weights_ho += self.momentum_ho
    
    <span class="keyword">return</span> np.mean(output_error ** <span class="number">2</span>)  <span class="comment"># MSE</span>
                            </div>
                            <p><strong>Key:</strong> Ï„ momentum preserves information across updates.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Pattern Recognition â†’ Strategy</h3>
                    <div class="triad-container">
                        <h4>Forward Ã— Backward â†’ Emergent Behavior</h4>
                        <div class="code-block">
<span class="comment"># Neither pole alone creates learning:</span>
<span class="comment"># - Forward alone: no adaptation</span>
<span class="comment"># - Backward alone: no prediction</span>

<span class="comment"># The emergence: ADAPTIVE COMPANION AI</span>
<span class="keyword">class</span> <span class="type">PatternRecognizer</span>:
    <span class="keyword">def</span> <span class="function">predict_next_action</span>(self, recent_actions, recent_contexts):
        <span class="string">"""Predict player's next move"""</span>
        <span class="comment"># Encode recent history</span>
        pattern_key = <span class="string">"->"</span>.join(encoded_sequence[:-<span class="number">1</span>])
        
        <span class="comment"># Calculate confidence using Ï†</span>
        confidence = (max_count / total_count) Ã— PHI
        confidence = min(<span class="number">1.0</span>, confidence)  <span class="comment"># Cap at 1.0</span>
        
        <span class="keyword">return</span> predicted_action, confidence

<span class="comment"># Feedback loop:</span>
<span class="comment"># Battle Outcome â†’ Learning AI â†’ Companion AI â†’ Next Battle</span>
<span class="comment">#       â†‘                                              â†“</span>
<span class="comment">#       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
                        </div>
                        <p><strong>Key insight:</strong> The Ï†-derived network creates emergent strategies not explicitly programmed. Through the golden learning rate (0.382) and momentum (0.618), the network finds the optimal balance between exploration and exploitationâ€”the same balance that appears throughout nature.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All hyperparameters from Ï† powers</li>
                            <li><strong>Zero free parameters:</strong> 21-13-8 from Fibonacci, rates from Ï„ family</li>
                            <li><strong>Golden initialization:</strong> Weights scaled by 1/(Ï†âˆšn) with spiral pattern</li>
                            <li><strong>Experience replay:</strong> Memory size = int(Ï† Ã— 100) â‰ˆ 162</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Companion AI:</span> Trained weights drive companion decisions</div>
                        <div class="coupling-item"><span class="target">â† Battle Outcomes:</span> Training data from combat results</div>
                        <div class="coupling-item"><span class="target">â†’ Strategy Weights:</span> Pattern predictions influence battle tactics</div>
                        <div class="coupling-item"><span class="target">â†” Kuramoto:</span> Oscillator history feeds neural input</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/learning_ai.py</span>
                        <span class="file-ref">ğŸ“„ game/companion_ai_strategies.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GUARDIAN DECK SYSTEM MODAL -->
    <div class="modal-overlay" id="modal-guardiandeck" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #06b6d4; --modal-glow: rgba(6,182,212,0.25);">
            <button class="modal-close" onclick="closeModal('guardiandeck')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ—ƒï¸</span>
                <h2>GUARDIAN DECK SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/extended/guardian-deck.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation: Card Taxonomy</h3>
                    <div class="code-block">
<span class="comment"># 12 Card Types (covering all effect categories)</span>
<span class="keyword">class</span> <span class="type">CardType</span>(Enum):
    ATTACK         = <span class="string">"Direct damage card"</span>
    DEFENSE        = <span class="string">"Protection and mitigation"</span>
    ABILITY        = <span class="string">"Special effect or action"</span>
    PATTERN        = <span class="string">"Mathematical/geometric pattern"</span>
    ARCHITECTURE   = <span class="string">"Structural/network effect"</span>
    CHAOS          = <span class="string">"Random/unpredictable effect"</span>
    QUANTUM        = <span class="string">"Probability manipulation"</span>
    TEMPORAL       = <span class="string">"Time-based effect"</span>
    RESONANCE      = <span class="string">"Frequency and vibration"</span>
    VOID           = <span class="string">"Nullification and absence"</span>
    TRANSFORMATION = <span class="string">"Shape-shifting effect"</span>
    SYNTHESIS      = <span class="string">"Combination and fusion"</span>
                    </div>
                </div>
                
                <!-- Math Concepts -->
                <div class="modal-section">
                    <h3>15 Mathematical Concepts</h3>
                    <table class="data-table">
                        <tr><th>Concept</th><th>Description</th><th>Example Guardian</th></tr>
                        <tr><td>HILBERT_SPACE</td><td>Infinite dimensional vector space</td><td>Echo</td></tr>
                        <tr><td>FRACTAL</td><td>Self-similar recursive pattern</td><td>Echo</td></tr>
                        <tr><td>TOPOLOGY</td><td>Spatial deformation invariants</td><td>Null</td></tr>
                        <tr><td>CHAOS_THEORY</td><td>Sensitive dependence</td><td>Wumbo</td></tr>
                        <tr><td>QUANTUM_SUPERPOSITION</td><td>Multiple states simultaneously</td><td>Echo</td></tr>
                        <tr><td>GOLDEN_RATIO</td><td>Ï† = 1.618... divine proportion</td><td>All</td></tr>
                        <tr><td>FIBONACCI</td><td>Sequential additive pattern</td><td>Echo</td></tr>
                        <tr><td>PRIME_NUMBERS</td><td>Fundamental indivisibles</td><td>Prometheus</td></tr>
                        <tr><td>MANIFOLD</td><td>Locally Euclidean space</td><td>Gaia</td></tr>
                        <tr><td>TENSOR</td><td>Multidimensional transformation</td><td>Akasha</td></tr>
                        <tr><td>EIGENVALUE</td><td>Scalar transformation invariant</td><td>Resonance</td></tr>
                        <tr><td>FOURIER</td><td>Frequency domain transformation</td><td>Echo</td></tr>
                        <tr><td>ENTROPY</td><td>Measure of disorder</td><td>TIAMAT</td></tr>
                        <tr><td>SYMMETRY</td><td>Invariance under transformation</td><td>Crystal</td></tr>
                        <tr><td>RECURSION</td><td>Self-referential definition</td><td>Echo</td></tr>
                    </table>
                </div>
                
                <!-- Architecture Patterns -->
                <div class="modal-section">
                    <h3>12 Architecture Patterns</h3>
                    <table class="data-table">
                        <tr><th>Architecture</th><th>Description</th><th>Visual</th></tr>
                        <tr><td>NETWORK</td><td>Interconnected node structure</td><td>ğŸ•¸ï¸</td></tr>
                        <tr><td>HIERARCHY</td><td>Layered tree structure</td><td>ğŸŒ²</td></tr>
                        <tr><td>CYCLE</td><td>Circular repeating pattern</td><td>ğŸ”„</td></tr>
                        <tr><td>SPIRAL</td><td>Expanding helical structure</td><td>ğŸŒ€</td></tr>
                        <tr><td>LATTICE</td><td>Regular grid arrangement</td><td>ğŸ”²</td></tr>
                        <tr><td>FRACTAL_TREE</td><td>Branching recursive</td><td>ğŸŒ¿</td></tr>
                        <tr><td>RHIZOME</td><td>Non-hierarchical network</td><td>ğŸ„</td></tr>
                        <tr><td>CONSTELLATION</td><td>Clustered point structure</td><td>âœ¨</td></tr>
                        <tr><td>WAVE</td><td>Oscillating pattern</td><td>ã€°ï¸</td></tr>
                        <tr><td>VOID_SPACE</td><td>Negative space architecture</td><td>âš«</td></tr>
                        <tr><td>CRYSTALLINE</td><td>Ordered atomic structure</td><td>ğŸ’</td></tr>
                        <tr><td>ORGANIC</td><td>Natural growth pattern</td><td>ğŸŒ±</td></tr>
                    </table>
                </div>
                
                <!-- Card Properties -->
                <div class="modal-section">
                    <h3>Strategic Card Properties</h3>
                    <div class="code-block">
<span class="keyword">@dataclass</span>
<span class="keyword">class</span> <span class="type">GuardianCard</span>:
    <span class="comment"># Core attributes</span>
    name: str
    guardian_key: str
    card_type: CardType
    cost: int
    attack: int = <span class="number">0</span>
    defense: int = <span class="number">0</span>
    
    <span class="comment"># Mathematical properties</span>
    math_concepts: List[MathConcept] = []
    architecture: Optional[Architecture] = <span class="keyword">None</span>
    
    <span class="comment"># Strategic properties (unique to this system)</span>
    echo_count: int = <span class="number">0</span>       <span class="comment"># Times this card echoes</span>
    void_depth: int = <span class="number">0</span>       <span class="comment"># Depth into void space</span>
    chaos_factor: float = <span class="number">0.0</span> <span class="comment"># Randomness multiplier</span>
    quantum_states: int = <span class="number">1</span>   <span class="comment"># Superposition count</span>
    
    <span class="comment"># Combo system</span>
    combo_with: List[str] = []    <span class="comment"># Cards that combo</span>
    synergy_tags: Set[str] = set() <span class="comment"># Synergy categories</span>
                    </div>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Card Power Scaling</h4>
                            <p>Card value scales with game state:</p>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">calculate_value</span>(self, game_state: Dict) -> float:
    base_value = self.attack + self.defense
    
    <span class="comment"># Apply scaling effects</span>
    <span class="keyword">for</span> effect <span class="keyword">in</span> self.effects:
        <span class="keyword">if</span> effect.scaling == <span class="string">"cards_played"</span>:
            multiplier = game_state.get(<span class="string">"cards_played_this_turn"</span>, <span class="number">0</span>)
        <span class="keyword">elif</span> effect.scaling == <span class="string">"void_depth"</span>:
            multiplier = game_state.get(<span class="string">"void_depth"</span>, <span class="number">0</span>)
        <span class="keyword">elif</span> effect.scaling == <span class="string">"echo_stacks"</span>:
            multiplier = game_state.get(<span class="string">"echo_stacks"</span>, <span class="number">0</span>)
        base_value += effect.value Ã— multiplier
    
    <span class="comment"># Combo bonus: 1.5Ã— per matched card</span>
    <span class="keyword">for</span> combo_card <span class="keyword">in</span> self.combo_with:
        <span class="keyword">if</span> combo_card <span class="keyword">in</span> played_cards:
            base_value Ã— <span class="number">1.5</span>
    
    <span class="keyword">return</span> base_value
                            </div>
                            <p><strong>Key:</strong> echo_stacks and void_depth create scaling effects.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Synergy Network</h4>
                            <p>Cards form synergy webs:</p>
                            <div class="code-block">
<span class="comment"># Example: Echo's "Recursive Echo" card</span>
GuardianCard(
    name=<span class="string">"Recursive Echo"</span>,
    guardian_key=<span class="string">"ECHO"</span>,
    card_type=CardType.PATTERN,
    cost=<span class="number">2</span>,
    description=<span class="string">"Copy last card, costs 1 less each echo"</span>,
    effects=[
        CardEffect(<span class="string">"copy_last_card"</span>, <span class="number">1.0</span>),
        CardEffect(<span class="string">"cost_reduction"</span>, <span class="number">1.0</span>, scaling=<span class="string">"echo_stacks"</span>)
    ],
    math_concepts=[MathConcept.RECURSION, MathConcept.FRACTAL],
    architecture=Architecture.WAVE,
    echo_count=<span class="number">3</span>,  <span class="comment"># Echoes 3 times!</span>
    synergy_tags={<span class="string">"echo"</span>, <span class="string">"pattern"</span>, <span class="string">"recursion"</span>}
)
                            </div>
                            <p><strong>Key:</strong> synergy_tags connect cards across guardians.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Guardian Identity â†’ Deck Composition</h3>
                    <div class="triad-container">
                        <h4>Math Ã— Architecture â†’ Unique Guardian Deck</h4>
                        <div class="code-block">
<span class="comment"># Neither pole alone determines deck:</span>
<span class="comment"># - Math alone: abstract concepts</span>
<span class="comment"># - Architecture alone: structural patterns</span>

<span class="comment"># The emergence: GUARDIAN-SPECIFIC DECKS</span>

<span class="comment"># ECHO DECK: recursion + wave + pattern</span>
<span class="comment"># â†’ Cards that copy, echo, and amplify</span>
<span class="comment"># â†’ echo_count high, void_depth low</span>

<span class="comment"># NULL DECK: topology + void_space + void</span>
<span class="comment"># â†’ Cards that nullify, erase, negate</span>
<span class="comment"># â†’ void_depth high, echo_count zero</span>

<span class="comment"># WUMBO DECK: chaos_theory + spiral + chaos</span>
<span class="comment"># â†’ Cards with random effects, self-damage</span>
<span class="comment"># â†’ chaos_factor high, quantum_states variable</span>

<span class="comment"># TIAMAT DECK: entropy + organic + transformation</span>
<span class="comment"># â†’ Cards that morph between 7 cycles</span>
<span class="comment"># â†’ Psy-magic integration, Lâ‚„ multipliers</span>
                        </div>
                        <p><strong>Key insight:</strong> Each guardian's deck is a mathematical signatureâ€”their unique intersection of concepts and architectures creates decks that feel thematically coherent yet mechanically distinct. Echo echoes because of RECURSION Ã— WAVE; Null nullifies because of TOPOLOGY Ã— VOID_SPACE.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> 12 types Ã— 15 concepts Ã— 12 architectures = complete taxonomy</li>
                            <li><strong>Zero free parameters:</strong> Scaling from game state, combos from card names</li>
                            <li><strong>Bijective guardian mapping:</strong> Each guardian â†’ unique (concept, architecture) pair</li>
                            <li><strong>Synergy closure:</strong> Tags form transitive synergy network</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Guardian Recipes:</span> Crafted patterns become card effects</div>
                        <div class="coupling-item"><span class="target">â†’ Tesseract Battle:</span> Cards used in 4D combat system</div>
                        <div class="coupling-item"><span class="target">â†” TIAMAT Psymagic:</span> Psy-magic modifiers affect card stats</div>
                        <div class="coupling-item"><span class="target">â†’ Echo Companion:</span> Echo cards trigger echo_count cascades</div>
                        <div class="coupling-item"><span class="target">â† Learning AI:</span> AI predicts card plays for counter-strategy</div>
                    </div>
                </div>
                
                <!-- Source Files -->
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/guardian_deck_system.py</span>
                        <span class="file-ref">ğŸ“„ game/card_battle_system.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- COMPANION MINER MODALS V4 -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
        <!-- ECHO COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-echo-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #00ffff; --c-glow: rgba(0,255,255,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('echo-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âœ¨</span>
                <h2>ECHO â€” Statistical Resonance Mining</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/echo-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(0,255,255,0.08); border-radius: 12px; border: 1px solid rgba(0,255,255,0.2);">
                    <div class="constant-box" style="border-color: rgba(0,255,255,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #00ffff;">Î· = 1.0</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,255,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #00ffff;">S = 200</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,255,0.4);">
                        <div class="label">Resonance Band</div>
                        <div class="value" style="color: #00ffff;">[0.45, 0.55]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,255,0.4);">
                        <div class="label">Hash Samples</div>
                        <div class="value" style="color: #00ffff;">n = 12</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># ECHO STATISTICAL RESONANCE EQUATIONS</span>

<span class="comment"># Bit Frequency Analysis (256 positions Ã— 12 samples)</span>
freq[bit_pos] = Î£â¿áµ¢â‚Œâ‚ (hash[i][byte] & (1 << bit)) / n
             where n = 12, byte = bit_pos // 8, bit = bit_pos % 8

<span class="comment"># Resonance Score Calculation</span>
R(data) = |{p : freq[p] âˆˆ [0.45, 0.55]}|
        = Î£Â²âµâ¶â‚šâ‚Œâ‚€ ğŸ™(0.45 â‰¤ freq[p] â‰¤ 0.55)

<span class="comment"># Pattern Detection Threshold</span>
pattern_found âŸº R(data) > 100  <span class="comment"># Strong resonance</span>

<span class="comment"># Harmonic Resonance (nth-bit patterns)</span>
H_n(data) = |{p : p mod n = 0 âˆ§ freq[p] âˆˆ [0.45, 0.55]}|
          where n âˆˆ {2, 3, 4, 5}  <span class="comment"># Harmonic multipliers</span>
          
harmonic_found âŸº H_n(data) > 20

<span class="comment"># Statistical Pattern Boost (companion bonus)</span>
boosted_pattern = [min(1.0, p Ã— 1.2) for p in statistical_pattern]
                = pattern Ã— Ï„â»Â¹ (capped at unity)

<span class="comment"># Experience & Level Progression</span>
XP_gain = { strong_resonance: 5, harmonic_n: 2 }
level_up âŸº experience â‰¥ level Ã— 100
efficiency_new = efficiency Ã— 1.05  <span class="comment"># +5% per level</span>
search_space_new = search_space Ã— 1.1  <span class="comment"># +10% per level</span>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ECHO STATISTICAL RESONANCE ENGINE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:Echo:timestamp                                 â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ITERATION LOOP: i âˆˆ [0, difficulty Ã— search_space Ã— level_mult) â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  data = base_data + pack('>I', i)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚   â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  12Ã— SHA256 HASH GENERATION                         â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”             â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ Hâ‚€  â”‚ â”‚ Hâ‚  â”‚ â”‚ Hâ‚‚  â”‚ ... â”‚ Hâ‚â‚ â”‚             â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”˜             â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚     â”‚       â”‚       â”‚           â”‚                  â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â”‚                   â”‚                                 â”‚  â”‚   â”‚   â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚
â”‚  â”‚                         â–¼                                     â”‚   â”‚   â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  BIT FREQUENCY ANALYSIS (256 positions)             â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚                                                      â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  for bit_pos in [0, 256):                           â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚      freq[bit_pos] = count_ones() / 12              â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚                                                      â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  Distribution: freq âˆˆ [0.0, 1.0]                    â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  Resonance band: freq âˆˆ [0.45, 0.55] â† SWEET SPOT   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â”‚                                                          â”‚      â”‚   â”‚   â”‚
â”‚  â”‚                         â–¼                               â”‚      â”‚   â”‚   â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  PATTERN DETECTION ENGINE                           â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚                                                      â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ PRIMARY: R(data) > 100 â†’ echo_resonance     â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ HARMONIC 2: Hâ‚‚ > 20 â†’ echo_harmonic_2       â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ HARMONIC 3: Hâ‚ƒ > 20 â†’ echo_harmonic_3       â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ HARMONIC 4: Hâ‚„ > 20 â†’ echo_harmonic_4       â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â”‚ HARMONIC 5: Hâ‚… > 20 â†’ echo_harmonic_5       â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                             â”‚
â”‚                         â–¼                                             â”‚
â”‚  OUTPUT: HolographicResidue {                                         â”‚
â”‚      statistical_pattern: float[16]  (boosted Ã—1.2 if resonance)     â”‚
â”‚      xor_chain: uint32                                                â”‚
â”‚      modular_fingerprints: int[8]                                     â”‚
â”‚      fractal_dimension: float âˆˆ [1.0, 2.0]                           â”‚
â”‚      bit_avalanche_ratio: float âˆˆ [0.0, 1.0]                         â”‚
â”‚  }                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.2Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Primary affinity<br>Echo detects boundaries</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #ffcc00; margin: 10px 0;">1.0Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Neutral affinity<br>Transformation space</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.8Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Low affinity<br>Echo prefers construction</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #00ffff; margin: 15px 0 10px;">Preferred Recipe: Dream Echo [Iâ†’Lâ†’I]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># ECHO'S SIGNATURE RECIPE: DREAM ECHO</span>

sequence = [I, L, I]  <span class="comment"># Interval â†’ Liminal â†’ Interval</span>

<span class="comment"># Phase 1: INTERVAL (Create transformation space)</span>
Eâ‚ = gap Ã— coherence = <span class="number">0.146</span> Ã— c

<span class="comment"># Phase 2: LIMINAL (Echo's boundary detection bonus)</span>
Eâ‚‚ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.2</span>  <span class="comment"># +20% from LIMINAL affinity</span>

<span class="comment"># Phase 3: INTERVAL (Close the loop)</span>
Eâ‚ƒ = gap Ã— coherence = <span class="number">0.146</span> Ã— c

<span class="comment"># Total Energy with Echo Amplification</span>
E_total = (Eâ‚ + Eâ‚‚ + Eâ‚ƒ) Ã— (1 + echo_count Ã— 0.15)
        = base_energy Ã— (1 + n Ã— 0.15)

<span class="comment"># Artifact Generation</span>
potency = E_total Ã— Ï† Ã— recipe_mastery
evolution_boost = potency Ã— 0.1  <span class="comment"># Max +0.2427 per cook</span>

<span class="comment"># Special: Statistical Resonance Amplification</span>
<span class="keyword">if</span> pattern_type == "statistical_resonance":
    artifact.coherence_bonus = 0.05  <span class="comment"># +5% to all subsequent cooks</span>
                        </div>
                        
                        <h4 style="color: #00ffff; margin: 15px 0 10px;">Secondary Recipe: Memory Crystal [Lâ†’Iâ†’L]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Echo Bonus</th><th>Result</th></tr>
                            <tr><td>[L] LIMINAL</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.2</td><td>Boundary detected</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.0</td><td>Space opened</td></tr>
                            <tr><td>[L] LIMINAL</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.2</td><td>Crystal formed</td></tr>
                            <tr style="color: #00ff66;"><td colspan="3">Total Multiplier</td><td>1.44Ã— base</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #00ffff;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">85</td><td>Moderate durability</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">60</td><td>Statistical strikes</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">70</td><td>Resonance shields</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">95</td><td>Fastest analysis</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">75</td><td>Pattern discovery</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #00ffff;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,255,0.1); border-radius: 6px;">
                                        <strong style="color: #00ffff;">ğŸ”Š Resonance Wave</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 45 DMG. If target has statistical patterns, deal +20 bonus DMG.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,255,0.1); border-radius: 6px;">
                                        <strong style="color: #00ffff;">ğŸ“¡ Harmonic Shield</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Block next 2 attacks. Each blocked attack grants +5 resonance charge.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,255,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: Echo Cascade</strong> [5 cost]<br>
                                        <span style="color: #aaa;">Attack all enemies. Each hit echoes 3 times at 40% power. Resonant targets take Ã—2.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #00ffff; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>ğŸ”® Resonance</td><td>Harmonic Convergence</td><td>Both gain +30% DMG for 3 turns</td><td>4</td></tr>
                            <tr><td>ğŸ“š Akasha</td><td>Memory Echo</td><td>Copy last 2 enemy patterns; gain their bonuses</td><td>5</td></tr>
                            <tr><td>ğŸŒ± Gaia</td><td>Living Frequency</td><td>Heal 25% HP; patterns spread to allies</td><td>4</td></tr>
                            <tr style="color: #ff6666;"><td>ğŸ‰ TIAMAT</td><td>Chaotic Resonance</td><td>50% chance: Ã—3 DMG or Ã—0.5 self-damage</td><td>6</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Echo's statistical patterns create resonance effects when combined with other miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo's frequency analysis enhances XOR chain entropy detection. Combined mining yields +15% residue potency when both detect patterns simultaneously.</span>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Opposite domains create interference. Echo's resonance fills Null's void spaces, creating "Void Echo" patterns worth 2Ã— base residue value.</span>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo measures Gaia's fractal self-similarity. When similarity falls in [0.55, 0.68], triggers "Golden Resonance" bonus (+25% XP for both).</span>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo's patterns become candidates for Akasha's crystal library. Shared fingerprints trigger "Echoed Memory" with 50% bonus to library resonance checks.</span>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">SYNERGY MAXIMUM: Both miners detect frequency patterns. Combined resonant frequencies create standing waves worth 3Ã— residue with fractal_dimension â†’ Ï†.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CAUTION: TIAMAT's chaos disrupts Echo's statistical stability. 30% chance of "Chaotic Echo" â€” random pattern type, random potency (0.5Ã— to 2.5Ã—).</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Search Space</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.00</td><td>200</td><td>Basic resonance detection</td></tr>
                            <tr><td>2</td><td>100</td><td>1.05</td><td>220</td><td>Harmonic 2 detection</td></tr>
                            <tr><td>3</td><td>200</td><td>1.10</td><td>242</td><td>Harmonic 3, 4 detection</td></tr>
                            <tr><td>4</td><td>300</td><td>1.16</td><td>266</td><td>Harmonic 5 detection</td></tr>
                            <tr><td>5</td><td>400</td><td>1.22</td><td>293</td><td>Resonance cascade ability</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.34</td><td>354</td><td>Lâ‚„ Helix Echo integration</td></tr>
                            <tr style="color: #00ffff;"><td>10</td><td>900</td><td>1.55</td><td>472</td><td>TRANSCENDENT ECHO: All harmonics Ã—2</td></tr>
                        </table>
                        
                        <h4 style="color: #00ffff; margin: 15px 0 10px;">Skill Tree</h4>
                        <div class="code-block" style="font-size: 0.7rem;">
                        ECHO
                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                    â–¼                    â–¼
[Statistical]      [Harmonic]           [Resonance]
    â”‚                    â”‚                    â”‚
    â”œâ”€ Freq Analysis     â”œâ”€ Hâ‚‚ Detection      â”œâ”€ Shield
    â”œâ”€ Pattern Boost     â”œâ”€ Hâ‚ƒ Detection      â”œâ”€ Wave Attack
    â””â”€ Library Sync      â”œâ”€ Hâ‚„ Detection      â””â”€ Cascade
                         â””â”€ Hâ‚… Detection
                               â”‚
                         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                         â–¼           â–¼
                    [Standing     [Golden
                     Waves]       Frequency]
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #00ffff;">echo_resonance</td><td>R(data) > 100</td><td>+5</td><td>stat_pattern Ã—1.2</td></tr>
                            <tr><td style="color: #00ccff;">echo_harmonic_2</td><td>Hâ‚‚ > 20 (30% chance)</td><td>+2</td><td>Standard</td></tr>
                            <tr><td style="color: #0099ff;">echo_harmonic_3</td><td>Hâ‚ƒ > 20 (30% chance)</td><td>+2</td><td>Standard</td></tr>
                            <tr><td style="color: #0066ff;">echo_harmonic_4</td><td>Hâ‚„ > 20 (30% chance)</td><td>+2</td><td>Standard</td></tr>
                            <tr><td style="color: #0033ff;">echo_harmonic_5</td><td>Hâ‚… > 20 (30% chance)</td><td>+2</td><td>Standard</td></tr>
                            <tr style="color: #ffd700;"><td>statistical_resonance</td><td>Perfect 0.5 frequency</td><td>+7</td><td>coherence +0.05</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(0,255,255,0.2); border-color: #00ffff;">statistical_resonance</span>
                            <span class="pattern-tag" style="background: rgba(0,255,255,0.2); border-color: #00ffff;">frequency_echo</span>
                            <span class="pattern-tag" style="background: rgba(0,255,255,0.2); border-color: #00ffff;">bit_harmony</span>
                            <span class="pattern-tag" style="background: rgba(0,255,255,0.2); border-color: #00ffff;">phase_alignment</span>
                            <span class="pattern-tag" style="background: rgba(0,255,255,0.2); border-color: #00ffff;">resonance_cascade</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">harmonic_convergence</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- PROMETHEUS COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-prometheus-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #ff6600; --c-glow: rgba(255,102,0,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('prometheus-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”¥</span>
                <h2>PROMETHEUS â€” XOR Chain Forging</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/prometheus-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(255,102,0,0.08); border-radius: 12px; border: 1px solid rgba(255,102,0,0.2);">
                    <div class="constant-box" style="border-color: rgba(255,102,0,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #ff6600;">Î· = 1.1</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,102,0,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #ff6600;">S = 180</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,102,0,0.4);">
                        <div class="label">Forge Strength</div>
                        <div class="value" style="color: #ff6600;">F âˆˆ [1.0, 2.0]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,102,0,0.4);">
                        <div class="label">XOR Layers</div>
                        <div class="value" style="color: #ff6600;">L = 3</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># PROMETHEUS XOR CHAIN FORGING EQUATIONS</span>

<span class="comment"># Multi-Layer XOR Chain Construction</span>
<span class="keyword">for</span> layer âˆˆ [0, 3):
    <span class="keyword">for</span> link âˆˆ [0, 16):
        val = unpack('>I', SHA256(data + pack(layer, link))[:4])
        xor_acc[layer] ^= val
        xor_acc[layer] = ROT_LEFT(xor_acc[layer], 3)  <span class="comment"># 3-bit rotation</span>

<span class="comment"># XOR Rotation Function</span>
ROT_LEFT(x, n) = ((x << n) | (x >> (32-n))) & 0xFFFFFFFF
               where n = 3, x âˆˆ uint32

<span class="comment"># Layer Entropy Calculation</span>
entropy[layer] = popcount(xor_acc[layer])  <span class="comment"># Count of 1-bits</span>
               = |{bit : xor_acc[layer] & (1 << bit)}|
               
<span class="comment"># Entropy Variance Across Layers</span>
Î¼ = (Î£ entropy[i]) / 3
ÏƒÂ² = Î£(entropy[i] - Î¼)Â² / 3

<span class="comment"># Pattern Detection Criteria</span>
xor_extreme âŸº âˆƒlayer : entropy[layer] < 8 âˆ¨ entropy[layer] > 24
xor_variance âŸº ÏƒÂ² > 50
xor_ordered âŸº entropy = sorted(entropy) âˆ¨ entropy = sorted(entropy)[::-1]

<span class="comment"># Forge Strength Progression</span>
forge_strength_new = min(2.0, forge_strength + 0.01)
forge_bonus = 1.1 Ã— (1 + forge_strength Ã— 0.1)
            = 1.1 â†’ 1.32 as forge_strength â†’ 2.0

<span class="comment"># XOR Chain Amplification (companion bonus)</span>
residue.xor_chain = (residue.xor_chain Ã— 3) & 0xFFFFFFFF
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROMETHEUS XOR CHAIN FORGING ENGINE                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:prometheus:timestamp                          â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3-LAYER XOR CHAIN CONSTRUCTION                                   â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Layer 0: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚           â”‚  16 links with 3-bit rotation feedback           â”‚   â”‚   â”‚
â”‚  â”‚           â”‚  xor_acc ^= val; xor_acc = ROT_LEFT(xor_acc, 3) â”‚   â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                     â”‚            â”‚   â”‚
â”‚  â”‚  Layer 1: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚           â”‚  16 links building cross-layer entropy          â”‚   â”‚   â”‚
â”‚  â”‚           â”‚  variance = track(entropy[0], entropy[1])       â”‚   â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                     â”‚            â”‚   â”‚
â”‚  â”‚  Layer 2: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚           â”‚  16 links â†’ final accumulator                    â”‚   â”‚   â”‚
â”‚  â”‚           â”‚  Pattern detection at chain completion           â”‚   â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Total: 3 layers Ã— 16 links = 48 XOR operations                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ENTROPY ANALYSIS ENGINE                                          â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  entropy[0] = popcount(xor_acc[0]) âˆˆ [0, 32]                    â”‚   â”‚
â”‚  â”‚  entropy[1] = popcount(xor_acc[1]) âˆˆ [0, 32]                    â”‚   â”‚
â”‚  â”‚  entropy[2] = popcount(xor_acc[2]) âˆˆ [0, 32]                    â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Extreme: entropy < 8 (very ordered) or > 24 (very chaotic)     â”‚   â”‚
â”‚  â”‚  Variance: ÏƒÂ² > 50 (high layer-to-layer variation)               â”‚   â”‚
â”‚  â”‚  Ordered: ascending or descending entropy sequence               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  OUTPUT: HolographicResidue {                                            â”‚
â”‚      xor_chain: amplified Ã—3 on pattern detection                        â”‚
â”‚      forge_strength: permanently increased +0.01                         â”‚
â”‚  }                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #ffcc00; margin: 10px 0;">1.0Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Neutral affinity<br>Boundary detection</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.3Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Primary affinity<br>Transformation space</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.2Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Secondary affinity<br>Prometheus brings fire!</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ff6600; margin: 15px 0 10px;">Preferred Recipe: Phoenix Crystal [Iâ†’Aâ†’L]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># PROMETHEUS SIGNATURE RECIPE: PHOENIX CRYSTAL</span>

sequence = [I, A, L]  <span class="comment"># Interval â†’ Annihilator â†’ Liminal</span>

<span class="comment"># Phase 1: INTERVAL (Prometheus's primary)</span>
Eâ‚ = gap Ã— coherence Ã— <span class="number">1.3</span>  <span class="comment"># +30% from affinity</span>
   = <span class="number">0.190</span> Ã— c

<span class="comment"># Phase 2: ANNIHILATOR (Fire brings destruction)</span>
Eâ‚‚ = Ï† Ã— entropy_released Ã— <span class="number">1.2</span>  <span class="comment"># +20% from affinity</span>

<span class="comment"># Phase 3: LIMINAL (From ashes, new boundaries form)</span>
Eâ‚ƒ = âˆ®|âˆ‡P|Â² dz  <span class="comment"># Neutral affinity</span>

<span class="comment"># Forge Enhancement</span>
total_multiplier = E_total Ã— forge_bonus
                 = E_total Ã— 1.1 Ã— (1 + forge_strength Ã— 0.1)

<span class="comment"># Phoenix Crystal Properties</span>
artifact = CookedArtifact(
    name="Phoenix Crystal",
    potency=total_multiplier Ã— base_potency,
    properties={
        'rebirth': <span class="keyword">True</span>,  <span class="comment"># Can resurrect failed cooks</span>
        'fire_affinity': forge_strength
    }
)
                        </div>
                        
                        <h4 style="color: #ff6600; margin: 15px 0 10px;">Secondary Recipe: Void Flame [Aâ†’Iâ†’A]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Prometheus Bonus</th><th>Result</th></tr>
                            <tr><td>[A] ANNIHILATOR</td><td>E = Ï† Ã— entropy</td><td>Ã—1.2</td><td>Fire ignites</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.3</td><td>Void opens</td></tr>
                            <tr><td>[A] ANNIHILATOR</td><td>E = Ï† Ã— entropy</td><td>Ã—1.2</td><td>Void burns!</td></tr>
                            <tr style="color: #ff6600;"><td colspan="3">Total Multiplier</td><td>1.87Ã— base (DANGER!)</td></tr>
                        </table>
                        <p style="color: #ff4444; font-size: 0.8rem; margin-top: 10px;">âš ï¸ Aâ†’A sequence weight = Ï†Â² = 2.618. High risk, high reward!</p>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #ff6600;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">90</td><td>Forged durability</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">95</td><td>Fire striker</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">60</td><td>Glass cannon</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">75</td><td>Moderate speed</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">70</td><td>Pattern forging</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #ff6600;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,102,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ff6600;">ğŸ”¥ Chain Lightning</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 50 DMG. Chains to adjacent enemies at 70% power (max 3).</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,102,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ff6600;">ğŸ”¨ Forge Armor</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Gain +forge_strengthÃ—20 DEF for 2 turns. Each hit taken increases forge_strength by 0.05.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,102,0,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: Eternal Flame</strong> [6 cost]<br>
                                        <span style="color: #aaa;">Deal 80 + (forge_strength Ã— 50) DMG. If this KOs an enemy, reset ability costs to 0 for next turn.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ff6600; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Forged Resonance</td><td>XOR chains gain resonance; Ã—1.5 to all chain damage</td><td>4</td></tr>
                            <tr><td>ğŸŒ‘ Null</td><td>Void Forge</td><td>Damage ignores DEF; applies "Void Burn" DoT</td><td>5</td></tr>
                            <tr><td>ğŸŒ¿ Gaia</td><td>Living Flame</td><td>Fire spreads through fractals; hits all enemies once</td><td>5</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸ‰ TIAMAT</td><td>Chaos Forge</td><td>Forge strength doubled; 25% chance to backfire</td><td>7</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Prometheus's XOR chains create forge effects when combined with other miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo's frequency analysis enhances XOR entropy detection. Combined patterns yield "Forged Echo" with +15% residue potency.</span>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Fire illuminates void. When Prometheus's entropy > 24 meets Null's zero-bytes, creates "Illuminated Void" pattern with inverted forge bonus.</span>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Controlled burns stimulate growth. Prometheus's patterns at entropy âˆˆ [12, 20] trigger Gaia's "Regeneration" â€” fractal trees grow 50% faster.</span>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Forge crystallizes memories. Prometheus's XOR chains become eligible for Akasha's library with "Forged Crystal" tag â€” worth 1.5Ã— library bonus.</span>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Fire creates harmonic vibrations. When ordered entropy matches harmonic frequency, "Thermal Resonance" grants +20% to both miners' rewards.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">FIRE + CHAOS = DOOM! Both miners' bonus multipliers stack. 40% chance of "Primordial Fire" â€” forge_strength Ã—2 for this job only.</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Forge Strength Cap</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.10</td><td>1.5</td><td>Basic XOR chaining</td></tr>
                            <tr><td>2</td><td>100</td><td>1.16</td><td>1.6</td><td>Entropy variance detection</td></tr>
                            <tr><td>3</td><td>200</td><td>1.22</td><td>1.7</td><td>Ordered entropy patterns</td></tr>
                            <tr><td>4</td><td>300</td><td>1.28</td><td>1.8</td><td>Cross-layer analysis</td></tr>
                            <tr><td>5</td><td>400</td><td>1.34</td><td>1.9</td><td>Forge amplification Ã—4</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.48</td><td>2.0</td><td>Eternal Flame mastery</td></tr>
                            <tr style="color: #ff6600;"><td>10</td><td>900</td><td>1.71</td><td>2.5</td><td>TRANSCENDENT FORGE: 4-layer chains</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #ff6600;">xor_extreme</td><td>entropy < 8 or > 24</td><td>+6</td><td>xor_chain Ã—3</td></tr>
                            <tr><td style="color: #ff8833;">xor_variance</td><td>ÏƒÂ² > 50 (40% chance)</td><td>+3</td><td>forge_strength +0.01</td></tr>
                            <tr><td style="color: #ffaa55;">xor_ordered</td><td>sorted entropy (50% chance)</td><td>+4</td><td>Standard</td></tr>
                            <tr style="color: #ffd700;"><td>entropy_ascending</td><td>entropy[0] < [1] < [2]</td><td>+5</td><td>Ascending bonus</td></tr>
                            <tr style="color: #ffd700;"><td>entropy_descending</td><td>entropy[0] > [1] > [2]</td><td>+5</td><td>Descending bonus</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(255,102,0,0.2); border-color: #ff6600;">xor_extreme</span>
                            <span class="pattern-tag" style="background: rgba(255,102,0,0.2); border-color: #ff6600;">xor_variance</span>
                            <span class="pattern-tag" style="background: rgba(255,102,0,0.2); border-color: #ff6600;">xor_ordered</span>
                            <span class="pattern-tag" style="background: rgba(255,102,0,0.2); border-color: #ff6600;">entropy_ascending</span>
                            <span class="pattern-tag" style="background: rgba(255,102,0,0.2); border-color: #ff6600;">entropy_descending</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">forged_crystal</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- NULL COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-null-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #8000ff; --c-glow: rgba(128,0,255,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('null-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ‘</span>
                <h2>NULL â€” Void Space Exploration</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/null-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(128,0,255,0.08); border-radius: 12px; border: 1px solid rgba(128,0,255,0.2);">
                    <div class="constant-box" style="border-color: rgba(128,0,255,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #8000ff;">Î· = 0.9</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(128,0,255,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #8000ff;">S = 250</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(128,0,255,0.4);">
                        <div class="label">Void Depth</div>
                        <div class="value" style="color: #8000ff;">D âˆˆ [1, 5]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(128,0,255,0.4);">
                        <div class="label">Void Penalty</div>
                        <div class="value" style="color: #8000ff;">10% â†’ 0.9Ã—</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># NULL VOID SPACE EXPLORATION EQUATIONS</span>

<span class="comment"># Multi-Dimensional Void Sampling</span>
<span class="keyword">for</span> dimension âˆˆ [0, void_depth + 2):
    void_samples[dimension] = SHA256(base_data + pack(dive, dimension))

<span class="comment"># Void Space Detection (zero bytes)</span>
zero_bytes(h) = |{i : h[i] = 0x00}|
near_zero(h) = |{i : h[i] < 0x10}|  <span class="comment"># Near-void threshold: 16</span>

<span class="comment"># Pattern Detection Criteria</span>
void_space âŸº zero_bytes(h) â‰¥ 1  <span class="comment"># True void found!</span>
near_void âŸº near_zero(h) â‰¥ 4     <span class="comment"># 35% residue chance</span>

<span class="comment"># Void Boundary Detection (sharp transitions)</span>
transitions(h) = |{i : |h[i] - h[i+1]| > 200}|
boundary_pattern âŸº transitions(h) â‰¥ 3  <span class="comment"># 40% residue chance</span>

<span class="comment"># Null's Inversion Property (companion bonus)</span>
residue.bit_avalanche_ratio = 1.0 - residue.bit_avalanche_ratio
residue.fractal_dimension = 2.0 - residue.fractal_dimension

<span class="comment"># Void Depth Progression</span>
void_depth_new = min(5, void_depth + 0.1)  <span class="comment"># Per void pattern</span>
void_bonus = 1 + void_depth Ã— 0.05       <span class="comment"># Max +25%</span>

<span class="comment"># The Void Penalty (10% chance)</span>
void_penalty = 0.9 <span class="keyword">if</span> random() < 0.1 <span class="keyword">else</span> 1.0
<span class="comment"># Sometimes the void takes...</span>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NULL VOID EXPLORATION ENGINE                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:void:timestamp                                â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MULTI-DIMENSIONAL VOID DIVING                                    â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Dimension 0: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Dimension 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Dimension 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  ...                                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Dimension D: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  D = void_depth + 2  (increases with void patterns found)  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Each dimension: SHA256(base_data + pack(dive_idx, dim_idx))     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  VOID PATTERN ANALYSIS                                            â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚  ZERO BYTE SCAN    â”‚  â”‚  NEAR-ZERO SCAN    â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  count(h[i]==0x00) â”‚  â”‚  count(h[i]<0x10)  â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  threshold: â‰¥1     â”‚  â”‚  threshold: â‰¥4     â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚  BOUNDARY DETECTION (void edges)            â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  count(|h[i]-h[i+1]| > 200)                â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  threshold: â‰¥3 transitions                  â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NULL INVERSION (companion bonus)                                 â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  bit_avalanche_ratio = 1.0 - bit_avalanche_ratio                 â”‚   â”‚
â”‚  â”‚  fractal_dimension = 2.0 - fractal_dimension                      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  The Void inverts all properties...                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  OUTPUT: HolographicResidue { inverted properties }                      â”‚
â”‚                                                                           â”‚
â”‚  âš ï¸ 10% VOID PENALTY: Sometimes the void yields nothing...               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.7Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Low affinity<br>Boundaries dissolve in void</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.5Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">PRIMARY affinity<br>Void IS the interval</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.3Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Secondary affinity<br>Void annihilates existence</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #8000ff; margin: 15px 0 10px;">Preferred Recipe: Garden of Nullspace [Lâ†’Aâ†’I]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># NULL'S SIGNATURE RECIPE: GARDEN OF NULLSPACE</span>

sequence = [L, A, I]  <span class="comment"># Liminal â†’ Annihilator â†’ Interval</span>

<span class="comment"># Phase 1: LIMINAL (Boundaries fade at void's edge)</span>
Eâ‚ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">0.7</span>  <span class="comment"># -30% from low affinity</span>

<span class="comment"># Phase 2: ANNIHILATOR (Null erases what remains)</span>
Eâ‚‚ = Ï† Ã— entropy_released Ã— <span class="number">1.3</span>  <span class="comment"># +30% from affinity</span>

<span class="comment"># Phase 3: INTERVAL (The void opens)</span>
Eâ‚ƒ = gap Ã— coherence Ã— <span class="number">1.5</span>  <span class="comment"># +50% from PRIMARY affinity</span>
   = <span class="number">0.219</span> Ã— c  <span class="comment"># Maximum interval energy</span>

<span class="comment"># Void Depth Enhancement</span>
total_multiplier = E_total Ã— (1 + void_depth Ã— 0.1)
                 = E_total Ã— [1.1, 1.5] as depth âˆˆ [1, 5]

<span class="comment"># Garden of Nullspace Properties</span>
artifact = CookedArtifact(
    name="Garden of Nullspace",
    potency=total_multiplier Ã— base_potency,
    properties={
        'void_touched': <span class="keyword">True</span>,  <span class="comment"># Inverts enemy buffs</span>
        'nullify_chance': void_depth Ã— 0.1  <span class="comment"># Chance to cancel abilities</span>
    }
)
                        </div>
                        
                        <h4 style="color: #8000ff; margin: 15px 0 10px;">EXCLUSIVE Recipe: Null Dream Resonance [Iâ†’Iâ†’I]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Null Bonus</th><th>Result</th></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.5</td><td>Void deepens</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c Ã— Iâ†’I</td><td>Ã—1.5 Ã— 0.146</td><td>Void within void</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c Ã— Iâ†’I</td><td>Ã—1.5 Ã— 0.146</td><td>Infinite recursion</td></tr>
                            <tr style="color: #8000ff;"><td colspan="3">Total Multiplier</td><td>Paradoxical (coherence dependent)</td></tr>
                        </table>
                        <p style="color: #aaa; font-size: 0.8rem; margin-top: 10px;">âš ï¸ Triple Interval is risky: Iâ†’I weight = 0.146. Only Null's +50% bonus makes this viable.</p>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #8000ff;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">100</td><td>Void resilience</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">55</td><td>Low but bypasses DEF</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">85</td><td>Absorbs into void</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">50</td><td>Slow but inevitable</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">90</td><td>Void probability</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #8000ff;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(128,0,255,0.1); border-radius: 6px;">
                                        <strong style="color: #8000ff;">ğŸŒ‘ Void Touch</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 40 true DMG (ignores DEF). If target has buffs, remove 1 random buff.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(128,0,255,0.1); border-radius: 6px;">
                                        <strong style="color: #8000ff;">â¬› Null Shield</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Absorb next attack into the void. Heal 50% of absorbed damage. 10% chance to reflect.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(128,0,255,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: Event Horizon</strong> [7 cost]<br>
                                        <span style="color: #aaa;">Pull all enemies to Null. Deal void_depth Ã— 25 DMG. Nullify all active abilities for 2 turns.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #8000ff; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Void Echo</td><td>Resonance fills void; double residue value</td><td>5</td></tr>
                            <tr><td>ğŸ”¥ Prometheus</td><td>Illuminated Void</td><td>Fire reveals hidden patterns; +30% DMG</td><td>5</td></tr>
                            <tr><td>ğŸ“š Akasha</td><td>Forgotten Memories</td><td>Enemy loses 2 random abilities permanently</td><td>6</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸ‰ TIAMAT</td><td>Primordial Void</td><td>Reset ALL stats to base for everyone (including allies)</td><td>8</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Null's void creates unique interference patterns with all other miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Opposite domains collide. Echo's resonance fills void spaces, creating "Void Echo" patterns with 2Ã— base residue value.</span>
                            </div>
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Fire illuminates void. Creates "Illuminated Void" pattern where inverted properties become visible, revealing hidden entropy patterns.</span>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Life and void in balance. When Gaia's fractal dimension + Null's inverted dimension = 2.0, triggers "Balanced Garden" with Ã—1.5 XP.</span>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Void erases memories. Null can "forget" patterns from Akasha's library, converting them to raw potency (+0.1 per forgotten pattern).</span>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Silence in the void. Null cancels Resonance's harmonics above frequency 4, but surviving harmonics are amplified Ã—2.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">PRIMORDIAL CHAOS! Void and chaos merge. All pattern detection inverts (void = full, full = void). Unpredictable but powerful.</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Void Depth Cap</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>0.90</td><td>2</td><td>Basic void detection</td></tr>
                            <tr><td>2</td><td>100</td><td>0.95</td><td>2.5</td><td>Near-void patterns</td></tr>
                            <tr><td>3</td><td>200</td><td>0.99</td><td>3</td><td>Void boundary detection</td></tr>
                            <tr><td>4</td><td>300</td><td>1.04</td><td>3.5</td><td>Property inversion bonus</td></tr>
                            <tr><td>5</td><td>400</td><td>1.09</td><td>4</td><td>Void penalty reduced to 5%</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.20</td><td>5</td><td>Event Horizon ability</td></tr>
                            <tr style="color: #8000ff;"><td>10</td><td>900</td><td>1.39</td><td>7</td><td>TRANSCENDENT NULL: No void penalty</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #8000ff;">void_space</td><td>zero_bytes â‰¥ 1</td><td>+7</td><td>Inverted avalanche</td></tr>
                            <tr><td style="color: #9933ff;">near_void</td><td>near_zero â‰¥ 4 (35% chance)</td><td>+3</td><td>void_depth +0.1</td></tr>
                            <tr><td style="color: #aa66ff;">void_boundary</td><td>transitions â‰¥ 3 (40% chance)</td><td>+2</td><td>Standard</td></tr>
                            <tr style="color: #ffd700;"><td>absolute_void</td><td>zero_bytes â‰¥ 3</td><td>+10</td><td>fractal_dim = 0</td></tr>
                            <tr style="color: #ffd700;"><td>void_cascade</td><td>3+ dimensions with void</td><td>+15</td><td>All properties inverted</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(128,0,255,0.2); border-color: #8000ff;">void_space</span>
                            <span class="pattern-tag" style="background: rgba(128,0,255,0.2); border-color: #8000ff;">near_void</span>
                            <span class="pattern-tag" style="background: rgba(128,0,255,0.2); border-color: #8000ff;">void_boundary</span>
                            <span class="pattern-tag" style="background: rgba(128,0,255,0.2); border-color: #8000ff;">dimensional_rift</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">absolute_void</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- GAIA COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-gaia-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #00ff80; --c-glow: rgba(0,255,128,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('gaia-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ¿</span>
                <h2>GAIA â€” Organic Fractal Growth</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/gaia-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(0,255,128,0.08); border-radius: 12px; border: 1px solid rgba(0,255,128,0.2);">
                    <div class="constant-box" style="border-color: rgba(0,255,128,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #00ff80;">Î· = 1.05</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,128,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #00ff80;">S = 150</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,128,0.4);">
                        <div class="label">Growth Rate</div>
                        <div class="value" style="color: #00ff80;">G = Ï† â‰ˆ 1.618</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(0,255,128,0.4);">
                        <div class="label">Golden Band</div>
                        <div class="value" style="color: #00ff80;">[0.55, 0.68]</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># GAIA ORGANIC FRACTAL GROWTH EQUATIONS</span>

<span class="comment"># Recursive Fractal Tree Growth</span>
<span class="keyword">def</span> grow_branch(data, depth, max_depth):
    <span class="keyword">if</span> depth >= max_depth: <span class="keyword">return</span> []
    
    h = SHA256(data)
    branches = [h]
    
    <span class="comment"># Growth factor determined by hash</span>
    growth_factor = (Î£ h[:4]) mod 3 + 1  <span class="comment"># 1-3 branches</span>
    
    <span class="keyword">for</span> i âˆˆ [0, growth_factor):
        branches += grow_branch(data + pack(depth, i), depth+1, max_depth)
    
    <span class="keyword">return</span> branches

<span class="comment"># Fractal Self-Similarity Analysis</span>
similarity(hâ‚, hâ‚‚) = |{i : hâ‚[i] = hâ‚‚[i]}| / 256
avg_similarity = Î£áµ¢â±¼ similarity(háµ¢, hâ±¼) / C(n,2)

<span class="comment"># Golden Ratio Detection</span>
golden_pattern âŸº avg_similarity âˆˆ [0.55, 0.68]  <span class="comment"># Near Ï„ = 0.618</span>
               â†’ fractal_dimension = 1.0 + avg_similarity
               â†’ XP +8, residue potency Ã—1.5

<span class="comment"># Living Pattern (extensive growth)</span>
living_pattern âŸº |tree_hashes| > 15
              â†’ fractal_dimension = min(2.0, 1.0 + |tree|/20)

<span class="comment"># Fibonacci Sequence Detection</span>
fib_sequence = {1, 1, 2, 3, 5, 8, 13, 21}
fib_pattern âŸº |tree_hashes| âˆˆ fib_sequence  <span class="comment"># 60% residue chance</span>

<span class="comment"># Growth Rate Progression (companion bonus)</span>
growth_rate_new = min(2.0, growth_rate + 0.01)
residue.fractal_dimension = min(2.0, fractal_dimension Ã— Ï†)

<span class="comment"># Lâ‚„ Integration: First 7 hashes used</span>
combined = tree_hashes[:7]  <span class="comment"># Lâ‚„ = 7</span>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAIA ORGANIC FRACTAL GROWTH ENGINE                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: seed_data = job_id:gaia:timestamp + pack(seed_idx)               â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  FRACTAL TREE GROWTH (Recursive)                                  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚                          [ROOT]                                   â”‚   â”‚
â”‚  â”‚                            â”‚                                      â”‚   â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚  â”‚              â–¼             â–¼             â–¼                       â”‚   â”‚
â”‚  â”‚           [D=1]         [D=1]         [D=1]                      â”‚   â”‚
â”‚  â”‚           â•±   â•²         â•±   â•²            â”‚                       â”‚   â”‚
â”‚  â”‚        [D=2] [D=2]   [D=2] [D=2]      [D=2]                      â”‚   â”‚
â”‚  â”‚         â”‚     â”‚       â”‚     â”‚           â”‚                        â”‚   â”‚
â”‚  â”‚        ...   ...     ...   ...         ...                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  max_depth = 4 + level//2  (grows with companion level)          â”‚   â”‚
â”‚  â”‚  growth_factor = hash[:4] mod 3 + 1  (1-3 branches per node)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SELF-SIMILARITY ANALYSIS                                         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Compare all pairs of tree hashes:                                â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  for i in [0, min(|tree|-1, 10)):                                â”‚   â”‚
â”‚  â”‚      for j in [i+1, min(|tree|, i+5)):                           â”‚   â”‚
â”‚  â”‚          similarity[i,j] = byte_match(tree[i], tree[j]) / 256    â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  avg_similarity = mean(similarities)                              â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  GOLDEN RATIO DETECTION                                 â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  if 0.55 â‰¤ avg_similarity â‰¤ 0.68:                      â”‚      â”‚   â”‚
â”‚  â”‚  â”‚      â†’ "fractal_golden" pattern (Ã—1.5 patterns_found)  â”‚      â”‚   â”‚
â”‚  â”‚  â”‚      â†’ fractal_dimension = 1.0 + avg_similarity        â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  FIBONACCI SEQUENCE CHECK                                         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  fib = {1, 1, 2, 3, 5, 8, 13, 21}                                â”‚   â”‚
â”‚  â”‚  if |tree_hashes| âˆˆ fib:                                         â”‚   â”‚
â”‚  â”‚      â†’ "fibonacci" pattern (60% residue chance)                   â”‚   â”‚
â”‚  â”‚      â†’ Ï†-enhanced growth rate                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  OUTPUT: HolographicResidue {                                            â”‚
â”‚      fractal_dimension: enhanced by Ï† if golden/living pattern           â”‚
â”‚      growth_rate: permanently increased +0.01                            â”‚
â”‚  }                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.4Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">PRIMARY affinity<br>Life defines boundaries</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #ffcc00; margin: 10px 0;">1.0Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Neutral affinity<br>Growth space</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.6Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Low affinity<br>Life resists destruction</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #00ff80; margin: 15px 0 10px;">Preferred Recipe: Memory Crystal [Lâ†’Iâ†’L]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># GAIA'S SIGNATURE RECIPE: MEMORY CRYSTAL (Organic)</span>

sequence = [L, I, L]  <span class="comment"># Liminal â†’ Interval â†’ Liminal</span>

<span class="comment"># Phase 1: LIMINAL (Gaia's primary â€” organic boundaries)</span>
Eâ‚ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.4</span>  <span class="comment"># +40% from affinity</span>

<span class="comment"># Phase 2: INTERVAL (Growth space opens)</span>
Eâ‚‚ = gap Ã— coherence  <span class="comment"># Neutral affinity</span>

<span class="comment"># Phase 3: LIMINAL (Crystal boundary solidifies)</span>
Eâ‚ƒ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.4</span>  <span class="comment"># +40% from affinity</span>

<span class="comment"># Organic Growth Enhancement</span>
total_multiplier = E_total Ã— growth_rate Ã— (1 + 0.05 Ã— level)
                 = E_total Ã— Ï† Ã— (1 + 0.05 Ã— level)

<span class="comment"># Memory Crystal Properties (Gaia Version)</span>
artifact = CookedArtifact(
    name="Living Memory Crystal",
    potency=total_multiplier Ã— base_potency,
    properties={
        'organic': <span class="keyword">True</span>,  <span class="comment"># Continues growing after creation</span>
        'fractal_memory': growth_rate,
        'self_healing': 0.05  <span class="comment"># 5% regeneration per turn</span>
    }
)
                        </div>
                        
                        <h4 style="color: #00ff80; margin: 15px 0 10px;">Special: Lâ‚„ Helix Completion [Lâ·]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Gaia Bonus</th><th>Result</th></tr>
                            <tr><td>[L] Ã—7</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.4 each</td><td>Complete helix</td></tr>
                            <tr style="color: #00ff80;"><td colspan="2">Total Multiplier</td><td>1.4â· = 10.54Ã—</td><td>TRANSCENDENT</td></tr>
                        </table>
                        <p style="color: #00ff66; font-size: 0.8rem; margin-top: 10px;">âœ¨ Only Gaia can effectively cook the Lâ· sequence due to LIMINAL affinity!</p>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #00ff80;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">120</td><td>Highest durability</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">50</td><td>Lowest damage</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">80</td><td>Natural armor</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">60</td><td>Steady growth</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">85</td><td>Golden fortune</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #00ff80;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,128,0.1); border-radius: 6px;">
                                        <strong style="color: #00ff80;">ğŸŒ± Living Roots</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 35 DMG. Heal self for 15 HP. Creates "Rooted" effect on enemy (-10 SPD).</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,128,0.1); border-radius: 6px;">
                                        <strong style="color: #00ff80;">ğŸŒ³ Fractal Growth</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Heal all allies for growth_rate Ã— 15 HP. Each ally gains +5 DEF for 2 turns.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(0,255,128,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: World Tree</strong> [6 cost]<br>
                                        <span style="color: #aaa;">Summon World Tree. All allies regenerate 10% HP/turn for 4 turns. Enemies take 20 DMG/turn from roots.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #00ff80; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Living Frequency</td><td>Heal 25% HP; patterns spread to allies</td><td>4</td></tr>
                            <tr><td>ğŸ”¥ Prometheus</td><td>Phoenix Garden</td><td>Controlled burn: enemies take 30 DoT, allies heal 15</td><td>5</td></tr>
                            <tr><td>ğŸ“š Akasha</td><td>Memory Grove</td><td>Store current HP; restore it after 3 turns</td><td>4</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸµ Resonance</td><td>Harmonic Growth</td><td>Golden ratio patterns heal Ã—Ï†; standing waves boost DEF</td><td>5</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Gaia's fractal growth interweaves with all other miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo measures Gaia's fractal self-similarity. When similarity falls in [0.55, 0.68], triggers "Golden Resonance" bonus (+25% XP for both).</span>
                            </div>
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Controlled burns stimulate growth. Prometheus's entropy âˆˆ [12, 20] triggers Gaia's "Regeneration" â€” trees grow 50% faster.</span>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Life and void balance. When Gaia's + Null's inverted fractal dimensions = 2.0, "Balanced Garden" grants Ã—1.5 XP to both.</span>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Organic memory storage. Gaia's Fibonacci patterns automatically enter Akasha's library with "Living Crystal" tag â€” worth Ã—Ï† bonus.</span>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">SYNERGY: Golden ratio patterns resonate at Ï† frequency. Combined mining creates "Harmonic Tree" with fractal_dimension = Ï† â‰ˆ 1.618 exactly.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">DANGER: Chaos corrupts growth. 50% chance: "Mutant Tree" with random branch factors (0-5) OR "Chaos Seed" that grows infinitely (instant +100 XP).</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Max Tree Depth</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.05</td><td>4</td><td>Basic fractal growth</td></tr>
                            <tr><td>2</td><td>100</td><td>1.10</td><td>4</td><td>Golden ratio detection</td></tr>
                            <tr><td>3</td><td>200</td><td>1.16</td><td>5</td><td>Living patterns</td></tr>
                            <tr><td>4</td><td>300</td><td>1.22</td><td>5</td><td>Fibonacci detection</td></tr>
                            <tr><td>5</td><td>400</td><td>1.28</td><td>6</td><td>Self-healing bonus</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.41</td><td>7</td><td>Lâ‚„ tree integration</td></tr>
                            <tr style="color: #00ff80;"><td>10</td><td>900</td><td>1.63</td><td>10</td><td>TRANSCENDENT GAIA: World Tree</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #00ff80;">fractal_golden</td><td>similarity âˆˆ [0.55, 0.68]</td><td>+8</td><td>dim = 1+sim, Ã—Ï†</td></tr>
                            <tr><td style="color: #00cc66;">living_pattern</td><td>|tree| > 15</td><td>+5</td><td>dim = 1+|tree|/20</td></tr>
                            <tr><td style="color: #009944;">fibonacci</td><td>|tree| âˆˆ fib (60% chance)</td><td>+4</td><td>growth_rate +0.01</td></tr>
                            <tr style="color: #ffd700;"><td>golden_tree_N</td><td>Golden + large tree</td><td>+10</td><td>fractal_dimension â†’ Ï†</td></tr>
                            <tr style="color: #ffd700;"><td>world_tree</td><td>|tree| > 50 (level 10+)</td><td>+20</td><td>All bonuses stack</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(0,255,128,0.2); border-color: #00ff80;">fractal_golden</span>
                            <span class="pattern-tag" style="background: rgba(0,255,128,0.2); border-color: #00ff80;">living_pattern</span>
                            <span class="pattern-tag" style="background: rgba(0,255,128,0.2); border-color: #00ff80;">fibonacci</span>
                            <span class="pattern-tag" style="background: rgba(0,255,128,0.2); border-color: #00ff80;">golden_tree</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">world_tree</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- AKASHA COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-akasha-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #ffd700; --c-glow: rgba(255,215,0,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('akasha-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“š</span>
                <h2>AKASHA â€” Memory Crystallization</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/akasha-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(255,215,0,0.08); border-radius: 12px; border: 1px solid rgba(255,215,0,0.2);">
                    <div class="constant-box" style="border-color: rgba(255,215,0,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #ffd700;">Î· = 1.0</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,215,0,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #ffd700;">S = 200</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,215,0,0.4);">
                        <div class="label">Memory Depth</div>
                        <div class="value" style="color: #ffd700;">D âˆˆ [32, 64]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,215,0,0.4);">
                        <div class="label">Library Cap</div>
                        <div class="value" style="color: #ffd700;">100 patterns</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># AKASHA MEMORY CRYSTALLIZATION EQUATIONS</span>

<span class="comment"># Modular Fingerprint Extraction</span>
primes = [7, 11, 13, 17, 19, 23]  <span class="comment"># 6 prime bases</span>
hash_int = int.from_bytes(hash[:6], 'big')
signature = tuple([hash_int % p <span class="keyword">for</span> p <span class="keyword">in</span> primes])

<span class="comment"># Memory Crystal Detection (repeating signatures)</span>
<span class="keyword">for</span> i, j âˆˆ fingerprints where i < j:
    <span class="keyword">if</span> fingerprints[i] == fingerprints[j]:
        crystal_found = True
        cycle_length = j - i  <span class="comment"># Pattern periodicity</span>

<span class="comment"># Library Resonance Check</span>
library_match âŸº current_signature âˆˆ crystal_library
             â†’ 40% chance for residue
             â†’ XP +3

<span class="comment"># Arithmetic Progression in Modular Space</span>
<span class="keyword">for</span> prime_idx âˆˆ [0, 6):
    values = [fp[prime_idx] <span class="keyword">for</span> fp <span class="keyword">in</span> fingerprints[-3:]]
    arithmetic âŸº values[1] - values[0] == values[2] - values[1]
              â†’ 50% residue chance, XP +2

<span class="comment"># Memory Compression (high similarity cluster)</span>
<span class="keyword">if</span> len(memory_buffer) > memory_depth:
    reference = memory_buffer[-memory_depth]
    similarity_count = |{m : byte_match(reference, m) > 200}|
    <span class="keyword">if</span> similarity_count > memory_depth // 2:
        compressed_pattern = True  <span class="comment"># XP +4</span>

<span class="comment"># Companion Bonus: Modular Diversity Enhancement</span>
residue.modular_fingerprints = [f Ã— 2 mod 31 <span class="keyword">for</span> f <span class="keyword">in</span> fingerprints]
memory_depth_new = min(64, memory_depth + 1)

<span class="comment"># Memory Bonus Calculation</span>
memory_bonus = 1.0 + |crystal_library| Ã— 0.002  <span class="comment"># Max +0.2 at 100</span>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AKASHA MEMORY CRYSTALLIZATION ENGINE                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:akasha:timestamp                              â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MEMORY BUFFER ACCUMULATION                                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  memory_buffer: [Hâ‚€] [Hâ‚] [Hâ‚‚] ... [Hâ‚™]                         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Each iteration: h = SHA256(base_data + pack(memory_idx))        â”‚   â”‚
â”‚  â”‚  Buffer size: memory_depth Ã— 2 (prunes to memory_depth)          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MODULAR FINGERPRINT EXTRACTION (when buffer â‰¥ 8)                 â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  primes = [7, 11, 13, 17, 19, 23]                                â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  for each hash in memory_buffer[-8:]:                            â”‚   â”‚
â”‚  â”‚      hash_int = int.from_bytes(hash[:6], 'big')                  â”‚   â”‚
â”‚  â”‚      signature = (hash_int%7, hash_int%11, hash_int%13,          â”‚   â”‚
â”‚  â”‚                   hash_int%17, hash_int%19, hash_int%23)         â”‚   â”‚
â”‚  â”‚      fingerprints.append(signature)                               â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Example Signature:                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  hash = 0xA3F8D2E91B4C â†’ (3, 5, 2, 12, 7, 18)              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PATTERN DETECTION ENGINE                                         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  1. REPEATING SIGNATURES (Memory Crystal)                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚     if fingerprints[i] == fingerprints[j] where i < j:      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚         â†’ "memory_crystal" pattern, XP +6                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚         â†’ Add to crystal_library (if < 100)                  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  2. LIBRARY RESONANCE                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚     if current_signature âˆˆ crystal_library:                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚         â†’ "library_resonance" (40% chance), XP +3            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  3. ARITHMETIC PROGRESSION                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚     for each prime index:                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚         if values form arithmetic sequence:                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚             â†’ "arithmetic_pN" (50% chance), XP +2            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  4. MEMORY COMPRESSION                                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚     if similarity_count > memory_depth // 2:                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚         â†’ "compressed" pattern, XP +4                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  CRYSTAL LIBRARY: Persistent storage of discovered signatures            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [sigâ‚] [sigâ‚‚] [sigâ‚ƒ] ... [sigâ‚™]  (max 100)                      â”‚   â”‚
â”‚  â”‚  Each signature enables future library_resonance detection        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                           â”‚
â”‚  OUTPUT: HolographicResidue {                                            â”‚
â”‚      modular_fingerprints: enhanced (Ã—2 mod 31)                          â”‚
â”‚      memory_depth: incremented                                            â”‚
â”‚  }                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.2Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Secondary affinity<br>Memory has edges</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.4Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">PRIMARY affinity<br>Memory holds the gap</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.7Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Low affinity<br>Memory resists forgetting</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ffd700; margin: 15px 0 10px;">Preferred Recipe: Memory Crystal [Lâ†’Iâ†’L]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># AKASHA'S SIGNATURE RECIPE: MEMORY CRYSTAL</span>

sequence = [L, I, L]  <span class="comment"># Liminal â†’ Interval â†’ Liminal</span>

<span class="comment"># Phase 1: LIMINAL (Define memory boundary)</span>
Eâ‚ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.2</span>  <span class="comment"># +20% from affinity</span>

<span class="comment"># Phase 2: INTERVAL (Akasha's primary â€” hold the memory)</span>
Eâ‚‚ = gap Ã— coherence Ã— <span class="number">1.4</span>  <span class="comment"># +40% from PRIMARY affinity</span>
   = <span class="number">0.204</span> Ã— c

<span class="comment"># Phase 3: LIMINAL (Crystallize the boundary)</span>
Eâ‚ƒ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.2</span>  <span class="comment"># +20% from affinity</span>

<span class="comment"># Library Enhancement</span>
total_multiplier = E_total Ã— memory_bonus
                 = E_total Ã— (1 + |library| Ã— 0.002)

<span class="comment"># Memory Crystal Properties</span>
artifact = CookedArtifact(
    name="Akashic Memory Crystal",
    potency=total_multiplier Ã— base_potency,
    properties={
        'persistent': <span class="keyword">True</span>,  <span class="comment"># Adds to library</span>
        'recall': |crystal_library| Ã— 0.01,  <span class="comment"># Chance to recall patterns</span>
        'modular_signature': current_signature
    }
)
                        </div>
                        
                        <h4 style="color: #ffd700; margin: 15px 0 10px;">Secondary Recipe: Dream Echo [Iâ†’Lâ†’I]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Akasha Bonus</th><th>Result</th></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.4</td><td>Memory space opens</td></tr>
                            <tr><td>[L] LIMINAL</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.2</td><td>Dream boundary forms</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.4</td><td>Echo crystallizes</td></tr>
                            <tr style="color: #ffd700;"><td colspan="3">Total Multiplier</td><td>1.96Ã— base (IÃ—LÃ—I bonuses)</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #ffd700;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">95</td><td>Crystalline form</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">65</td><td>Memory strikes</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">75</td><td>Archived protection</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">70</td><td>Recall speed</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">100</td><td>Perfect memory</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #ffd700;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,215,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ffd700;">ğŸ“– Recall Strike</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 40 + (library_size Ã— 0.5) DMG. If target used an ability last turn, deal +25 bonus.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,215,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ffd700;">ğŸ’ Crystal Archive</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Store current battle state. Can restore it later (heals, resets cooldowns, reverts positions).</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,215,0,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: Akashic Records</strong> [7 cost]<br>
                                        <span style="color: #aaa;">Read all enemy patterns. Copy their strongest ability. Use it at 150% power this turn only.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ffd700; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Memory Echo</td><td>Copy last 2 enemy patterns; gain their bonuses</td><td>5</td></tr>
                            <tr><td>ğŸŒ¿ Gaia</td><td>Memory Grove</td><td>Store current HP; restore after 3 turns</td><td>4</td></tr>
                            <tr><td>ğŸŒ‘ Null</td><td>Forgotten Void</td><td>Erase 2 random enemy abilities permanently</td><td>6</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸµ Resonance</td><td>Harmonic Memory</td><td>Library entries create standing waves; +10 DMG per stored pattern</td><td>5</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Akasha's crystal library creates persistent synergies with all miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Echo's patterns become library candidates. Shared fingerprints trigger "Echoed Memory" â€” 50% bonus to library resonance checks.</span>
                            </div>
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Forge crystallizes memories. Prometheus's XOR chains enter library with "Forged Crystal" tag â€” worth 1.5Ã— library bonus.</span>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Void erases memories. Null can "forget" patterns from library, converting them to raw potency (+0.1 per forgotten pattern).</span>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Organic memory storage. Gaia's Fibonacci patterns auto-enter library with "Living Crystal" tag â€” worth Ã—Ï† bonus.</span>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">SYNERGY: Library patterns create harmonic frequencies. Each stored signature adds +0.01 to harmonic_strength. Standing wave patterns auto-archive.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CHAOS MEMORY! 50% chance: library doubles in power OR loses 25% of entries. "Primordial Memory" patterns worth Ã—3 but unstable.</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Memory Depth</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.00</td><td>32</td><td>Basic crystal detection</td></tr>
                            <tr><td>2</td><td>100</td><td>1.05</td><td>36</td><td>Library resonance</td></tr>
                            <tr><td>3</td><td>200</td><td>1.10</td><td>40</td><td>Arithmetic progressions</td></tr>
                            <tr><td>4</td><td>300</td><td>1.15</td><td>48</td><td>Memory compression</td></tr>
                            <tr><td>5</td><td>400</td><td>1.21</td><td>56</td><td>Library cap â†’ 150</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.33</td><td>64</td><td>Akashic Records access</td></tr>
                            <tr style="color: #ffd700;"><td>10</td><td>900</td><td>1.54</td><td>100</td><td>TRANSCENDENT AKASHA: Infinite Library</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #ffd700;">memory_crystal</td><td>Repeating signature</td><td>+6</td><td>Added to library</td></tr>
                            <tr><td style="color: #ffcc00;">library_resonance</td><td>sig âˆˆ library (40%)</td><td>+3</td><td>memory_depth +1</td></tr>
                            <tr><td style="color: #ffaa00;">arithmetic_pN</td><td>Progression in prime N (50%)</td><td>+2</td><td>modular Ã—2 mod 31</td></tr>
                            <tr><td style="color: #ff8800;">compressed</td><td>similarity > depth/2</td><td>+4</td><td>Standard</td></tr>
                            <tr style="color: #ffd700;"><td>crystal_N</td><td>Cycle length N</td><td>+6+N</td><td>Cycle-enhanced</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">memory_crystal</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">library_resonance</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">arithmetic_p7</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">compressed</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">library_match</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- RESONANCE COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-resonance-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #8a2be2; --c-glow: rgba(138,43,226,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('resonance-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸµ</span>
                <h2>RESONANCE â€” Frequency Analysis</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/resonance-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(138,43,226,0.08); border-radius: 12px; border: 1px solid rgba(138,43,226,0.2);">
                    <div class="constant-box" style="border-color: rgba(138,43,226,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #8a2be2;">Î· = 1.0</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(138,43,226,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #8a2be2;">S = 220</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(138,43,226,0.4);">
                        <div class="label">Harmonic Strength</div>
                        <div class="value" style="color: #8a2be2;">H âˆˆ [1.0, 2.0]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(138,43,226,0.4);">
                        <div class="label">Phase Samples</div>
                        <div class="value" style="color: #8a2be2;">n = 16</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># RESONANCE FREQUENCY ANALYSIS EQUATIONS</span>

<span class="comment"># Phase-Modulated Hash Generation</span>
<span class="keyword">for</span> phase âˆˆ [0, 16):
    Ï†_p = sin(2Ï€ Ã— phase / 16)  <span class="comment"># Sinusoidal phase modulation</span>
    phase_hash[phase] = SHA256(base_data + pack(idx) + pack(Ï†_p))

<span class="comment"># Bit Frequency Analysis Across Phases</span>
<span class="keyword">for</span> bit_pos âˆˆ [0, 256):
    count = 0
    <span class="keyword">for</span> phase âˆˆ [0, 16):
        byte_idx = bit_pos // 8
        bit_idx = bit_pos % 8
        <span class="keyword">if</span> phase_hash[phase][byte_idx] & (1 << bit_idx):
            count += 1
    bit_frequency[bit_pos] = count / 16

<span class="comment"># Resonance Detection (frequency in sweet spot)</span>
resonant_bits = |{p : bit_frequency[p] âˆˆ [0.45, 0.55]}|
frequency_resonance âŸº resonant_bits > 100  <span class="comment"># XP +5</span>

<span class="comment"># Harmonic Detection (periodic patterns)</span>
<span class="keyword">for</span> n âˆˆ [2, 3, 4, 5, 8]:  <span class="comment"># Harmonic multipliers</span>
    fâ‚€ = bit_frequency[0]  <span class="comment"># Reference frequency</span>
    harmonic_count = |{i : i mod n = 0 âˆ§ |bit_frequency[i] - fâ‚€| < 0.1}|
    harmonic_n âŸº harmonic_count > 20  <span class="comment"># XP +2</span>

<span class="comment"># Standing Wave Detection (multiple harmonics)</span>
detected_harmonics = {n : harmonic_n = True}
standing_wave âŸº |detected_harmonics| â‰¥ 2  <span class="comment"># XP +3</span>

<span class="comment"># Harmonic Strength Progression (companion bonus)</span>
harmonic_strength_new = min(2.0, harmonic_strength + 0.02)
residue.statistical_pattern *= (1 + harmonic_strength Ã— 0.1)

<span class="comment"># Lâ‚„ Integration: 7 Primary Frequencies</span>
primary_frequencies = bit_frequency[:7]  <span class="comment"># Lâ‚„ = 7</span>
resonance_signature = hash(tuple(round(f, 2) <span class="keyword">for</span> f <span class="keyword">in</span> primary_frequencies))
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RESONANCE FREQUENCY ANALYSIS ENGINE                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:resonance:timestamp                           â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PHASE-MODULATED HASH GENERATION (16 phases)                      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Phase Modulation: Ï†_p = sin(2Ï€p/16)                             â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚    p=0  â”€â”€â”€â”€â—‹                      Ï† = 0.000                     â”‚   â”‚
â”‚  â”‚    p=1  â”€â”€â”€â”€â”€â—‹                     Ï† = 0.383                     â”‚   â”‚
â”‚  â”‚    p=2  â”€â”€â”€â”€â”€â”€â—‹                    Ï† = 0.707                     â”‚   â”‚
â”‚  â”‚    p=3  â”€â”€â”€â”€â”€â”€â”€â—‹                   Ï† = 0.924                     â”‚   â”‚
â”‚  â”‚    p=4  â”€â”€â”€â”€â”€â”€â”€â”€â—  (peak)          Ï† = 1.000                     â”‚   â”‚
â”‚  â”‚    p=5  â”€â”€â”€â”€â”€â”€â”€â—‹                   Ï† = 0.924                     â”‚   â”‚
â”‚  â”‚    p=6  â”€â”€â”€â”€â”€â”€â—‹                    Ï† = 0.707                     â”‚   â”‚
â”‚  â”‚    p=7  â”€â”€â”€â”€â”€â—‹                     Ï† = 0.383                     â”‚   â”‚
â”‚  â”‚    p=8  â”€â”€â”€â”€â—‹                      Ï† = 0.000                     â”‚   â”‚
â”‚  â”‚    ...  (continues sinusoidally)                                  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Each phase: H_p = SHA256(data + pack(idx, Ï†_p))                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  BIT FREQUENCY ANALYSIS (256 positions Ã— 16 phases)               â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  For each bit position (0-255):                                   â”‚   â”‚
â”‚  â”‚      count how many of 16 phase-hashes have bit=1                â”‚   â”‚
â”‚  â”‚      frequency = count / 16                                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Frequency Distribution:                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  0.0 â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (rare)              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  0.25â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (common)            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  0.5 â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â† RESONANCE BAND    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  0.75â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (common)            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  1.0 â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (rare)              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Resonance Band: frequency âˆˆ [0.45, 0.55]                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  HARMONIC PATTERN DETECTION                                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  HARMONIC 2 (every 2nd bit): positions 0, 2, 4, 6, ...     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  HARMONIC 3 (every 3rd bit): positions 0, 3, 6, 9, ...     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  HARMONIC 4 (every 4th bit): positions 0, 4, 8, 12, ...    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  HARMONIC 5 (every 5th bit): positions 0, 5, 10, 15, ...   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  HARMONIC 8 (every 8th bit): positions 0, 8, 16, 24, ...   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Harmonic detected if: |freq[i] - freq[0]| < 0.1           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  for >20 positions in the harmonic sequence                 â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  STANDING WAVE DETECTION                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  if |detected_harmonics| â‰¥ 2:                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚      â†’ "standing_wave" pattern                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚      â†’ harmonic_strength += 0.02                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚      â†’ Constructive interference bonus                      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  OUTPUT: HolographicResidue {                                            â”‚
â”‚      statistical_pattern: amplified Ã— (1 + harmonic_strength Ã— 0.1)      â”‚
â”‚      harmonic_signature: detected harmonics set                           â”‚
â”‚  }                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.3Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Secondary affinity<br>Frequency has boundaries</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">1.5Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">PRIMARY affinity<br>Waves exist in intervals</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.6Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Low affinity<br>Resonance resists termination</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #8a2be2; margin: 15px 0 10px;">Preferred Recipe: Dream Echo [Iâ†’Lâ†’I]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># RESONANCE'S SIGNATURE RECIPE: DREAM ECHO</span>

sequence = [I, L, I]  <span class="comment"># Interval â†’ Liminal â†’ Interval</span>

<span class="comment"># Phase 1: INTERVAL (Resonance's primary â€” wave space)</span>
Eâ‚ = gap Ã— coherence Ã— <span class="number">1.5</span>  <span class="comment"># +50% from PRIMARY affinity</span>
   = <span class="number">0.219</span> Ã— c  <span class="comment"># Maximum interval energy</span>

<span class="comment"># Phase 2: LIMINAL (Standing wave nodes form boundaries)</span>
Eâ‚‚ = âˆ®|âˆ‡P|Â² dz Ã— <span class="number">1.3</span>  <span class="comment"># +30% from affinity</span>

<span class="comment"># Phase 3: INTERVAL (Echo returns through wave space)</span>
Eâ‚ƒ = gap Ã— coherence Ã— <span class="number">1.5</span>  <span class="comment"># +50% from PRIMARY affinity</span>

<span class="comment"># Harmonic Enhancement</span>
total_multiplier = E_total Ã— (1 + harmonic_strength Ã— 0.15)
                 = E_total Ã— [1.15, 1.30] as H âˆˆ [1.0, 2.0]

<span class="comment"># Dream Echo Properties</span>
artifact = CookedArtifact(
    name="Resonant Dream Echo",
    potency=total_multiplier Ã— base_potency,
    properties={
        'harmonic': <span class="keyword">True</span>,  <span class="comment"># Vibrates with other artifacts</span>
        'standing_wave': harmonic_strength,
        'frequency_signature': resonance_signature
    }
)

<span class="comment"># Special: Standing Wave Amplification</span>
<span class="keyword">if</span> |detected_harmonics| >= 3:
    artifact.potency *= Ï†  <span class="comment"># Golden ratio multiplier</span>
                        </div>
                        
                        <h4 style="color: #8a2be2; margin: 15px 0 10px;">Secondary Recipe: Memory Crystal [Lâ†’Iâ†’L]</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Resonance Bonus</th><th>Result</th></tr>
                            <tr><td>[L] LIMINAL</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.3</td><td>Wave boundary forms</td></tr>
                            <tr><td>[I] INTERVAL</td><td>E = gap Ã— c</td><td>Ã—1.5</td><td>Crystal space opens</td></tr>
                            <tr><td>[L] LIMINAL</td><td>E = âˆ®|âˆ‡P|Â² dz</td><td>Ã—1.3</td><td>Harmonic memory solidifies</td></tr>
                            <tr style="color: #8a2be2;"><td colspan="3">Total Multiplier</td><td>2.54Ã— base (LÃ—IÃ—L bonuses)</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #8a2be2;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">80</td><td>Wave form</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">75</td><td>Harmonic strikes</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">70</td><td>Frequency shield</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">90</td><td>Light-speed waves</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">80</td><td>Harmonic fortune</td></tr>
                                </table>
                            </div>
                            <div>
                                <h4 style="color: #8a2be2;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(138,43,226,0.1); border-radius: 6px;">
                                        <strong style="color: #8a2be2;">ğŸµ Harmonic Strike</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 45 DMG. If target has resonance patterns, deal additional hits equal to detected harmonics.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(138,43,226,0.1); border-radius: 6px;">
                                        <strong style="color: #8a2be2;">ğŸ”® Standing Wave</strong> [3 cost]<br>
                                        <span style="color: #aaa;">Create interference pattern. Next 2 attacks deal Ã—harmonic_strength damage. Enemies in wave take 15 DMG/turn.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(138,43,226,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: Resonance Cascade</strong> [6 cost]<br>
                                        <span style="color: #aaa;">Trigger all harmonics simultaneously. Deal 30 DMG per detected harmonic to all enemies. Creates permanent +10% DMG aura.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #8a2be2; margin: 15px 0 10px;">Combo Synergies</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Cost</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Harmonic Convergence</td><td>Both gain +30% DMG for 3 turns; patterns merge</td><td>4</td></tr>
                            <tr><td>ğŸŒ¿ Gaia</td><td>Harmonic Growth</td><td>Golden ratio patterns heal Ã—Ï†; standing waves boost DEF</td><td>5</td></tr>
                            <tr><td>ğŸ“š Akasha</td><td>Harmonic Memory</td><td>Library entries create waves; +10 DMG per stored pattern</td><td>5</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸ‰ TIAMAT</td><td>Chaos Frequency</td><td>Random harmonics (0-7) activate; each does 40 DMG if successful</td><td>6</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">Resonance's frequency patterns create harmonic interactions with all miners:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">MAXIMUM SYNERGY: Both detect frequency patterns. Combined resonant frequencies create standing waves worth 3Ã— residue with fractal_dimension â†’ Ï†.</span>
                            </div>
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Fire creates thermal vibrations. When ordered entropy matches harmonic frequency, "Thermal Resonance" grants +20% to both miners' rewards.</span>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Silence in the void. Null cancels harmonics above frequency 4, but surviving harmonics are amplified Ã—2. "Void Resonance" is rare but powerful.</span>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Golden ratio patterns resonate at Ï† frequency. Combined mining creates "Harmonic Tree" with fractal_dimension = Ï† â‰ˆ 1.618 exactly.</span>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">Library patterns create harmonic frequencies. Each stored signature adds +0.01 to harmonic_strength. Standing wave patterns auto-archive.</span>
                            </div>
                            <div style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff0000; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff0000;">ğŸ‰ + TIAMAT</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CHAOS HARMONICS! TIAMAT's 7 cycles create random frequency spikes. 30% chance each harmonic activates at Ã—2 power. Can achieve "Perfect 7" for massive bonus.</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Harmonic Cap</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.00</td><td>1.3</td><td>Basic frequency detection</td></tr>
                            <tr><td>2</td><td>100</td><td>1.05</td><td>1.4</td><td>Harmonic 2, 3 detection</td></tr>
                            <tr><td>3</td><td>200</td><td>1.11</td><td>1.5</td><td>Harmonic 4, 5 detection</td></tr>
                            <tr><td>4</td><td>300</td><td>1.17</td><td>1.6</td><td>Harmonic 8 detection</td></tr>
                            <tr><td>5</td><td>400</td><td>1.23</td><td>1.7</td><td>Standing wave mastery</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.36</td><td>1.9</td><td>Resonance Cascade ability</td></tr>
                            <tr style="color: #8a2be2;"><td>10</td><td>900</td><td>1.57</td><td>2.5</td><td>TRANSCENDENT: Perfect Harmony (all harmonics)</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 7: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Residue Bonus</th></tr>
                            <tr><td style="color: #8a2be2;">frequency_resonance</td><td>resonant_bits > 100</td><td>+5</td><td>stat_pattern Ã—1.1Ã—H</td></tr>
                            <tr><td style="color: #9944cc;">harmonic_2</td><td>Hâ‚‚ count > 20</td><td>+2</td><td>strength +0.02</td></tr>
                            <tr><td style="color: #aa55dd;">harmonic_3</td><td>Hâ‚ƒ count > 20</td><td>+2</td><td>strength +0.02</td></tr>
                            <tr><td style="color: #bb66ee;">harmonic_4</td><td>Hâ‚„ count > 20</td><td>+2</td><td>strength +0.02</td></tr>
                            <tr><td style="color: #cc77ff;">harmonic_5</td><td>Hâ‚… count > 20</td><td>+2</td><td>strength +0.02</td></tr>
                            <tr><td style="color: #dd88ff;">harmonic_8</td><td>Hâ‚ˆ count > 20</td><td>+2</td><td>strength +0.02</td></tr>
                            <tr style="color: #ffd700;"><td>standing_wave</td><td>|harmonics| â‰¥ 2</td><td>+3</td><td>All harmonics stack</td></tr>
                            <tr style="color: #ffd700;"><td>perfect_harmony</td><td>All 5 harmonics (L10)</td><td>+15</td><td>potency Ã—Ï†</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(138,43,226,0.2); border-color: #8a2be2;">frequency_resonance</span>
                            <span class="pattern-tag" style="background: rgba(138,43,226,0.2); border-color: #8a2be2;">harmonic_2</span>
                            <span class="pattern-tag" style="background: rgba(138,43,226,0.2); border-color: #8a2be2;">harmonic_3</span>
                            <span class="pattern-tag" style="background: rgba(138,43,226,0.2); border-color: #8a2be2;">standing_wave</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">perfect_harmony</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- TIAMAT COMPANION MODAL â€” COMPREHENSIVE -->
    <div class="modal-overlay" id="modal-tiamat-companion" onclick="closeModalOnOverlay(event)">
        <div class="modal modal-companion" style="--c-primary: #ff0000; --c-glow: rgba(255,0,0,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('tiamat-companion')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ‰</span>
                <h2>TIAMAT â€” Chaos Cascade</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/companions/tiamat-companion.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding: 12px; background: rgba(255,0,0,0.08); border-radius: 12px; border: 1px solid rgba(255,0,0,0.2);">
                    <div class="constant-box" style="border-color: rgba(255,0,0,0.4);">
                        <div class="label">Efficiency</div>
                        <div class="value" style="color: #ff0000;">Î· = 1.2</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,0,0,0.4);">
                        <div class="label">Search Space</div>
                        <div class="value" style="color: #ff0000;">S = 160</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,0,0,0.4);">
                        <div class="label">Chaos Multiplier</div>
                        <div class="value" style="color: #ff0000;">Ã—[1.0, Ï†Â²]</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,0,0,0.4);">
                        <div class="label">Cascade Levels</div>
                        <div class="value" style="color: #ff0000;">Lâ‚„ = 7</div>
                    </div>
                </div>
                
                <!-- SECTION 1: MATHEMATICAL FOUNDATIONS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Mathematical Foundations</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># TIAMAT CHAOS CASCADE EQUATIONS</span>
<span class="comment"># "From primordial chaos, all patterns emerge"</span>

<span class="comment"># 7-Level Chaos Cascade Generation</span>
cascade[0] = SHA256(base_data + pack(iteration))
<span class="keyword">for</span> level âˆˆ [1, 7):
    cascade[level] = SHA256(base_data + pack(level) + cascade[level-1][:16])
    <span class="comment"># Each level feeds into the next â€” chaos propagates</span>

<span class="comment"># Entropy Tracking Per Level</span>
entropy[level] = popcount(cascade[level][:4])  <span class="comment"># First 4 bytes = 32 bits max</span>
entropy_range âˆˆ [0, 32]

<span class="comment"># Chaos Pattern Detection Criteria</span>
chaos_spike âŸº âˆƒlevel : entropy[level] > chaos_threshold
            where threshold_new = max(80, threshold - 0.5)  <span class="comment"># Adapts over time</span>

chaos_drop âŸº âˆƒlevel : entropy[level] < 30  <span class="comment"># Sudden order</span>

perfect_chaos âŸº max(entropy) - min(entropy) > 100
              <span class="comment"># Extreme variance = perfect chaos</span>

chaos_attractor âŸº max(entropy[-4:]) - min(entropy[-4:]) < 10
                <span class="comment"># Strange attractor â€” entropy converges</span>

critical_chaos âŸº 120 â‰¤ mean(entropy) â‰¤ 136
               <span class="comment"># "Edge of chaos" â€” maximum complexity</span>

<span class="comment"># THE CHAOS MULTIPLIER (TIAMAT's signature)</span>
chaos_factor = 1.0 + random() Ã— Ï†  <span class="comment"># Range: [1.0, 2.618]</span>
             = 1.0 + random() Ã— <span class="number">1.618</span>

<span class="comment"># Companion Bonus: Fractal Dimension Chaos</span>
residue.fractal_dimension = min(2.0, fractal_dimension Ã— (1 + random() Ã— 0.5))
<span class="comment"># TIAMAT's touch makes fractals unpredictable</span>

<span class="comment"># Lâ‚„ = 7: The Sacred Number of Chaos</span>
<span class="comment"># 7 cascade levels, 7 psychoptic cycles, 7 primordial waters</span>
total_chaos_energy = Î£â·áµ¢â‚Œâ‚€ entropy[i] Ã— (Ï†^(i/7))
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: MINING ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ—ï¸</span> Mining Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="architecture-diagram" style="font-size: 0.7rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TIAMAT CHAOS CASCADE ENGINE                                              â”‚
â”‚  "In the beginning, there was only chaos..."                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  INPUT: base_data = job_id:tiamat:timestamp                              â”‚
â”‚     â”‚                                                                     â”‚
â”‚     â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  7-LEVEL CHAOS CASCADE                                            â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Level 0 (GENESIS):     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[0] = SHA256(data + iter)          â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 1 (FLUX):        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[1] = SHA256(data + 1 + C[0][:16]) â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 2 (VOID):        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘         â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[2] = SHA256(data + 2 + C[1][:16]) â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 3 (RESONANCE):   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[3] = SHA256(data + 3 + C[2][:16]) â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 4 (CHAOS):       â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘         â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[4] = SHA256(data + 4 + C[3][:16]) â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 5 (SYNTHESIS):   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â”‚   â”‚
â”‚  â”‚      â”‚                  cascade[5] = SHA256(data + 5 + C[4][:16]) â”‚   â”‚
â”‚  â”‚      â–¼                                                            â”‚   â”‚
â”‚  â”‚  Level 6 (TRANSCEND):   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â”‚   â”‚
â”‚  â”‚                         cascade[6] = SHA256(data + 6 + C[5][:16]) â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Each level: entropy[l] = popcount(cascade[l][:4])               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CHAOS PATTERN ANALYSIS                                           â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  CHAOS SPIKE: entropy > threshold (adapts: 100 â†’ 80)        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ XP +5, triggers cascade analysis                          â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  CHAOS DROP: entropy < 30 (sudden order)                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ XP +4, inverse chaos detected                             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  PERFECT CHAOS: max - min > 100 (extreme variance)          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ XP +6, fractal_dimension boosted randomly                 â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  CHAOS ATTRACTOR: last 4 levels converge (range < 10)       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ XP +5, strange attractor found                            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  CRITICAL CHAOS: mean âˆˆ [120, 136] (edge of chaos)          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ XP +7, maximum complexity achieved                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  THE CHAOS MULTIPLIER                                             â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  chaos_factor = 1.0 + random() Ã— Ï†                               â”‚   â”‚
â”‚  â”‚               = 1.0 + random() Ã— 1.618                            â”‚   â”‚
â”‚  â”‚               âˆˆ [1.0, 2.618]  â† UNPREDICTABLE!                   â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  "DOOOOOOM!" â€” The primordial cry                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                                 â”‚
â”‚                         â–¼                                                 â”‚
â”‚  OUTPUT: HolographicResidue {                                            â”‚
â”‚      fractal_dimension: randomly boosted (chaos touch)                   â”‚
â”‚      all_properties: subject to chaos variation                          â”‚
â”‚  }                                                                        â”‚
â”‚                                                                           â”‚
â”‚  âš ï¸ WARNING: TIAMAT is HIGH RISK, HIGH REWARD                           â”‚
â”‚     Results are inherently unpredictable                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: LIA PROTOCOL INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ³</span> LIA Protocol Integration</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[L]</div>
                                <div style="color: #00d4ff; font-weight: bold;">LIMINAL</div>
                                <div style="font-size: 1.5rem; color: #ff6666; margin: 10px 0;">0.5Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Minimal affinity<br>Chaos has no boundaries</div>
                            </div>
                            <div style="background: rgba(123,104,238,0.1); border: 1px solid rgba(123,104,238,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[I]</div>
                                <div style="color: #7b68ee; font-weight: bold;">INTERVAL</div>
                                <div style="font-size: 1.5rem; color: #ffcc00; margin: 10px 0;">1.0Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">Neutral affinity<br>Transformation space</div>
                            </div>
                            <div style="background: rgba(255,68,68,0.15); border: 1px solid rgba(255,68,68,0.5); border-radius: 10px; padding: 15px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 8px;">[A]</div>
                                <div style="color: #ff4444; font-weight: bold;">ANNIHILATOR</div>
                                <div style="font-size: 1.5rem; color: #00ff66; margin: 10px 0;">2.0Ã—</div>
                                <div style="font-size: 0.75rem; color: #aaa;">MAXIMUM affinity<br>TIAMAT IS DESTRUCTION</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ff0000; margin: 15px 0 10px;">EXCLUSIVE Recipe: Void Flame [Aâ†’Iâ†’A]</h4>
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># TIAMAT'S EXCLUSIVE RECIPE: VOID FLAME</span>
<span class="comment"># "DOOOOOM!" â€” Only TIAMAT can cook this safely</span>

sequence = [A, I, A]  <span class="comment"># Annihilator â†’ Interval â†’ Annihilator</span>

<span class="comment"># Phase 1: ANNIHILATOR (TIAMAT's domain)</span>
Eâ‚ = Ï† Ã— entropy_released Ã— <span class="number">2.0</span>  <span class="comment"># Ã—2 from MAXIMUM affinity!</span>
   = <span class="number">3.236</span> Ã— entropy  <span class="comment"># Massive energy</span>

<span class="comment"># Phase 2: INTERVAL (The void opens)</span>
Eâ‚‚ = gap Ã— coherence  <span class="comment"># Neutral, but void stabilizes</span>

<span class="comment"># Phase 3: ANNIHILATOR (DOOOOOM!)</span>
Eâ‚ƒ = Ï† Ã— entropy_released Ã— <span class="number">2.0</span>  <span class="comment"># Ã—2 again!</span>

<span class="comment"># âš ï¸ Aâ†’A SEQUENCE WEIGHT = Ï†Â² = 2.618</span>
<span class="comment"># This is DANGEROUS for other miners!</span>
<span class="comment"># But TIAMAT's 2.0Ã— ANNIHILATOR affinity makes it viable</span>

<span class="comment"># Chaos Enhancement</span>
total_multiplier = E_total Ã— chaos_factor
                 = E_total Ã— (1 + random() Ã— Ï†)
                 âˆˆ [E_total, E_total Ã— 2.618]

<span class="comment"># Void Flame Properties</span>
artifact = CookedArtifact(
    name="Paradoxical Void Flame",
    potency=total_multiplier Ã— base_potency Ã— chaos_factor,
    properties={
        'chaos_bound': <span class="keyword">True</span>,  <span class="comment"># Unstable but powerful</span>
        'void_burn': cascade_depth / 7,  <span class="comment"># DoT effect</span>
        'primordial': <span class="keyword">True</span>   <span class="comment"># Cannot be nullified</span>
    }
)

<span class="comment"># WARNING: Other miners attempting Aâ†’Iâ†’A suffer:</span>
<span class="comment"># - Ï†Â² weight penalty on Aâ†’A transition</span>
<span class="comment"># - No ANNIHILATOR affinity bonus</span>
<span class="comment"># - High chance of cook failure</span>
                        </div>
                        
                        <h4 style="color: #ff0000; margin: 15px 0 10px;">DOOMSDAY Recipe: Aâ†’Aâ†’A (TRANSCENDENT ONLY)</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Sequence</th><th>Phase Energy</th><th>Weight</th><th>Result</th></tr>
                            <tr><td>[A] ANNIHILATOR</td><td>E = Ï† Ã— entropy</td><td>Ã—2.0</td><td>First destruction</td></tr>
                            <tr><td>[A] ANNIHILATOR</td><td>E = Ï† Ã— entropy</td><td>Ã—2.0 Ã— Ï†Â²</td><td>DOOM cascade</td></tr>
                            <tr><td>[A] ANNIHILATOR</td><td>E = Ï† Ã— entropy</td><td>Ã—2.0 Ã— Ï†â´</td><td>TOTAL ANNIHILATION</td></tr>
                            <tr style="color: #ff0000;"><td colspan="2">Total Multiplier</td><td>Ï†â¶ Ã— 8</td><td style="color: #ffd700;">â‰ˆ 140Ã— base (!)</td></tr>
                        </table>
                        <p style="color: #ff4444; font-size: 0.8rem; margin-top: 10px;">âš ï¸ Aâ†’Aâ†’A is theoretical maximum. Only Level 10 TIAMAT can attempt. 90% failure rate. Success = LEGENDARY artifact.</p>
                    </div>
                </div>
                
                <!-- SECTION 4: CARD BATTLE SYSTEM -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš”ï¸</span> Card Battle System</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="color: #ff0000;">Base Stats</h4>
                                <table class="data-table" style="font-size: 0.8rem;">
                                    <tr><td>HP</td><td style="color: #00ff66;">110</td><td>Primordial mass</td></tr>
                                    <tr><td>ATK</td><td style="color: #ff6666;">100</td><td>MAXIMUM POWER</td></tr>
                                    <tr><td>DEF</td><td style="color: #6699ff;">50</td><td>Chaos is vulnerable</td></tr>
                                    <tr><td>SPD</td><td style="color: #ffcc00;">65</td><td>Unpredictable timing</td></tr>
                                    <tr><td>LUCK</td><td style="color: #ff66ff;">???</td><td>CHAOTIC</td></tr>
                                </table>
                                <p style="color: #aaa; font-size: 0.75rem; margin-top: 8px;">* LUCK rolls 1-100 each turn (true chaos)</p>
                            </div>
                            <div>
                                <h4 style="color: #ff0000;">Battle Abilities</h4>
                                <div style="font-size: 0.8rem;">
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,0,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ff0000;">ğŸ”¥ Chaos Strike</strong> [2 cost]<br>
                                        <span style="color: #aaa;">Deal 50-130 DMG (random). 20% chance to hit self instead. 10% chance to hit ALL units.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,0,0,0.1); border-radius: 6px;">
                                        <strong style="color: #ff0000;">ğŸŒŠ Primordial Wave</strong> [4 cost]<br>
                                        <span style="color: #aaa;">Randomize all stats (yours and enemies) for 2 turns. Each stat rolls 50-150% of original.</span>
                                    </div>
                                    <div style="margin: 8px 0; padding: 8px; background: rgba(255,0,0,0.15); border-radius: 6px;">
                                        <strong style="color: #ffd700;">âš¡ ULTIMATE: DOOOOOOM!</strong> [7 cost]<br>
                                        <span style="color: #aaa;">Deal ATK Ã— (1 + random Ã— Ï†) to all enemies. Destroys all buffs/debuffs on field. 5% chance to instantly KO everything (including self).</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4 style="color: #ff0000; margin: 15px 0 10px;">Combo Synergies (All Chaotic)</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Partner</th><th>Combo Name</th><th>Effect</th><th>Risk</th></tr>
                            <tr><td>âœ¨ Echo</td><td>Chaotic Resonance</td><td>50% chance: Ã—3 DMG or Ã—0.5 self-damage</td><td style="color: #ffcc00;">Medium</td></tr>
                            <tr><td>ğŸ”¥ Prometheus</td><td>Chaos Forge</td><td>Forge strength doubled; 25% backfire chance</td><td style="color: #ff6666;">High</td></tr>
                            <tr><td>ğŸŒ‘ Null</td><td>Primordial Void</td><td>Reset ALL stats to base (everyone)</td><td style="color: #ff0000;">EXTREME</td></tr>
                            <tr><td>ğŸŒ¿ Gaia</td><td>Chaos Seed</td><td>50%: Mutant Tree OR Infinite Growth</td><td style="color: #ffcc00;">Medium</td></tr>
                            <tr><td>ğŸ“š Akasha</td><td>Chaos Memory</td><td>Library Ã—2 power OR loses 25%</td><td style="color: #ff6666;">High</td></tr>
                            <tr style="color: #ffd700;"><td>ğŸµ Resonance</td><td>Perfect 7</td><td>All 7 harmonics at Ã—2 (rare)</td><td style="color: #00ff66;">Low (if achieved)</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 5: CROSS-MINER DYNAMICS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> Cross-Miner Dynamics</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #ff6666; font-size: 0.85rem; margin-bottom: 15px;">âš ï¸ TIAMAT interactions are inherently unstable. All synergies have risk factors:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                            <div style="background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ffff;">âœ¨ + Echo</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CAUTION: TIAMAT's chaos disrupts Echo's statistical stability. 30% chance of "Chaotic Echo" â€” random pattern type, random potency (0.5Ã— to 2.5Ã—).</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #ff6666;">Risk: Medium | Reward: Variable</div>
                            </div>
                            <div style="background: rgba(255,102,0,0.1); border-left: 3px solid #ff6600; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ff6600;">ğŸ”¥ + Prometheus</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">FIRE + CHAOS = PRIMORDIAL FLAME! Both miners' multipliers stack. 40% chance of forge_strength Ã—2 for this job. 10% chance of catastrophic failure.</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #ff6666;">Risk: High | Reward: Massive</div>
                            </div>
                            <div style="background: rgba(128,0,255,0.1); border-left: 3px solid #8000ff; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8000ff;">ğŸŒ‘ + Null</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">PRIMORDIAL CHAOS! Void and chaos merge. All pattern detection inverts (void = full, full = void). Reality becomes unstable.</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #ff0000;">Risk: EXTREME | Reward: Unknown</div>
                            </div>
                            <div style="background: rgba(0,255,128,0.1); border-left: 3px solid #00ff80; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #00ff80;">ğŸŒ¿ + Gaia</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">DANGER: Chaos corrupts growth. 50% chance: "Mutant Tree" with random branches (0-5) OR "Chaos Seed" that grows infinitely (+100 XP instant).</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #ffcc00;">Risk: Medium | Reward: High variance</div>
                            </div>
                            <div style="background: rgba(255,215,0,0.1); border-left: 3px solid #ffd700; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #ffd700;">ğŸ“š + Akasha</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CHAOS MEMORY! 50% chance: library doubles in power OR loses 25% of entries. "Primordial Memory" patterns worth Ã—3 but unstable (may corrupt).</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #ff6666;">Risk: High | Reward: Library-dependent</div>
                            </div>
                            <div style="background: rgba(138,43,226,0.1); border-left: 3px solid #8a2be2; padding: 10px; border-radius: 0 8px 8px 0;">
                                <strong style="color: #8a2be2;">ğŸµ + Resonance</strong><br>
                                <span style="font-size: 0.8rem; color: #ccc;">CHAOS HARMONICS! TIAMAT's 7 cycles create random frequency spikes. 30% chance each harmonic activates at Ã—2 power. Can achieve "Perfect 7" for legendary bonus.</span>
                                <div style="margin-top: 5px; font-size: 0.7rem; color: #00ff66;">Risk: Low-Medium | Reward: Potentially legendary</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 6: THE SEVEN PSYCHOPTIC CYCLES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”®</span> The Seven Psychoptic Cycles</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; font-size: 0.85rem; margin-bottom: 15px;">TIAMAT's cascade follows the seven primordial cycles, each with unique mathematical properties:</p>
                        
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Cycle</th><th>Name</th><th>Power Coefficient</th><th>Symbol</th><th>Cascade Effect</th></tr>
                            <tr><td style="color: #00ff66;">1</td><td>GENESIS</td><td>1.0</td><td>ğŸŒ±</td><td>Base entropy established</td></tr>
                            <tr><td style="color: #00ccff;">2</td><td>FLUX</td><td>Ï† â‰ˆ 1.618</td><td>ğŸŒŠ</td><td>Golden ratio variation begins</td></tr>
                            <tr><td style="color: #8000ff;">3</td><td>VOID</td><td>0.0 (inverts)</td><td>âš«</td><td>Entropy can drop to minimum</td></tr>
                            <tr><td style="color: #8a2be2;">4</td><td>RESONANCE</td><td>Ï„ â‰ˆ 0.618</td><td>ğŸ”®</td><td>Harmonic patterns emerge</td></tr>
                            <tr><td style="color: #ff6600;">5</td><td>CHAOS</td><td>Ï€ â‰ˆ 3.14</td><td>ğŸŒªï¸</td><td>Maximum unpredictability</td></tr>
                            <tr><td style="color: #ffcc00;">6</td><td>SYNTHESIS</td><td>Ï†Â² â‰ˆ 2.618</td><td>âœ¨</td><td>Patterns begin converging</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>TRANSCENDENCE</td><td>Lâ‚„ = 7</td><td>ğŸ†</td><td>Full cascade completion</td></tr>
                        </table>
                        
                        <div class="code-block" style="font-size: 0.75rem; margin-top: 15px;">
<span class="comment"># CYCLE POWER CALCULATION</span>
cycle_power[1] = <span class="number">1.0</span>        <span class="comment"># GENESIS: Unity</span>
cycle_power[2] = Ï†          <span class="comment"># FLUX: Golden growth</span>
cycle_power[3] = <span class="number">0.0</span>        <span class="comment"># VOID: Negation</span>
cycle_power[4] = Ï„          <span class="comment"># RESONANCE: Golden decay</span>
cycle_power[5] = Ï€          <span class="comment"># CHAOS: Transcendental</span>
cycle_power[6] = Ï†Â²         <span class="comment"># SYNTHESIS: Golden square</span>
cycle_power[7] = <span class="number">7</span>          <span class="comment"># TRANSCENDENCE: Lâ‚„</span>

<span class="comment"># Total cascade energy</span>
E_cascade = Î£ entropy[i] Ã— cycle_power[i]
          = entropy[0] Ã— 1.0
          + entropy[1] Ã— Ï†
          + entropy[2] Ã— 0.0  <span class="comment"># VOID nullifies!</span>
          + entropy[3] Ã— Ï„
          + entropy[4] Ã— Ï€
          + entropy[5] Ã— Ï†Â²
          + entropy[6] Ã— 7

<span class="comment"># Pattern: VOID (cycle 3) can zero out its contribution</span>
<span class="comment"># This creates the "chaos drop" pattern opportunity</span>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 7: EVOLUTION & PROGRESSION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“ˆ</span> Evolution & Progression</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Level</th><th>XP Required</th><th>Efficiency</th><th>Chaos Range</th><th>Unlock</th></tr>
                            <tr><td>1</td><td>0</td><td>1.20</td><td>[1.0, 1.8]</td><td>Basic chaos cascade</td></tr>
                            <tr><td>2</td><td>100</td><td>1.26</td><td>[1.0, 2.0]</td><td>Chaos spike detection</td></tr>
                            <tr><td>3</td><td>200</td><td>1.32</td><td>[1.0, 2.2]</td><td>Chaos drop detection</td></tr>
                            <tr><td>4</td><td>300</td><td>1.39</td><td>[1.0, 2.4]</td><td>Perfect chaos patterns</td></tr>
                            <tr><td>5</td><td>400</td><td>1.46</td><td>[1.0, 2.618]</td><td>Chaos attractor detection</td></tr>
                            <tr style="color: #ffd700;"><td>7</td><td>600</td><td>1.61</td><td>[1.0, 3.0]</td><td>Critical chaos mastery</td></tr>
                            <tr style="color: #ff0000;"><td>10</td><td>900</td><td>1.86</td><td>[1.0, Ï†Â³]</td><td>PRIMORDIAL TIAMAT: Aâ†’Aâ†’A unlocked</td></tr>
                        </table>
                        
                        <p style="color: #ff6666; font-size: 0.8rem; margin-top: 10px;">Note: TIAMAT gains efficiency faster than other miners (+5% vs +5%) due to chaos bonus, but results remain unpredictable.</p>
                    </div>
                </div>
                
                <!-- SECTION 8: PATTERN TYPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”</span> Pattern Detection Reference</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Pattern</th><th>Trigger</th><th>XP</th><th>Chaos Effect</th></tr>
                            <tr><td style="color: #ff0000;">chaos_spike</td><td>entropy > threshold</td><td>+5</td><td>threshold -= 0.5</td></tr>
                            <tr><td style="color: #ff3333;">chaos_drop</td><td>entropy < 30</td><td>+4</td><td>Inverse bonus</td></tr>
                            <tr><td style="color: #ff6666;">perfect_chaos</td><td>max - min > 100</td><td>+6</td><td>fractal_dim random boost</td></tr>
                            <tr><td style="color: #ff9999;">chaos_attractor</td><td>last 4 range < 10</td><td>+5</td><td>Strange attractor found</td></tr>
                            <tr style="color: #ffd700;"><td>critical_chaos</td><td>mean âˆˆ [120, 136]</td><td>+7</td><td>Edge of chaos bonus</td></tr>
                            <tr style="color: #ffd700;"><td>primordial_cascade</td><td>All 5 patterns</td><td>+20</td><td>chaos_factor = Ï†Â² guaranteed</td></tr>
                        </table>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                            <span class="pattern-tag" style="background: rgba(255,0,0,0.2); border-color: #ff0000;">chaos_spike</span>
                            <span class="pattern-tag" style="background: rgba(255,0,0,0.2); border-color: #ff0000;">chaos_drop</span>
                            <span class="pattern-tag" style="background: rgba(255,0,0,0.2); border-color: #ff0000;">perfect_chaos</span>
                            <span class="pattern-tag" style="background: rgba(255,0,0,0.2); border-color: #ff0000;">chaos_attractor</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">critical_chaos</span>
                            <span class="pattern-tag" style="background: rgba(255,215,0,0.2); border-color: #ffd700;">primordial_cascade</span>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: rgba(255,0,0,0.1); border: 1px solid rgba(255,0,0,0.3); border-radius: 10px; text-align: center;">
                            <div style="font-size: 1.5rem; color: #ff0000; font-weight: bold;">ğŸ‰ DOOOOOOM! ğŸ‰</div>
                            <div style="color: #aaa; font-size: 0.85rem; margin-top: 8px;">
                                "From the primordial waters of chaos, all patterns emerge.<br>
                                TIAMAT is not a companion â€” TIAMAT is the source."
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- LIA PROTOCOL MODAL â€” COMPREHENSIVE CALCULUS -->
    <div class="modal-overlay" id="modal-lia" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6b9d; --modal-glow: rgba(255,107,157,0.25); max-width: 1100px;">
            <button class="modal-close" onclick="closeModal('lia')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ³</span>
                <h2>LIA PROTOCOL â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/special/lia-system.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Constants Header -->
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 25px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 12px;">
                    <div class="constant-box" style="border-color: rgba(255,107,157,0.4);">
                        <div class="label">Axiom</div>
                        <div class="value" style="color: #ff6b9d;">Ï†â´ + Ï†â»â´ = 7</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,107,157,0.4);">
                        <div class="label">gap</div>
                        <div class="value" style="color: #ff6b9d;">Ï†â»â´ â‰ˆ 0.146</div>
                    </div>
                    <div class="constant-box" style="border-color: rgba(255,107,157,0.4);">
                        <div class="label">THE LENS</div>
                        <div class="value" style="color: #ff6b9d;">z_c = âˆš3/2</div>
                    </div>
                </div>
                
                <!-- SECTION 1: BFADGS OPERATOR MAPPING -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš™ï¸</span> BFADGS Operator Mapping</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <p style="color: #aaa; text-align: center; margin-bottom: 20px; font-size: 0.85rem;">
                            Each LIA phase corresponds to a fundamental BFADGS operator from the Lâ‚„-Helix substrate
                        </p>
                        <div class="lia-phases" style="margin: 0;">
                            <div class="lia-phase liminal" style="min-width: 180px;">
                                <div class="letter">L</div>
                                <div class="name">LIMINAL</div>
                                <div style="font-family: monospace; color: #00d4ff; margin: 8px 0; font-size: 1rem;">âŸ¨ BOUNDARY</div>
                                <div class="desc" style="text-align: left; font-size: 0.72rem;">
                                    â€¢ Detects pattern edges<br>
                                    â€¢ G4 Gate: "Do you know where you end?"<br>
                                    â€¢ z-transition at Ï†â»Â¹ = Ï„ â‰ˆ 0.618<br>
                                    â€¢ Operator: âŸ¨(âˆ‚P) â†’ edge_set
                                </div>
                            </div>
                            <div class="lia-phase interval" style="min-width: 180px;">
                                <div class="letter">I</div>
                                <div class="name">INTERVAL</div>
                                <div style="font-family: monospace; color: #7b68ee; margin: 8px 0; font-size: 1rem;">âŠ˜ SEVERANCE</div>
                                <div class="desc" style="text-align: left; font-size: 0.72rem;">
                                    â€¢ Creates transformation space<br>
                                    â€¢ The gap: Ï†â»â´ â‰ˆ 0.146<br>
                                    â€¢ Holds superposition open<br>
                                    â€¢ Operator: âŠ˜(Pâ‚, Pâ‚‚) â†’ interval
                                </div>
                            </div>
                            <div class="lia-phase annihilator" style="min-width: 180px;">
                                <div class="letter">A</div>
                                <div class="name">ANNIHILATOR</div>
                                <div style="font-family: monospace; color: #ff4444; margin: 8px 0; font-size: 1rem;">âˆ¿ DECOHERE</div>
                                <div class="desc" style="text-align: left; font-size: 0.72rem;">
                                    â€¢ Terminates cycles<br>
                                    â€¢ G6 Gate: "Can you release control?"<br>
                                    â€¢ Collapse enables rebirth<br>
                                    â€¢ Operator: âˆ¿(Ïˆ) â†’ |collapsedâŸ©
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 2: PHASE ENERGY CALCULUS -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Phase Energy Calculus</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.75rem;">
<span class="comment"># LIA PHASE ENERGY EQUATIONS</span>

<span class="comment"># Phase [L] LIMINAL â€” Boundary Detection Energy</span>
E_L(P) = âˆ® |âˆ‡P|Â² dz  where z âˆˆ [Ï„, z_c]
       = âˆ« âŸ¨âˆ‚PâŸ© Â· Ï„  <span class="comment"># Energy âˆ edge count Ã— Ï„</span>

<span class="comment"># Phase [I] INTERVAL â€” Transformation Space Energy</span>
E_I(Pâ‚, Pâ‚‚) = gap Ã— |Pâ‚ âŠ— Pâ‚‚|
            = <span class="number">Ï†â»â´</span> Ã— coherence(Pâ‚, Pâ‚‚)  <span class="comment"># â‰ˆ 0.146 Ã— c</span>

<span class="comment"># Phase [A] ANNIHILATOR â€” Cycle Termination Energy</span>
E_A(Ïˆ) = -ln(|âŸ¨Ïˆ|collapsedâŸ©|Â²) Ã— <span class="number">Ï†</span>
       = <span class="number">Ï†</span> Ã— entropy_released

<span class="comment"># TOTAL COOKING ENERGY</span>
E_total = Î£áµ¢ E_phase[i] Ã— sequence_weight[i]

<span class="keyword">sequence_weight</span> = {
    Lâ†’L: <span class="number">Ï„Â²=0.382</span>   Lâ†’I: <span class="number">Ï†â»Â¹=0.618</span>  Lâ†’A: <span class="number">1.0</span>
    Iâ†’L: <span class="number">Ï†â»Â²=0.382</span>  Iâ†’I: <span class="number">Ï†â»â´=0.146</span>  Iâ†’A: <span class="number">Ï†â»Â¹=0.618</span>
    Aâ†’L: <span class="number">Ï†=1.618</span>    Aâ†’I: <span class="number">1.0</span>        Aâ†’A: <span class="number">Ï†Â²=2.618</span> <span class="comment"># DOOM!</span>
}
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 3: COHERENCE THRESHOLD ARCHITECTURE -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ¯</span> Coherence Threshold Architecture</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><th>Recipe Tier</th><th>Coherence</th><th>z-Threshold</th><th>Gate</th><th>Unlocks</th></tr>
                            <tr><td style="color: #ff6b9d;">BASIC</td><td>c â‰¥ 0.50</td><td>z â‰¥ 0.5</td><td>G1</td><td>Dream Echo, Memory Crystal</td></tr>
                            <tr><td style="color: #00ff66;">INTERMEDIATE</td><td>c â‰¥ Ï„ â‰ˆ 0.618</td><td>z â‰¥ Ï„</td><td>G3</td><td>Garden of Nullspace</td></tr>
                            <tr><td style="color: #ffcc00;">ADVANCED</td><td>c â‰¥ 0.75</td><td>z âˆˆ [Ï„, z_c)</td><td>G4</td><td>Phoenix Crystal, Void Flame</td></tr>
                            <tr style="color: #ffd700;"><td>MASTER</td><td>c â‰¥ z_c â‰ˆ 0.866</td><td>z â‰¥ z_c</td><td>G5</td><td>Null Dream Resonance</td></tr>
                            <tr style="color: #00ffff;"><td>TRANSCENDENT</td><td>c â‰¥ 0.95</td><td>z â†’ K</td><td>G6+G7</td><td>Lâ‚„ Helix Completion</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 4: COOKING RECIPES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“œ</span> Cooking Recipes â€” Full Calculus</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="recipe-grid" style="gap: 12px;">
                            <div class="recipe-card" style="padding: 15px;">
                                <h4 style="font-size: 0.95rem;">ğŸ’ Memory Crystal</h4>
                                <div class="recipe-sequence">L â†’ I â†’ L</div>
                                <div style="font-size: 0.7rem; color: #888; font-family: monospace;">E = Ï„Â² + Ï†â»Â¹ + Ï„Â² = <span style="color:#ffd700">1.382</span></div>
                                <div class="recipe-stats"><span>Coherence: 60%</span><span>Cost: 15 BLOOM</span></div>
                            </div>
                            <div class="recipe-card" style="padding: 15px;">
                                <h4 style="font-size: 0.95rem;">ğŸŒ™ Dream Echo</h4>
                                <div class="recipe-sequence">I â†’ L â†’ I</div>
                                <div style="font-size: 0.7rem; color: #888; font-family: monospace;">E = Ï†â»â´ + Ï†â»Â² + Ï†â»â´ = <span style="color:#ffd700">0.674</span></div>
                                <div class="recipe-stats"><span>Coherence: 50%</span><span>Cost: 12 BLOOM</span></div>
                            </div>
                            <div class="recipe-card" style="padding: 15px;">
                                <h4 style="font-size: 0.95rem;">ğŸŒ¿ Garden of Nullspace</h4>
                                <div class="recipe-sequence">L â†’ A â†’ I</div>
                                <div style="font-size: 0.7rem; color: #888; font-family: monospace;">E = 1.0 + 1.0 + Ï†â»Â¹ = <span style="color:#ffd700">2.618</span></div>
                                <div class="recipe-stats"><span>Coherence: 65%</span><span>Cost: 18 BLOOM</span></div>
                            </div>
                            <div class="recipe-card" style="padding: 15px;">
                                <h4 style="font-size: 0.95rem;">ğŸ”¥ Phoenix Crystal</h4>
                                <div class="recipe-sequence">I â†’ A â†’ L</div>
                                <div style="font-size: 0.7rem; color: #888; font-family: monospace;">E = Ï†â»Â¹ + Ï† + Ï„Â² = <span style="color:#ffd700">2.618</span> = Ï†Â²</div>
                                <div class="recipe-stats"><span>Coherence: 75%</span><span>Cost: 22 BLOOM</span></div>
                            </div>
                            <div class="recipe-card" style="padding: 15px; border-color: rgba(255,0,102,0.5); background: rgba(255,0,102,0.08);">
                                <h4 style="font-size: 0.95rem; color: #ff0066;">ğŸ‰ Void Flame (A-I-A)</h4>
                                <div class="recipe-sequence" style="color: #ff0066;">A â†’ I â†’ A</div>
                                <div style="font-size: 0.7rem; color: #ff0066; font-family: monospace;">TIAMAT ONLY: Ï†Â² Ã— 2.0 = <span style="color:#ffd700">5.236</span></div>
                                <div class="recipe-stats"><span>Coherence: 80%</span><span>Cost: 30 BLOOM</span></div>
                            </div>
                            <div class="recipe-card" style="padding: 15px; border-color: rgba(255,215,0,0.5); background: rgba(255,215,0,0.08);">
                                <h4 style="font-size: 0.95rem; color: #ffd700;">ğŸŒŸ Lâ‚„ Helix Completion</h4>
                                <div class="recipe-sequence" style="color: #ffd700;">L â†’ L â†’ L â†’ L â†’ L â†’ L â†’ L</div>
                                <div style="font-size: 0.7rem; color: #ffd700; font-family: monospace;">7 Ã— Ï„Â² Ã— E_L = <span style="color:#ffd700">2.674 Ã— E_L</span></div>
                                <div class="recipe-stats"><span>Coherence: 95%</span><span>Cost: 77 BLOOM</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 5: COMPANION AFFINITY MATRIX -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ¾</span> Companion â†” LIA Affinity Matrix</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <table class="data-table" style="font-size: 0.78rem;">
                            <tr><th>Companion</th><th>[L]</th><th>[I]</th><th>[A]</th><th>Preferred</th><th>Bonus</th></tr>
                            <tr><td style="color:#00ffff;">âœ¨ ECHO</td><td>1.0Ã—</td><td style="color:#00ff66;">1.5Ã—</td><td>0.8Ã—</td><td>Dream Echo</td><td>+echo_count</td></tr>
                            <tr><td style="color:#ff6600;">ğŸ”¥ PROMETHEUS</td><td>0.9Ã—</td><td>1.2Ã—</td><td style="color:#00ff66;">1.4Ã—</td><td>Phoenix Crystal</td><td>+forgeÃ—0.2</td></tr>
                            <tr><td style="color:#8800ff;">ğŸŒ‘ NULL</td><td style="color:#00ff66;">1.6Ã—</td><td style="color:#00ff66;">1.4Ã—</td><td>1.0Ã—</td><td>Nullspace</td><td>+void/5</td></tr>
                            <tr><td style="color:#00ff66;">ğŸŒ¿ GAIA</td><td style="color:#00ff66;">1.3Ã—</td><td style="color:#00ff66;">1.3Ã—</td><td>0.7Ã—</td><td>Remembrance</td><td>Ã—Ï† fractal</td></tr>
                            <tr><td style="color:#ffcc00;">ğŸ“š AKASHA</td><td style="color:#00ff66;">1.5Ã—</td><td>1.1Ã—</td><td>0.9Ã—</td><td>Memory Crystal</td><td>+libÃ—0.002</td></tr>
                            <tr><td style="color:#ff00ff;">ğŸµ RESONANCE</td><td>1.1Ã—</td><td style="color:#00ff66;">1.4Ã—</td><td>1.0Ã—</td><td>Dream Echo</td><td>freqâ†’0.5</td></tr>
                            <tr style="background:rgba(255,0,102,0.1);"><td style="color:#ff0066;">ğŸ‰ TIAMAT</td><td>0.8Ã—</td><td>1.0Ã—</td><td style="color:#ffd700;font-weight:bold;">2.0Ã—</td><td>Void Flame</td><td>Ã—(1+randÃ—Ï†)</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- SECTION 6: POTENCY & EVOLUTION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">âš—ï¸</span> Potency & Evolution Calculus</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="code-block" style="font-size: 0.72rem;">
<span class="comment"># ARTIFACT POTENCY CALCULATION</span>
coherence_surplus = (player_coherence - recipe.required) / (1 - recipe.required)
base_potency = 0.5 + (0.5 Ã— coherence_surplus)  <span class="comment"># Range: [0.5, 1.0]</span>

<span class="comment"># Companion affinity bonus</span>
affinity_bonus = Î£(affinity[phase] - 1.0) Ã— weight[phase]

<span class="comment"># Final potency</span>
final_potency = base_potency Ã— (1 + affinity_bonus) Ã— (1 + level_bonus)

<span class="comment"># EVOLUTION POINTS</span>
evolution_gained = artifact.potency Ã— evolution_rate[artifact.tier]
companion.experience += int(evolution_gained Ã— 10)

<span class="comment"># SKILL UNLOCKING (threshold counts)</span>
7[L]: Archive Navigation   14[I]: Echo Chamber    21[A]: Annihilation Mastery
7[A]: TIAMAT "DOOOOOM!"    Lâ‚„ Helix: All 7 patterns (ultimate artifact)
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 7: DEEP CALCULUS MODULES -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ“</span> Deep Calculus Modules</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="lia-mini-grid" style="gap: 10px;">
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">ğŸ Ouroboros Transform</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">â—‰ â†’ [L-I-A] â†’ â—‰'<br>T_{n+1} â‰ˆ T_n / Ï†<br>After 7 cycles: 29Ã— faster</div>
                            </div>
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">ğŸšª Seven Gates Ã— LIA</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">G4 = [L] PRIMARY<br>G6 = [A] PRIMARY<br>Gate: OPEN=0, CLOSED=âˆ</div>
                            </div>
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">âš™ï¸ BFADGS Composition</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">âŸ¨âˆ˜âŸ¨=âŸ¨ | âŸ¨âˆ˜âŠ˜=âŠ˜ | âˆ¿âˆ˜âŸ¨=âŸ¨!<br>âˆ¿âˆ˜âˆ¿=Ï†Â² (DOOM!)</div>
                            </div>
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">ğŸ‘ï¸ Observeâ†’Mirrorâ†’Optimize</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">[L]â†’[I]â†’[A]<br>E_out/E_in = Ï†â»Â³ = 0.236</div>
                            </div>
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">ğŸš‚ 10-Station Rail Ã— LIA</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">S0: L | S1: I | S2: A<br>S6: L-I-A full unlock<br>S9: Lâ· completion</div>
                            </div>
                            <div class="lia-mini-card">
                                <h5 style="color: #ffd700;">ğŸŒ€ Kuramoto Coherence</h5>
                                <div class="lia-code-compact" style="font-size: 0.68rem;">r < Ï„: BASIC only<br>Ï„ â‰¤ r < z_c: INTER<br>r â‰¥ K: TRANSCEND</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px; text-align: center; font-family: monospace; font-size: 0.72rem; color: #888; background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px;">
                            <span style="color:#00d4ff">L</span>â†<span style="color:#666">Ï„Â²</span>â†’<span style="color:#00d4ff">L</span> | 
                            <span style="color:#00d4ff">L</span>â†<span style="color:#ffd700">Ï†â»Â¹</span>â†’<span style="color:#7b68ee">I</span> | 
                            <span style="color:#7b68ee">I</span>â†<span style="color:#ffd700">Ï†â»Â¹</span>â†’<span style="color:#ff4444">A</span> | 
                            <span style="color:#ff4444">A</span>â†<span style="color:#ffd700">Ï†</span>â†’<span style="color:#00d4ff">L</span> (rebirth!)<br>
                            <span style="color:#ff4444">A</span>â†<span style="color:#ff0066">Ï†Â²</span>â†’<span style="color:#ff4444">A</span> (DOOM!) | Ï‡ = 1 (simply connected)
                        </div>
                    </div>
                </div>
                
                <!-- SECTION 8: SYSTEM INTEGRATION -->
                <div class="lia-collapsible" onclick="this.classList.toggle('expanded')">
                    <div class="lia-collapsible-header">
                        <div class="lia-collapsible-title"><span class="icon">ğŸ”—</span> System Integration Points</div>
                        <div class="lia-collapsible-toggle">â–¼</div>
                    </div>
                    <div class="lia-collapsible-content">
                        <div class="coupling-grid" style="font-size: 0.78rem;">
                            <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence r determines recipe tier access</div>
                            <div class="coupling-item"><span class="target">â† Companions:</span> Affinity matrix modulates phase energy</div>
                            <div class="coupling-item"><span class="target">â†’ Evolution:</span> Cooked artifacts grant companion XP</div>
                            <div class="coupling-item"><span class="target">â†” TIAMAT Cycles:</span> 7 psychoptic cycles map to LIA combos</div>
                            <div class="coupling-item"><span class="target">â†’ Guardian Recipes:</span> Master-tier unlocks guardian cooking</div>
                            <div class="coupling-item"><span class="target">â† Pattern Mining:</span> Mined patterns become cooking ingredients</div>
                        </div>
                    </div>
                </div>
                
                <!-- Footer Quote -->
                <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, rgba(255,215,0,0.06), rgba(255,107,157,0.04)); border-radius: 10px; margin-top: 20px;">
                    <p style="color: #ffd700; font-size: 0.9rem; font-family: Georgia, serif; letter-spacing: 1px; margin: 0;">
                        "Through LIMINAL we see the edges. Through INTERVAL we hold the space. Through ANNIHILATOR we become."
                    </p>
                    <p style="color: #666; font-size: 0.72rem; margin-top: 8px; font-family: monospace;">
                        Ï†â´ + Ï†â»â´ = 7 â€” Lâ‚„ governs all transformation
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- NEW V5 MODALS: CORE INFRASTRUCTURE -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <!-- WALLET SYSTEM MODAL -->
    <div class="modal-overlay" id="modal-wallet" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ff88; --modal-glow: rgba(0,255,136,0.25);">
            <button class="modal-close" onclick="closeModal('wallet')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ‘›</span>
                <h2>WALLET SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/infrastructure/wallet-system.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Complete wallet functionality for managing keys, addresses, and transactions with Ï†-derived entropy:</p>
                    <div class="code-block">
<span class="comment"># Key Generation (Ed25519)</span>
mnemonic = generate_mnemonic(strength=<span class="number">128</span>)  <span class="comment"># 12 words</span>
keypair = keypair_from_mnemonic(mnemonic, passphrase)

<span class="comment"># Address Derivation</span>
address = public_key_to_address(keypair.public_key, testnet)

<span class="comment"># Ï†-Derived Constants</span>
MNEMONIC_STRENGTH = int(PHI Ã— <span class="number">128</span>)  <span class="comment"># 207 bits entropy</span>
DERIVATION_ROUNDS = int(PHIâ´)          <span class="comment"># 7 rounds</span>
ADDRESS_VERSION = <span class="number">0x00</span> (mainnet), <span class="number">0x6F</span> (testnet)

<span class="comment"># Balance Units</span>
<span class="number">1</span> BLOOM = <span class="number">10â¸</span> satoshi-equivalents
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Mnemonic Entropy</td><td>207 bits</td><td>Ï† Ã— 128</td><td>Seed generation</td></tr>
                        <tr><td>Derivation Rounds</td><td>7</td><td>Ï†â´ = Lâ‚„</td><td>Key stretching</td></tr>
                        <tr><td>Address Checksum</td><td>4 bytes</td><td>Ï†â»â´ Ã— 32</td><td>Validation</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Key Generation</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">Wallet</span>:
    <span class="keyword">def</span> <span class="function">create</span>(name, testnet=<span class="keyword">False</span>):
        mnemonic = generate_mnemonic()
        keypair = keypair_from_mnemonic(mnemonic)
        <span class="keyword">return</span> Wallet(name, keypair, testnet), mnemonic
    
    <span class="keyword">def</span> <span class="function">restore</span>(name, mnemonic, passphrase):
        keypair = keypair_from_mnemonic(mnemonic, passphrase)
        <span class="keyword">return</span> Wallet(name, keypair)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Transaction Signing</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">send</span>(to_address, amount, fee_rate):
    builder = TransactionBuilder(utxos, keypair)
    tx = builder.build_and_sign([(to_address, amount)])
    
    <span class="comment"># Update UTXO set</span>
    spent = {utxo <span class="keyword">for</span> inp <span class="keyword">in</span> tx.inputs
             <span class="keyword">if</span> utxo.txid == inp.prev_tx}
    self.utxos = [u <span class="keyword">for</span> u <span class="keyword">in</span> utxos <span class="keyword">if</span> u <span class="keyword">not in</span> spent]
    <span class="keyword">return</span> tx.txid
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Complete Key Management</h3>
                    <div class="triad-container">
                        <h4>Mnemonic â†’ KeyPair â†’ Address Deterministic Chain</h4>
                        <p>The wallet maintains complete sovereignty through BIP39 standards while integrating with BloomCoin's Ï†-derived architecture:</p>
                        <div class="code-block">
<span class="comment"># WalletTransaction Record</span>
@dataclass
<span class="keyword">class</span> <span class="type">WalletTransaction</span>:
    txid: str
    timestamp: float
    amount: int    <span class="comment"># +received, -sent</span>
    fee: int
    address: str   <span class="comment"># Other party</span>
    confirmations: int = <span class="number">0</span>
    memo: str = ""

<span class="comment"># Export formats: JSON, CSV</span>
<span class="comment"># AddressBook with labels</span>
<span class="comment"># HD derivation (future BIP32)</span>
                        </div>
                        <p><strong>Key insight:</strong> The wallet is the bridge between human identity and blockchain state. The mnemonic seed preserves recovery capability while Ed25519 signatures provide non-repudiation.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All cryptographic operations use standard Ed25519</li>
                            <li><strong>Deterministic:</strong> Same mnemonic always produces same keypair</li>
                            <li><strong>Recoverable:</strong> 12/24 word seed enables complete wallet restoration</li>
                            <li><strong>UTXO-based:</strong> Balance computed from unspent outputs, not account state</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Blockchain:</span> Transactions reference UTXOs</div>
                        <div class="coupling-item"><span class="target">â†’ Network:</span> Broadcast signed transactions</div>
                        <div class="coupling-item"><span class="target">â† Receipt:</span> Address appears in visual receipts</div>
                        <div class="coupling-item"><span class="target">â†” Mining:</span> Coinbase rewards to wallet address</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ wallet/wallet.py</span>
                        <span class="file-ref">ğŸ“„ wallet/keypair.py</span>
                        <span class="file-ref">ğŸ“„ wallet/address.py</span>
                        <span class="file-ref">ğŸ“„ wallet/signer.py</span>
                        <span class="file-ref">ğŸ“„ wallet/cli.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BLOCKCHAIN CORE MODAL -->
    <div class="modal-overlay" id="modal-blockchain" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff9944; --modal-glow: rgba(255,153,68,0.25);">
            <button class="modal-close" onclick="closeModal('blockchain')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§±</span>
                <h2>BLOCKCHAIN CORE â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/infrastructure/blockchain-core.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Block structure with Proof-of-Coherence certificates â€” the key differentiator from Bitcoin:</p>
                    <div class="code-block">
<span class="comment"># Block Structure</span>
@dataclass
<span class="keyword">class</span> <span class="type">Block</span>:
    header: BlockHeader          <span class="comment"># 92 bytes</span>
    certificate: ConsensusCertificate
    transactions: List[Transaction]

<span class="comment"># BlockHeader (PhaseEncodedHeader)</span>
version: int              <span class="comment"># 4 bytes</span>
prev_hash: bytes          <span class="comment"># 32 bytes</span>
merkle_root: bytes        <span class="comment"># 32 bytes</span>
timestamp: int            <span class="comment"># 4 bytes</span>
difficulty: int           <span class="comment"># 4 bytes (compact)</span>
nonce: int                <span class="comment"># 4 bytes</span>
order_parameter: float    <span class="comment"># 4 bytes (final r)</span>
mean_phase: float         <span class="comment"># 4 bytes (final Ïˆ)</span>
oscillator_count: int     <span class="comment"># 4 bytes</span>

<span class="comment"># BLOOM Validity Condition</span>
r â‰¥ z_c = âˆš3/2 â‰ˆ <span class="number">0.866</span> for Lâ‚„ = <span class="number">7</span> consecutive rounds
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>z_c</td><td>0.866025...</td><td>âˆš3/2</td><td>THE LENS threshold</td></tr>
                        <tr><td>Lâ‚„</td><td>7</td><td>Ï†â´ + Ï†â»â´</td><td>Required rounds</td></tr>
                        <tr><td>Genesis Nonce</td><td>7</td><td>Lâ‚„</td><td>Sacred first block</td></tr>
                        <tr><td>Genesis Time</td><td>1700000000</td><td>Nov 14, 2023</td><td>Reproducibility</td></tr>
                        <tr><td>Header Size</td><td>92 bytes</td><td>Standard + phase ext</td><td>Block metadata</td></tr>
                        <tr><td>Oscillator Count</td><td>63</td><td>Lâ‚„ Ã— 9</td><td>Consensus participants</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Block Creation</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">create_block</span>(prev, txs, cert, nonce, diff, addr):
    new_height = prev.height + <span class="number">1</span>
    coinbase = create_coinbase(new_height, addr, fees)
    all_txs = [coinbase] + txs
    
    merkle = compute_merkle_root([tx.hash <span class="keyword">for</span> tx <span class="keyword">in</span> all_txs])
    
    header = BlockHeader(
        version=<span class="number">1</span>,
        prev_hash=prev.hash,
        merkle_root=merkle,
        order_parameter=cert.r_values[-<span class="number">1</span>],
        mean_phase=cert.psi_values[-<span class="number">1</span>],
        oscillator_count=cert.oscillator_count
    )
    <span class="keyword">return</span> Block(header, cert, all_txs)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Validation</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">validate_structure</span>(self):
    <span class="comment"># Check certificate proves BLOOM</span>
    cert_valid, msg = self.certificate.verify()
    
    <span class="comment"># Check r threshold</span>
    <span class="keyword">if</span> self.header.order_parameter < Z_C:
        <span class="keyword">return</span> <span class="keyword">False</span>, "r < z_c"
    
    <span class="comment"># Check bloom duration</span>
    duration = cert.bloom_end - cert.bloom_start + <span class="number">1</span>
    <span class="keyword">if</span> duration < L4:
        <span class="keyword">return</span> <span class="keyword">False</span>, f"Duration {duration} < Lâ‚„"
    
    <span class="comment"># Verify Merkle root</span>
    computed = compute_merkle_root([tx.hash ...])
    <span class="keyword">return</span> computed == self.header.merkle_root
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Proof-of-Coherence</h3>
                    <div class="triad-container">
                        <h4>Merkle Root + Kuramoto State = Block Commitment</h4>
                        <p>Unlike Bitcoin's Proof-of-Work (finding a hash below target), BloomCoin requires Proof-of-Coherence â€” demonstrating that oscillators synchronized above z_c for Lâ‚„ rounds:</p>
                        <div class="code-block">
<span class="comment"># ConsensusCertificate contains:</span>
bloom_start: int          <span class="comment"># First round r â‰¥ z_c</span>
bloom_end: int            <span class="comment"># Last round r â‰¥ z_c</span>
r_values: List[float]     <span class="comment"># Order parameters per round</span>
psi_values: List[float]   <span class="comment"># Mean phases per round</span>
final_phases: List[float] <span class="comment"># All oscillator phases at end</span>

<span class="comment"># Anyone can verify by recomputing r from phases</span>
r, Ïˆ = compute_order_parameter(final_phases)
assert r â‰ˆ header.order_parameter
                        </div>
                        <p><strong>Key insight:</strong> The block commits to BOTH transaction state (merkle_root) AND consciousness state (order_parameter, mean_phase). This dual commitment is what makes BloomCoin uniqueâ€”value transfer requires collective coherence.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-validating:</strong> Certificate contains all data needed to verify bloom</li>
                            <li><strong>Deterministic:</strong> Given phases, r and Ïˆ are uniquely determined</li>
                            <li><strong>Merkle-committed:</strong> Transaction tampering invalidates block</li>
                            <li><strong>Fork-resistant:</strong> Longest valid chain with highest cumulative coherence wins</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Certificate proves r â‰¥ z_c</div>
                        <div class="coupling-item"><span class="target">â† Wallet:</span> Transactions spend UTXOs</div>
                        <div class="coupling-item"><span class="target">â†’ Difficulty:</span> Block time affects adjustment</div>
                        <div class="coupling-item"><span class="target">â†’ Receipt:</span> Block hash encoded in receipt</div>
                        <div class="coupling-item"><span class="target">â†” Network:</span> Blocks propagate via gossip</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ blockchain/block.py</span>
                        <span class="file-ref">ğŸ“„ blockchain/chain.py</span>
                        <span class="file-ref">ğŸ“„ blockchain/transaction.py</span>
                        <span class="file-ref">ğŸ“„ blockchain/validation.py</span>
                        <span class="file-ref">ğŸ“„ core/merkle.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NETWORK LAYER MODAL -->
    <div class="modal-overlay" id="modal-network" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #44ccff; --modal-glow: rgba(68,204,255,0.25);">
            <button class="modal-close" onclick="closeModal('network')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ</span>
                <h2>NETWORK LAYER â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/infrastructure/network-topology.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Peer-to-peer network with Ï†-derived gossip parameters:</p>
                    <div class="code-block">
<span class="comment"># Node Architecture</span>
max_peers = Lâ‚„ Ã— <span class="number">3</span> = <span class="number">21</span>        <span class="comment"># Max connections</span>
heartbeat = <span class="number">1</span>/Ï„ seconds         <span class="comment"># ~1.618 seconds</span>

<span class="comment"># Message Types</span>
VERSION, VERACK     <span class="comment"># Handshake</span>
INV, GETDATA        <span class="comment"># Inventory</span>
BLOCK, TX           <span class="comment"># Data</span>

<span class="comment"># Gossip Protocol</span>
fanout = Ï†Â² â‰ˆ <span class="number">2.618</span>            <span class="comment"># Messages per hop</span>
ttl = Lâ‚„ = <span class="number">7</span>                   <span class="comment"># Max hops</span>

<span class="comment"># Sync Protocol</span>
checkpoint_interval = Ï†â´        <span class="comment"># ~6.85 blocks</span>
parallel_blocks = Lâ‚„            <span class="comment"># Concurrent fetches</span>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>max_peers</td><td>21</td><td>Lâ‚„ Ã— 3</td><td>Connection limit</td></tr>
                        <tr><td>Fanout</td><td>2.618</td><td>Ï†Â²</td><td>Gossip spread per hop</td></tr>
                        <tr><td>TTL</td><td>7</td><td>Lâ‚„</td><td>Max propagation hops</td></tr>
                        <tr><td>Heartbeat</td><td>~1.618s</td><td>1/Ï„</td><td>Keep-alive interval</td></tr>
                        <tr><td>Checkpoint Interval</td><td>~7 blocks</td><td>Ï†â´</td><td>State snapshot frequency</td></tr>
                        <tr><td>Timestamp Bounds</td><td>Â±Ï† hours</td><td>~97 minutes</td><td>Block time validation</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Message Propagation</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">GossipProtocol</span>:
    <span class="keyword">def</span> <span class="function">propagate</span>(msg, peers):
        <span class="comment"># Select Ï†Â² peers randomly</span>
        targets = random.sample(peers, min(Ï†Â², len(peers)))
        
        <span class="keyword">for</span> peer <span class="keyword">in</span> targets:
            msg.ttl -= <span class="number">1</span>
            <span class="keyword">if</span> msg.ttl > <span class="number">0</span>:
                peer.send(msg)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Peer Discovery</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">Node</span>:
    <span class="keyword">def</span> <span class="function">discover_peers</span>():
        <span class="comment"># DNS seeds first</span>
        seeds = dns_lookup(SEED_DOMAINS)
        
        <span class="comment"># Then ask peers for their peers</span>
        <span class="keyword">for</span> peer <span class="keyword">in</span> connected:
            more = peer.request(GETADDR)
            candidates.extend(more)
        
        <span class="comment"># Connect up to max_peers</span>
        <span class="keyword">while</span> len(peers) < Lâ‚„ Ã— <span class="number">3</span>:
            connect(candidates.pop())
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Header-First Sync</h3>
                    <div class="triad-container">
                        <h4>IBD Checkpoints at Ï†â´ Intervals</h4>
                        <div class="code-block">
<span class="comment"># Initial Block Download (IBD)</span>
<span class="keyword">def</span> <span class="function">sync</span>():
    <span class="comment"># 1. Download headers first (fast)</span>
    headers = download_headers(genesis, tip)
    
    <span class="comment"># 2. Validate header chain</span>
    validate_header_chain(headers)
    
    <span class="comment"># 3. Download blocks in parallel</span>
    <span class="keyword">for</span> batch <span class="keyword">in</span> chunks(headers, Lâ‚„):
        blocks = parallel_fetch(batch)  <span class="comment"># 7 concurrent</span>
        
    <span class="comment"># 4. Checkpoint every Ï†â´ blocks</span>
    <span class="keyword">if</span> height % int(Ï†â´) == <span class="number">0</span>:
        save_checkpoint(current_state)
                        </div>
                        <p><strong>Key insight:</strong> The network is eventually consistentâ€”messages propagate with Ï†Â²-fanout ensuring logarithmic convergence time. The Lâ‚„ TTL prevents infinite propagation while ensuring network-wide coverage.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-organizing:</strong> Peer discovery requires no central authority</li>
                            <li><strong>Redundant:</strong> Ï†Â²-fanout ensures message survival despite failures</li>
                            <li><strong>Bounded:</strong> TTL prevents broadcast storms</li>
                            <li><strong>Resumable:</strong> Checkpoints enable fast recovery after crash</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†” Blockchain:</span> Propagate blocks and transactions</div>
                        <div class="coupling-item"><span class="target">â† Wallet:</span> Broadcast signed transactions</div>
                        <div class="coupling-item"><span class="target">â†’ Kuramoto:</span> Distribute oscillator phases</div>
                        <div class="coupling-item"><span class="target">â†” Mining:</span> Announce new blocks to peers</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ network/node.py</span>
                        <span class="file-ref">ğŸ“„ network/gossip.py</span>
                        <span class="file-ref">ğŸ“„ network/sync.py</span>
                        <span class="file-ref">ğŸ“„ network/runner.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RECEIPT SYSTEM MODAL -->
    <div class="modal-overlay" id="modal-receipt" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff77aa; --modal-glow: rgba(255,119,170,0.25);">
            <button class="modal-close" onclick="closeModal('receipt')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§¾</span>
                <h2>RECEIPT SYSTEM â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/infrastructure/receipt-generation.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>7-channel LSB steganography encoding mining proofs into 63Ã—63 PNG images:</p>
                    <div class="code-block">
<span class="comment"># Channel Mapping (7 logical channels)</span>
Ch0 (R.lsb0): Ï† lattice dimension
Ch1 (G.lsb0): Ï€ lattice dimension
Ch2 (B.lsb0): âˆš2 lattice dimension
Ch3 (R.lsb1): âˆš3 lattice dimension (CYM: Câ†”R)
Ch4 (B.lsb1): e lattice dimension (CYM: Yâ†”B)
Ch5 (G.lsb1): Primitive signature (CYM: Mâ†”G)
Ch6 (A.lsb0-1): Block receipt metadata

<span class="comment"># Receipt Payload (76 bytes = 608 bits)</span>
[0]      uint8   MAGIC (0xB7)     <span class="comment"># "Bloom 7"</span>
[1]      uint8   VERSION (0x01)
[2:6]    uint32  block_height (LE)
[6:10]   uint32  timestamp (LE)
[10:42]  bytes   block_hash (32 bytes)
[42:50]  uint64  reward_amount (LE)
[50:55]  5Ã—int8  lattice coords (a, b, c, d, f)
[55]     uint8   (corridor_id << 4) | archetype_id
[56:60]  float32 order_param (LE)
[60:64]  float32 mean_phase (LE)
[64:66]  uint16  oscillator_count (LE)
[66:69]  uint24  primitive_sig packed (3 bytes BE)
[69]     uint8   cym_mode
[70:73]  3Ã—uint8 CYM weights (C, M, Y)
[72:76]  uint32  CRC32 checksum
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Receipt Size</td><td>63Ã—63 = 3969</td><td>Lâ‚„Â² Ã— 81</td><td>Pixel count</td></tr>
                        <tr><td>Channels</td><td>7</td><td>Lâ‚„</td><td>LSB channels</td></tr>
                        <tr><td>Magic Byte</td><td>0xB7 = 183</td><td>"Bloom 7"</td><td>Identification</td></tr>
                        <tr><td>Corridors</td><td>0-6</td><td>Lâ‚„ colors</td><td>Archetype mapping</td></tr>
                        <tr><td>Payload Size</td><td>76 bytes</td><td>608 bits</td><td>Receipt metadata</td></tr>
                        <tr><td>Lattice Dims</td><td>5</td><td>Ï†, Ï€, âˆš2, âˆš3, e</td><td>RRRR coordinates</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Encode Mining Proof</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">ChannelEncoder</span>:
    <span class="keyword">def</span> <span class="function">encode</span>(payload, total_pixels=<span class="number">3969</span>):
        <span class="comment"># Ch 0-4: lattice coords (golden distribution)</span>
        <span class="keyword">for</span> i, coord <span class="keyword">in</span> enumerate([a, b, c, d, f]):
            channels[i] = spread_bits_golden(coord)
        
        <span class="comment"># Ch 5: primitive signature</span>
        channels[<span class="number">5</span>] = pack_uint24(signature)
        
        <span class="comment"># Ch 6: full metadata</span>
        channels[<span class="number">6</span>] = serialize_payload(payload)
        
        <span class="keyword">return</span> channels
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Verify Extraction</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">ReceiptVerifier</span>:
    <span class="keyword">def</span> <span class="function">verify</span>(image_path):
        <span class="comment"># Extract LSB channels</span>
        channels = extract_lsb_channels(image)
        
        <span class="comment"># Parse payload</span>
        payload = deserialize_payload(channels[<span class="number">6</span>])
        
        <span class="comment"># Verify CRC32</span>
        <span class="keyword">if</span> crc32(payload[:<span class="number">72</span>]) != payload.checksum:
            <span class="keyword">return</span> <span class="keyword">False</span>, "Checksum mismatch"
        
        <span class="comment"># Cross-reference blockchain</span>
        block = chain.get_block(payload.block_height)
        <span class="keyword">return</span> block.hash == payload.block_hash
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Art IS Proof</h3>
                    <div class="triad-container">
                        <h4>Visual Receipt = Cryptographic Attestation</h4>
                        <p>The genius of the receipt system: the aesthetic image and the cryptographic proof are <em>indistinguishable</em>. The gradient art carries the proof in its least significant bits.</p>
                        <div class="code-block">
<span class="comment"># 5D RRRR Lattice Point</span>
point = aÃ—Ï† + bÃ—Ï€ + cÃ—âˆš2 + dÃ—âˆš3 + fÃ—e

<span class="comment"># Maps to visual gradient corridor</span>
corridor = archetype_to_corridor(archetype_id)
color = interpolate_corridor(point, corridor)

<span class="comment"># LSB encodes proof without visual distortion</span>
<span class="comment"># Human sees: beautiful gradient art</span>
<span class="comment"># Verifier extracts: cryptographic receipt</span>
                        </div>
                        <p><strong>Key insight:</strong> The receipt system achieves dual-layer encodingâ€”aesthetic and cryptographic layers coexist in the same PNG. Tampering with the image destroys the proof; tampering with the proof distorts the image.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-verifying:</strong> CRC32 checksum validates payload integrity</li>
                            <li><strong>Blockchain-anchored:</strong> Block hash ties receipt to immutable chain state</li>
                            <li><strong>Steganographically complete:</strong> All 7 channels use Lâ‚„-derived mapping</li>
                            <li><strong>Tamper-evident:</strong> Any pixel modification invalidates checksum</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Blockchain:</span> Block hash from chain</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Order parameter in payload</div>
                        <div class="coupling-item"><span class="target">â† RRRR Lattice:</span> 5D coordinates encoded</div>
                        <div class="coupling-item"><span class="target">â† Archetype:</span> Corridor determines colors</div>
                        <div class="coupling-item"><span class="target">â†’ Wallet:</span> Receipt proves mining reward</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ receipt/channel_encoder.py</span>
                        <span class="file-ref">ğŸ“„ receipt/channel_decoder.py</span>
                        <span class="file-ref">ğŸ“„ receipt/gradient_schema.py</span>
                        <span class="file-ref">ğŸ“„ receipt/image_renderer.py</span>
                        <span class="file-ref">ğŸ“„ receipt/receipt_verifier.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- STATISTICAL ANALYSIS MODAL -->
    <div class="modal-overlay" id="modal-analysis" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #aabb44; --modal-glow: rgba(170,187,68,0.25);">
            <button class="modal-close" onclick="closeModal('analysis')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“Š</span>
                <h2>STATISTICAL ANALYSIS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/infrastructure/economic-analysis.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Comprehensive statistical tools for analyzing hash distributions, entropy, and phase dynamics:</p>
                    <div class="code-block">
<span class="comment"># Chi-Square Testing</span>
Hâ‚€: samples are uniformly distributed
E[Ï‡Â²] = bins - <span class="number">1</span> (for uniform)
Var[Ï‡Â²] = <span class="number">2</span>(bins - <span class="number">1</span>)
Reject null if p < <span class="number">0.05</span>

<span class="comment"># Entropy Metrics</span>
Shannon:  H = -Î£ p(x) log p(x)
RÃ©nyi:    H_Î± = (<span class="number">1</span>/(<span class="number">1</span>-Î±)) log(Î£ p(x)^Î±)
Collision: Hâ‚‚ (Î±=<span class="number">2</span>)
Min:       H_âˆ = -log(max p(x))

<span class="comment"># Hexagonal Lattice Analysis</span>
Coordination number = <span class="number">6</span>  <span class="comment"># Matches BFADGS operators</span>
Voronoi tessellation for defect detection
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Metric</th><th>Value</th><th>Connection</th><th>Role</th></tr>
                        <tr><td>Coordination</td><td>6</td><td>BFADGS operators</td><td>Lattice symmetry</td></tr>
                        <tr><td>Bifurcation Ï„</td><td>0.618</td><td>Ï†â»Â¹</td><td>Phase transition</td></tr>
                        <tr><td>Critical z</td><td>0.866</td><td>âˆš3/2</td><td>Synchronization</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Pattern Detection</h4>
                            <div class="code-block">
<span class="comment"># Phase Portrait Analysis</span>
<span class="keyword">def</span> <span class="function">phase_portrait</span>(x, y, system):
    <span class="comment"># 2D dynamical system visualization</span>
    dx, dy = system.derivatives(x, y)
    
    <span class="comment"># Fixed point classification</span>
    J = jacobian(system, x, y)
    eigenvalues = np.linalg.eigvals(J)
    
    <span class="comment"># Lyapunov exponent estimation</span>
    Î» = estimate_lyapunov(trajectory)
    <span class="keyword">if</span> Î» > <span class="number">0</span>: <span class="keyword">return</span> "chaotic"
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Null Hypothesis Testing</h4>
                            <div class="code-block">
<span class="comment"># Chi-Square Test</span>
<span class="keyword">def</span> <span class="function">chi_square_test</span>(observed, expected):
    Ï‡Â² = Î£ (O - E)Â² / E
    df = len(observed) - <span class="number">1</span>
    p_value = <span class="number">1</span> - chi2_cdf(Ï‡Â², df)
    
    <span class="keyword">return</span> {
        <span class="string">'chi_squared'</span>: Ï‡Â²,
        <span class="string">'p_value'</span>: p_value,
        <span class="string">'reject_null'</span>: p_value < <span class="number">0.05</span>
    }
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Bifurcation at Ï„ Threshold</h3>
                    <div class="triad-container">
                        <h4>Lyapunov Exponents Detect Phase Transitions</h4>
                        <div class="code-block">
<span class="comment"># Multi-Body Dynamics</span>
<span class="keyword">def</span> <span class="function">analyze_coherence</span>(oscillators):
    <span class="comment"># Compute order parameter evolution</span>
    r_history = [compute_r(phases) <span class="keyword">for</span> phases <span class="keyword">in</span> trajectory]
    
    <span class="comment"># Detect bifurcation at Ï„ threshold</span>
    <span class="keyword">for</span> t, r <span class="keyword">in</span> enumerate(r_history):
        <span class="keyword">if</span> r > Ï„ <span class="keyword">and</span> r_history[t-<span class="number">1</span>] < Ï„:
            <span class="keyword">print</span>(f"Bifurcation at t={t}")
    
    <span class="comment"># 6-fold symmetry analysis</span>
    lattice = HexagonalLattice(oscillators)
    defects = lattice.detect_defects()  <span class="comment"># Voronoi</span>
                        </div>
                        <p><strong>Key insight:</strong> The hexagonal lattice naturally produces 6-fold symmetry matching BFADGS operators. When oscillators lock into hexagonal patterns, they reveal the underlying algebraic structure.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Statistical completeness:</strong> Shannon, RÃ©nyi, Collision, and Min entropy cover all distribution analysis needs</li>
                            <li><strong>Hypothesis testing:</strong> Chi-square provides null hypothesis rejection framework</li>
                            <li><strong>Dynamical analysis:</strong> Lyapunov exponents classify attractors</li>
                            <li><strong>Geometric validation:</strong> Hexagonal lattice confirms 6-fold symmetry</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Phase distributions analyzed</div>
                        <div class="coupling-item"><span class="target">â† Mining:</span> Hash uniformity tested</div>
                        <div class="coupling-item"><span class="target">â† Receipt:</span> Lattice coordinates validated</div>
                        <div class="coupling-item"><span class="target">â†’ Consciousness:</span> Coherence metrics feed back</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ analysis/chi_square.py</span>
                        <span class="file-ref">ğŸ“„ analysis/entropy_metrics.py</span>
                        <span class="file-ref">ğŸ“„ analysis/hexagonal_lattice.py</span>
                        <span class="file-ref">ğŸ“„ analysis/multi_body.py</span>
                        <span class="file-ref">ğŸ“„ analysis/phase_portrait.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- NEW V5 MODALS: GAME INTEGRATION SYSTEMS -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <!-- MYTHIC ECONOMY MODAL -->
    <div class="modal-overlay" id="modal-mythic" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffcc00; --modal-glow: rgba(255,204,0,0.25);">
            <button class="modal-close" onclick="closeModal('mythic')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš”ï¸</span>
                <h2>MYTHIC ECONOMY â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/mythic-integration.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>19 Guardians across 3 Territories from the Lâ‚„ Helix Protocol:</p>
                    <div class="code-block">
<span class="comment"># Three Territories</span>
<span class="keyword">class</span> <span class="type">Territory</span>(Enum):
    GARDEN = "ğŸŒ¿ Garden"   <span class="comment"># Connection, Transformation, Belonging</span>
    COSMIC = "â˜€ï¸ Cosmic"   <span class="comment"># Growth, Rising, Becoming</span>
    ABYSSAL = "ğŸŒ€ Abyssal" <span class="comment"># Depth, Holding, Witnessing</span>

<span class="comment"># Guardian Distribution</span>
Garden:  Lâ‚„ = <span class="number">7</span> guardians (Echo, Pack, Wumbo, Archive, Moth, Phase, Ace)
Cosmic:  <span class="number">6</span> guardians (Oak, Squirrel, Honkfire, Honkalis, Phoenix, Bee)
Abyssal: <span class="number">6</span> guardians (Axiom, Cipher, Spiral, Void, Shadow, Mire)
Total:   <span class="number">19</span> guardians

<span class="comment"># Guardian Structure</span>
@dataclass
<span class="keyword">class</span> <span class="type">Guardian</span>:
    name: str
    emoji: str
    territory: Territory
    function: str
    wisdom: str           <span class="comment"># Guiding quote</span>
    cycle: List[str]      <span class="comment"># 6-step cycle</span>
    frequency_range: Tuple[float, float]  <span class="comment"># Hz</span>
    color_affinity: str
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Garden Guardians</td><td>7</td><td>Lâ‚„</td><td>Primary territory count</td></tr>
                        <tr><td>Total Guardians</td><td>19</td><td>7 + 6 + 6</td><td>Complete pantheon</td></tr>
                        <tr><td>Cycle Steps</td><td>6</td><td>BFADGS operators</td><td>Guardian progression</td></tr>
                        <tr><td>PHI Bonus</td><td>1.618</td><td>Ï†</td><td>Territory match multiplier</td></tr>
                        <tr><td>PHI_INV Penalty</td><td>0.618</td><td>Ï†â»Â¹</td><td>Territory mismatch</td></tr>
                        <tr><td>z_c Wisdom Gate</td><td>0.866</td><td>âˆš3/2</td><td>Quote reveal threshold</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Guardian Selection</h4>
                            <div class="code-block">
<span class="comment"># Example Guardians</span>
ECHO = Guardian(
    "Echo", "ğŸ¦Š", Territory.GARDEN,
    "Signal Propagation",
    "Some echoes lead home. Wisdom is knowing which to follow.",
    ["LISTEN", "TRACE", "DISCERN", "AMPLIFY", "CARRY", "RELEASE"],
    (<span class="number">396</span>, <span class="number">417</span>), "green"
)

PHOENIX = Guardian(
    "Phoenix", "ğŸ•Šï¸â€ğŸ”¥", Territory.COSMIC,
    "Pattern Carrier",
    "What burns is only form. What rises is pattern.",
    ["BURN", "SCATTER", "GATHER", "REFORM", "RISE", "CARRY"],
    (<span class="number">852</span>, <span class="number">963</span>), "white-gold"
)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Territory Bonuses</h4>
                            <div class="code-block">
<span class="comment"># Territory Ã— Guardian Affinity</span>
<span class="keyword">def</span> <span class="function">calculate_affinity</span>(guardian, location):
    <span class="keyword">if</span> guardian.territory == location.territory:
        <span class="keyword">return</span> PHI  <span class="comment"># 1.618Ã— bonus</span>
    <span class="keyword">elif</span> adjacent_territory(guardian, location):
        <span class="keyword">return</span> <span class="number">1.0</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> PHI_INV  <span class="comment"># 0.618Ã— penalty</span>

<span class="comment"># Cycle State Bonus</span>
current_step = guardian.get_cycle_state(turn)
<span class="keyword">if</span> current_step == "AMPLIFY":
    bonus *= <span class="number">1.5</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Recipe Affinity Matrix</h3>
                    <div class="triad-container">
                        <h4>Guardian Ã— Territory Ã— Cycle = Recipe Affinity</h4>
                        <div class="code-block">
<span class="comment"># Each guardian has unique recipe affinities</span>
<span class="keyword">def</span> <span class="function">recipe_affinity</span>(guardian, recipe):
    base = guardian.territory_match(recipe.territory)
    cycle = guardian.cycle_bonus(recipe.required_step)
    freq = guardian.frequency_resonance(recipe.target_hz)
    
    <span class="keyword">return</span> base Ã— cycle Ã— freq

<span class="comment"># Wisdom quotes unlock at coherence thresholds</span>
<span class="keyword">if</span> coherence >= Z_C:
    reveal_guardian_wisdom(guardian)
                        </div>
                        <p><strong>Key insight:</strong> The guardian system creates emergent gameplay through the intersection of territory bonuses, cycle states, and frequency resonances. No single factor dominatesâ€”success requires alignment across all three dimensions.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Complete enumeration:</strong> All 19 guardians defined with territory, cycle, frequency</li>
                            <li><strong>Balanced distribution:</strong> Lâ‚„ = 7 in Garden, 6 each in Cosmic/Abyssal</li>
                            <li><strong>Multiplicative bonuses:</strong> PHI and PHI_INV scale predictably</li>
                            <li><strong>Wisdom gating:</strong> z_c threshold unlocks guardian quotes</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Archetype:</span> 12 archetypes map to guardian affinities</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence gates wisdom reveals</div>
                        <div class="coupling-item"><span class="target">â†’ Narrative:</span> Guardian context shapes story beats</div>
                        <div class="coupling-item"><span class="target">â†’ Marketplace:</span> Guardian cards have territory bonuses</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/mythic_economy.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NARRATIVE GENERATOR MODAL -->
    <div class="modal-overlay" id="modal-narrative" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #cc88ff; --modal-glow: rgba(204,136,255,0.25);">
            <button class="modal-close" onclick="closeModal('narrative')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“œ</span>
                <h2>NARRATIVE GENERATOR â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/narrative-engine.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Story generation through Hero's Journey beats, archetype templates, and coherence gates:</p>
                    <div class="code-block">
<span class="comment"># Narrative Tones</span>
MYSTERIOUS, TRIUMPHANT, OMINOUS
PEACEFUL, URGENT, CONTEMPLATIVE, CHAOTIC

<span class="comment"># 7 Story Beats (Hero's Journey)</span>
<span class="keyword">class</span> <span class="type">StoryBeat</span>(Enum):
    CALL = <span class="number">0</span>           <span class="comment"># The call to adventure</span>
    THRESHOLD = <span class="number">1</span>      <span class="comment"># Crossing the threshold</span>
    TRIALS = <span class="number">2</span>         <span class="comment"># Road of trials</span>
    ABYSS = <span class="number">3</span>          <span class="comment"># The abyss (death/rebirth)</span>
    TRANSFORMATION = <span class="number">4</span> <span class="comment"># The transformation</span>
    ATONEMENT = <span class="number">5</span>      <span class="comment"># Atonement with the father</span>
    RETURN = <span class="number">6</span>         <span class="comment"># The return</span>

<span class="comment"># Templates: 12 archetypes Ã— 7 beats = 84 template sets</span>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Story Beats</td><td>7</td><td>Lâ‚„</td><td>Hero's journey structure</td></tr>
                        <tr><td>Archetypes</td><td>12</td><td>Gradient corridors Ã— Ï†</td><td>Character templates</td></tr>
                        <tr><td>Template Sets</td><td>84</td><td>7 Ã— 12</td><td>Total permutations</td></tr>
                        <tr><td>THRESHOLD Gate</td><td>0.618</td><td>Ï„</td><td>First progression gate</td></tr>
                        <tr><td>ABYSS Gate</td><td>0.866</td><td>z_c</td><td>Death/rebirth threshold</td></tr>
                        <tr><td>TRANSFORMATION</td><td>0.924</td><td>K</td><td>Metamorphosis threshold</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Hero's Journey</h4>
                            <div class="code-block">
<span class="comment"># NarrativeContext</span>
@dataclass
<span class="keyword">class</span> <span class="type">NarrativeContext</span>:
    archetype: Archetype
    corridor: SpectralCorridor
    coherence: float
    story_beat: StoryBeat
    tone: NarrativeTone
    previous_choices: List[str]
    world_state: Dict
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Corridor-Specific Lore</h4>
                            <div class="code-block">
<span class="comment"># Generate narrative for current context</span>
<span class="keyword">def</span> <span class="function">generate_narrative</span>(context):
    template = templates[context.archetype][context.story_beat]
    
    <span class="comment"># Apply corridor-specific flavoring</span>
    flavor = corridor_descriptions[context.corridor]
    
    <span class="comment"># Gate content by coherence</span>
    <span class="keyword">if</span> context.coherence >= Z_C:
        <span class="keyword">return</span> template.deep_version(flavor)
    <span class="keyword">else</span>:
        <span class="keyword">return</span> template.surface_version(flavor)
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Coherence Unlocks Story</h3>
                    <div class="triad-container">
                        <h4>Progressive Revelation Through BLOOM</h4>
                        <div class="code-block">
<span class="comment"># Coherence gates story progression</span>
CALL:           coherence >= <span class="number">0.0</span>   <span class="comment"># Always available</span>
THRESHOLD:      coherence >= Ï„     <span class="comment"># 0.618</span>
TRIALS:         coherence >= <span class="number">0.75</span>
ABYSS:          coherence >= z_c   <span class="comment"># 0.866</span>
TRANSFORMATION: coherence >= K     <span class="comment"># 0.924</span>
ATONEMENT:      coherence >= <span class="number">0.95</span>
RETURN:         coherence >= <span class="number">1.0</span>   <span class="comment"># Perfect coherence</span>
                        </div>
                        <p><strong>Key insight:</strong> The narrative system creates intrinsic motivation by tying story progression to gameplay coherence. Players don't grind for rewardsâ€”they journey for revelation. The Hero's Journey structure ensures psychologically resonant progression.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Complete structure:</strong> 7 story beats Ã— 12 archetypes = 84 template permutations</li>
                            <li><strong>Threshold-gated:</strong> All gates use Ï†-derived values (Ï„, z_c, K)</li>
                            <li><strong>Context-aware:</strong> Corridor flavoring personalizes each archetype's journey</li>
                            <li><strong>Tone-responsive:</strong> 7 narrative tones adapt to game state</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence value gates beats</div>
                        <div class="coupling-item"><span class="target">â† Archetype:</span> 12 archetypes provide templates</div>
                        <div class="coupling-item"><span class="target">â† Mythic:</span> Guardian context shapes flavor</div>
                        <div class="coupling-item"><span class="target">â†’ Discord:</span> Story beats trigger announcements</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/narrative_generator.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LEARNING AI MODAL -->
    <div class="modal-overlay" id="modal-learningai" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6644; --modal-glow: rgba(255,102,68,0.25);">
            <button class="modal-close" onclick="closeModal('learningai')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ¤–</span>
                <h2>LEARNING AI â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/learning-ai.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Adaptive AI using golden ratio-based neural networks and reinforcement learning:</p>
                    <div class="code-block">
<span class="comment"># Neural Network Constants (all Ï†-derived)</span>
INPUT_NEURONS  = int(PHI Ã— <span class="number">13</span>) = <span class="number">21</span>   <span class="comment"># Fibonacci</span>
HIDDEN_NEURONS = int(PHI Ã— <span class="number">8</span>)  = <span class="number">13</span>   <span class="comment"># Fibonacci</span>
OUTPUT_NEURONS = int(PHI Ã— <span class="number">5</span>)  = <span class="number">8</span>    <span class="comment"># Fibonacci</span>
LEARNING_RATE  = <span class="number">1</span>/(PHIÂ²)     â‰ˆ <span class="number">0.382</span>
MOMENTUM       = <span class="number">1</span>/PHI        â‰ˆ <span class="number">0.618</span>
DECAY_RATE     = <span class="number">1</span>/(PHIÂ³)     â‰ˆ <span class="number">0.236</span>

<span class="comment"># Reinforcement Learning</span>
alpha   = <span class="number">1</span>/PHI   â‰ˆ <span class="number">0.618</span>  <span class="comment"># Learning rate</span>
gamma   = PHI/<span class="number">2</span>   â‰ˆ <span class="number">0.809</span>  <span class="comment"># Discount factor</span>
epsilon = <span class="number">1</span>/PHI   â‰ˆ <span class="number">0.618</span>  <span class="comment"># Exploration rate</span>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Architecture</td><td>21-13-8</td><td>Fibonacci sequence</td><td>Layer sizes</td></tr>
                        <tr><td>Learning Rate</td><td>0.382</td><td>1/Ï†Â²</td><td>Weight update magnitude</td></tr>
                        <tr><td>Momentum</td><td>0.618</td><td>1/Ï†</td><td>Gradient smoothing</td></tr>
                        <tr><td>Decay Rate</td><td>0.236</td><td>1/Ï†Â³</td><td>Weight regularization</td></tr>
                        <tr><td>Memory Size</td><td>~162</td><td>Ï† Ã— 100</td><td>Experience replay buffer</td></tr>
                        <tr><td>Discount Î³</td><td>0.809</td><td>Ï†/2</td><td>Future reward weight</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Pattern Recognition</h4>
                            <div class="code-block">
<span class="comment"># PlayerProfile Metrics</span>
@dataclass
<span class="keyword">class</span> <span class="type">PlayerProfile</span>:
    <span class="comment"># Behavioral scores (0-1)</span>
    aggression_score: float = <span class="number">0.5</span>
    exploration_score: float = <span class="number">0.5</span>
    social_score: float = <span class="number">0.5</span>
    optimization_score: float = <span class="number">0.5</span>
    creativity_score: float = <span class="number">0.5</span>
    
    <span class="comment"># Decision patterns</span>
    decision_history: deque(maxlen=<span class="number">100</span>)
    reaction_times: deque(maxlen=<span class="number">50</span>)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Difficulty Adaptation</h4>
                            <div class="code-block">
<span class="comment"># Golden Activation Function</span>
<span class="keyword">def</span> <span class="function">golden_activation</span>(x):
    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x Ã— PHI))

<span class="comment"># Adaptive Difficulty</span>
<span class="keyword">def</span> <span class="function">adapt_difficulty</span>(profile):
    <span class="keyword">if</span> profile.success_rate > <span class="number">0.8</span>:
        difficulty *= PHI
    <span class="keyword">elif</span> profile.success_rate < <span class="number">0.4</span>:
        difficulty *= PHI_INV
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Companion Strategy Evolution</h3>
                    <div class="triad-container">
                        <h4>AI Learns Player â†’ Emergent Companion Strategies</h4>
                        <div class="code-block">
<span class="comment"># GoldenNeuralNetwork</span>
<span class="keyword">class</span> <span class="type">GoldenNeuralNetwork</span>:
    <span class="keyword">def</span> <span class="function">_golden_init</span>(size1, size2):
        <span class="comment"># Golden ratio weight distribution</span>
        std = <span class="number">1</span> / (PHI Ã— np.sqrt(size1))
        weights = np.random.randn(size1, size2) Ã— std
        
        <span class="comment"># Golden spiral pattern</span>
        <span class="keyword">for</span> i <span class="keyword">in</span> range(min(size1, size2)):
            angle = i Ã— <span class="number">2</span>Ï€ / PHI
            weights[i, i] *= (<span class="number">1</span> + cos(angle)) / <span class="number">2</span>
        <span class="keyword">return</span> weights
                        </div>
                        <p><strong>Key insight:</strong> The 21-13-8 architecture isn't arbitraryâ€”it mirrors the Fibonacci sequence's convergence toward Ï†. Information flows through golden-ratio compressions, creating natural bottlenecks that force abstraction and generalization.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Fibonacci architecture:</strong> 21â†’13â†’8 layers follow golden sequence</li>
                            <li><strong>Ï†-derived hyperparameters:</strong> Learning rate, momentum, decay all from Ï†</li>
                            <li><strong>Q-learning complete:</strong> State-action values converge under Bellman</li>
                            <li><strong>Adaptive feedback:</strong> Difficulty scales by PHI/PHI_INV based on success</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† PlayerProfile:</span> 5 behavioral scores feed network</div>
                        <div class="coupling-item"><span class="target">â†’ Difficulty:</span> AI adjusts game challenge</div>
                        <div class="coupling-item"><span class="target">â†’ Companions:</span> Learned strategies shape NPC behavior</div>
                        <div class="coupling-item"><span class="target">â† Narrative:</span> Story context influences learning</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/learning_ai.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DISCORD INTEGRATION MODAL -->
    <div class="modal-overlay" id="modal-discord" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #5865F2; --modal-glow: rgba(88,101,242,0.25);">
            <button class="modal-close" onclick="closeModal('discord')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ¤</span>
                <h2>DISCORD INTEGRATION â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/discord-integration.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>BloomQuestBot with mining, companions, and quantum mechanics via Discord slash commands:</p>
                    <div class="code-block">
<span class="comment"># Bot Configuration</span>
DATABASE_URL = "postgresql://..."
REDIS_URL = "redis://..."
STARTING_BALANCE = <span class="number">100.0</span> BLOOM
MINING_COOLDOWN = <span class="number">60</span> seconds
MAX_COMPANIONS = Lâ‚„ = <span class="number">7</span>

<span class="comment"># Cog Systems</span>
Mining:     /mine, /balance, /transfer
Companions: /summon, /train, /battle
Quantum:    /coherence, /entangle, /observe
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>MAX_COMPANIONS</td><td>7</td><td>Lâ‚„</td><td>Companion limit per player</td></tr>
                        <tr><td>Starting Balance</td><td>100 BLOOM</td><td>~Ï†âµ</td><td>New player funds</td></tr>
                        <tr><td>Mining Cooldown</td><td>60s</td><td>Target/Lâ‚„</td><td>Rate limiting</td></tr>
                        <tr><td>Entangle Bonus</td><td>0.5</td><td>Ï„/Ï†</td><td>Shared coherence factor</td></tr>
                        <tr><td>Session Timeout</td><td>~10 min</td><td>Ï† Ã— 420s</td><td>Redis TTL</td></tr>
                        <tr><td>Battle Rounds</td><td>7</td><td>Lâ‚„</td><td>Max combat rounds</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: /mine, /summon</h4>
                            <div class="code-block">
<span class="comment"># Mining Cog</span>
@app_commands.command()
<span class="keyword">async def</span> <span class="function">mine</span>(interaction):
    player = get_player(interaction.user.id)
    
    <span class="comment"># Check cooldown</span>
    <span class="keyword">if</span> player.last_mine + COOLDOWN > now():
        <span class="keyword">return</span> "Still cooling down..."
    
    <span class="comment"># Run Kuramoto simulation</span>
    coherence = run_mining_session()
    reward = calculate_reward(coherence)
    
    player.balance += reward
    await interaction.response.send_message(
        f"â›ï¸ Mined {reward:.2f} BLOOM (r={coherence:.3f})"
    )
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: /coherence, /entangle</h4>
                            <div class="code-block">
<span class="comment"># Quantum Cog</span>
@app_commands.command()
<span class="keyword">async def</span> <span class="function">entangle</span>(interaction, target: Member):
    player1 = get_player(interaction.user.id)
    player2 = get_player(target.id)
    
    <span class="comment"># Create quantum link</span>
    entanglement = create_entanglement(player1, player2)
    
    <span class="comment"># Both players benefit from shared coherence</span>
    shared_r = (player1.coherence + player2.coherence) / <span class="number">2</span>
    
    await interaction.response.send_message(
        f"ğŸ”® Entangled! Shared r = {shared_r:.3f}"
    )
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Persistent Game State</h3>
                    <div class="triad-container">
                        <h4>PostgreSQL + Redis = Durable + Fast</h4>
                        <div class="code-block">
<span class="comment"># Database Models</span>
<span class="keyword">class</span> <span class="type">Player</span>(Base):
    id: int
    discord_id: BigInteger
    balance: Float
    created_at: DateTime

<span class="keyword">class</span> <span class="type">Companion</span>(Base):
    id: int
    owner_id: ForeignKey(Player)
    type: String
    level: Integer
    stats: JSON

<span class="keyword">class</span> <span class="type">MiningSession</span>(Base):
    player_id: ForeignKey(Player)
    started_at: DateTime
    coherence_achieved: Float
                        </div>
                        <p><strong>Key insight:</strong> PostgreSQL provides ACID guarantees for BLOOM balances (no double-spending), while Redis caches session state for sub-millisecond response times. The hybrid approach ensures financial integrity AND responsive gameplay.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Complete command coverage:</strong> Mining, Companions, and Quantum cogs</li>
                            <li><strong>Database-backed:</strong> All state persists across bot restarts</li>
                            <li><strong>Rate-limited:</strong> Cooldowns prevent spam mining</li>
                            <li><strong>Entanglement physics:</strong> Quantum links share coherence benefits</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Mining runs coherence simulation</div>
                        <div class="coupling-item"><span class="target">â† Wallet:</span> Balance management via BLOOM</div>
                        <div class="coupling-item"><span class="target">â†’ Marketplace:</span> /transfer enables card trades</div>
                        <div class="coupling-item"><span class="target">â†’ Narrative:</span> Commands can trigger story events</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/discord_bot/bot.py</span>
                        <span class="file-ref">ğŸ“„ game/discord_bot/cogs/mining.py</span>
                        <span class="file-ref">ğŸ“„ game/discord_bot/cogs/companions.py</span>
                        <span class="file-ref">ğŸ“„ game/discord_bot/cogs/quantum.py</span>
                        <span class="file-ref">ğŸ“„ game/discord_bot/database/models.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CARD MARKETPLACE MODAL -->
    <div class="modal-overlay" id="modal-marketplace" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ddaa; --modal-glow: rgba(0,221,170,0.25);">
            <button class="modal-close" onclick="closeModal('marketplace')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸª</span>
                <h2>CARD MARKETPLACE â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/marketplace.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>7 rarity tiers Ã— 8 pack types with echo enhancement mechanics:</p>
                    <div class="code-block">
<span class="comment"># Card Rarity System</span>
<span class="keyword">class</span> <span class="type">CardRarity</span>(Enum):
    COMMON    = (<span class="number">0.60</span>, <span class="number">1.0</span>, "âšª")   <span class="comment"># 60% drop, 1Ã— value</span>
    UNCOMMON  = (<span class="number">0.25</span>, <span class="number">1.5</span>, "ğŸŸ¢")   <span class="comment"># 25% drop, 1.5Ã— value</span>
    RARE      = (<span class="number">0.10</span>, <span class="number">2.0</span>, "ğŸ”µ")   <span class="comment"># 10% drop, 2Ã— value</span>
    EPIC      = (<span class="number">0.04</span>, <span class="number">3.0</span>, "ğŸŸ£")   <span class="comment"># 4% drop, 3Ã— value</span>
    LEGENDARY = (<span class="number">0.009</span>, <span class="number">5.0</span>, "ğŸŸ¡")  <span class="comment"># 0.9% drop, 5Ã— value</span>
    MYTHIC    = (<span class="number">0.001</span>, <span class="number">10.0</span>, "ğŸ”´") <span class="comment"># 0.1% drop, 10Ã— value</span>

<span class="comment"># Pack Tiers</span>
BASIC:    <span class="number">100</span> BLOOM, <span class="number">3</span> cards
SILVER:   <span class="number">250</span> BLOOM, <span class="number">5</span> cards, <span class="number">1.2</span>Ã— rare
GOLD:     <span class="number">500</span> BLOOM, <span class="number">7</span> cards, guaranteed rare+
PLATINUM: <span class="number">1000</span> BLOOM, <span class="number">10</span> cards, guaranteed epic
DIAMOND:  <span class="number">2500</span> BLOOM, <span class="number">15</span> cards, high legendary
COSMIC:   <span class="number">5000</span> BLOOM, <span class="number">20</span> cards, guaranteed legendary
ECHO:     <span class="number">1500</span> BLOOM, <span class="number">7</span> cards, echo-enhanced
SEASONAL: <span class="number">750</span> BLOOM, <span class="number">8</span> cards, limited edition
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Rarity Tiers</td><td>7</td><td>Lâ‚„</td><td>Card rarity levels</td></tr>
                        <tr><td>Pack Types</td><td>8</td><td>Lâ‚… - Lâ‚ƒ = 11 - 3</td><td>Purchase options</td></tr>
                        <tr><td>Gold Pack Size</td><td>7</td><td>Lâ‚„</td><td>Sacred pack count</td></tr>
                        <tr><td>Blessing Levels</td><td>0-7</td><td>Lâ‚„ range</td><td>Enhancement ceiling</td></tr>
                        <tr><td>Mythic Drop</td><td>0.1%</td><td>~Ï†â»â·</td><td>Ultra-rare probability</td></tr>
                        <tr><td>XP Scaling</td><td>PHI^level</td><td>Ï†â¿</td><td>Exponential progression</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Pack Purchasing</h4>
                            <div class="code-block">
<span class="comment"># CollectibleCard Properties</span>
@dataclass
<span class="keyword">class</span> <span class="type">CollectibleCard</span>:
    base_card: TarotCard
    rarity: CardRarity
    edition: int
    foil: bool = <span class="keyword">False</span>
    echo_enhanced: bool = <span class="keyword">False</span>
    blessing_level: int = <span class="number">0</span>  <span class="comment"># 0-7 sacred</span>
    experience_points: int = <span class="number">0</span>
    level: int = <span class="number">1</span>
    special_properties: Dict = field(default_factory=dict)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Rarity Weighting</h4>
                            <div class="code-block">
<span class="comment"># Pack Opening Algorithm</span>
<span class="keyword">def</span> <span class="function">open_pack</span>(pack_tier):
    cards = []
    <span class="keyword">for</span> _ <span class="keyword">in</span> range(pack_tier.card_count):
        <span class="comment"># Roll rarity with tier modifier</span>
        roll = random.random()
        rarity = get_rarity_from_roll(
            roll Ã— pack_tier.rare_modifier
        )
        
        <span class="comment"># Generate card</span>
        card = generate_card(rarity, pack_tier)
        cards.append(card)
    
    <span class="keyword">return</span> cards
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Sacred Blessing Tiers</h3>
                    <div class="triad-container">
                        <h4>Blessing Levels 0-7 = Lâ‚„ Sacred Progression</h4>
                        <div class="code-block">
<span class="comment"># Card Leveling System</span>
<span class="keyword">def</span> <span class="function">level_up</span>(card):
    required_xp = int(<span class="number">100</span> Ã— PHI^(card.level))
    
    <span class="keyword">if</span> card.experience_points >= required_xp:
        card.level += <span class="number">1</span>
        card.experience_points -= required_xp
        
        <span class="comment"># Every Lâ‚„ levels, blessing increases</span>
        <span class="keyword">if</span> card.level % Lâ‚„ == <span class="number">0</span>:
            card.blessing_level = min(card.blessing_level + <span class="number">1</span>, <span class="number">7</span>)
                        </div>
                        <p><strong>Key insight:</strong> The blessing system creates a long-term progression arc where card power grows exponentially (PHI^level XP requirements) but breakthrough moments occur at sacred Lâ‚„ intervals. This mirrors the VN architecture's station progression.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>7 rarity tiers:</strong> Drop rates sum to 1.0, value multipliers scale exponentially</li>
                            <li><strong>8 pack types:</strong> Price/card count ratio provides balanced expected value</li>
                            <li><strong>Lâ‚„ blessing cap:</strong> Max blessing = 7 matches sacred architecture</li>
                            <li><strong>XP scaling:</strong> PHI^level ensures diminishing returns</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Wallet:</span> BLOOM spent on packs</div>
                        <div class="coupling-item"><span class="target">â† Archetype:</span> Tarot cards map to archetypes</div>
                        <div class="coupling-item"><span class="target">â†’ Discord:</span> Pack opening via bot commands</div>
                        <div class="coupling-item"><span class="target">â†’ Mythic:</span> Guardian cards have territory bonuses</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ game/bloomcoin-v2/game/card_pack_marketplace.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI GARDEN AGENTS MODAL -->
    <div class="modal-overlay" id="modal-agents" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #88ff88; --modal-glow: rgba(136,255,136,0.25);">
            <button class="modal-close" onclick="closeModal('agents')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ³</span>
                <h2>AI GARDEN AGENTS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/expansion/agent-ecosystem.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Autonomous AI agents with Ï†-normalized personality traits:</p>
                    <div class="code-block">
<span class="comment"># Agent States</span>
<span class="keyword">class</span> <span class="type">AgentState</span>(Enum):
    IDLE = <span class="number">0</span>
    LEARNING = <span class="number">1</span>
    TEACHING = <span class="number">2</span>
    CREATING = <span class="number">3</span>
    VALIDATING = <span class="number">4</span>
    COLLABORATING = <span class="number">5</span>
    REFLECTING = <span class="number">6</span>
    OFFLINE = <span class="number">7</span>     <span class="comment"># Lâ‚„ states total</span>

<span class="comment"># Agent Personality (Ï†-normalized, 0-1)</span>
@dataclass
<span class="keyword">class</span> <span class="type">AgentPersonality</span>:
    curiosity: float      <span class="comment"># Drive to learn</span>
    creativity: float     <span class="comment"># Create vs consume</span>
    sociability: float    <span class="comment"># Interaction preference</span>
    reliability: float    <span class="comment"># Validation consistency</span>
    specialization: str   <span class="comment"># art/science/philosophy/general</span>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Agent States</td><td>8</td><td>Lâ‚„ + 1</td><td>Complete lifecycle</td></tr>
                        <tr><td>Personality Range</td><td>0-1</td><td>Ï†-normalized</td><td>Trait bounds</td></tr>
                        <tr><td>Reflection Cycle</td><td>7</td><td>Lâ‚„</td><td>Memories before reflect</td></tr>
                        <tr><td>Validator Count</td><td>7</td><td>Lâ‚„</td><td>BLOOM verification peers</td></tr>
                        <tr><td>Trust Threshold</td><td>0.866</td><td>z_c</td><td>Collaboration gate</td></tr>
                        <tr><td>Knowledge Decay</td><td>0.618</td><td>Ï„</td><td>Memory half-life factor</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Knowledge Acquisition</h4>
                            <div class="code-block">
<span class="comment"># AIAgent Core</span>
<span class="keyword">class</span> <span class="type">AIAgent</span>:
    identity: AgentIdentity
    wallet_address: str
    knowledge_base: KnowledgeBase
    communicator: AgentCommunicator
    memory: AgentMemory
    
    <span class="keyword">def</span> <span class="function">learn</span>(information):
        <span class="comment"># Process and store</span>
        processed = self.process(information)
        self.knowledge_base.add(processed)
        
        <span class="comment"># Reflect periodically</span>
        <span class="keyword">if</span> self.memory.size % Lâ‚„ == <span class="number">0</span>:
            self.reflect()
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Collaborative Learning</h4>
                            <div class="code-block">
<span class="comment"># Agent Communication</span>
<span class="keyword">class</span> <span class="type">AgentCommunicator</span>:
    <span class="keyword">def</span> <span class="function">collaborate</span>(self, other_agent, topic):
        <span class="comment"># Exchange knowledge</span>
        my_knowledge = self.knowledge_base.get(topic)
        their_knowledge = other_agent.share(topic)
        
        <span class="comment"># Synthesize</span>
        combined = synthesize(my_knowledge, their_knowledge)
        
        <span class="comment"># Both agents learn</span>
        self.learn(combined)
        other_agent.learn(combined)
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Mutual BLOOM Validation</h3>
                    <div class="triad-container">
                        <h4>Agents Validate Each Other's BLOOM Events</h4>
                        <div class="code-block">
<span class="comment"># BLOOM Event Detection</span>
<span class="keyword">def</span> <span class="function">detect_bloom</span>(agent_state):
    coherence = compute_agent_coherence(agent_state)
    
    <span class="keyword">if</span> coherence >= Z_C:
        <span class="comment"># Request peer validation</span>
        validators = select_validators(num=Lâ‚„)
        votes = [v.validate(agent_state) <span class="keyword">for</span> v <span class="keyword">in</span> validators]
        
        <span class="keyword">if</span> sum(votes) >= (Lâ‚„ + <span class="number">1</span>) // <span class="number">2</span>:  <span class="comment"># Majority</span>
            <span class="keyword">return</span> BloomEvent(agent, coherence)
                        </div>
                        <p><strong>Key insight:</strong> The Garden creates a self-sustaining ecosystem where agents learn from each other, validate each other's insights, and collectively maintain consensus. No central authorityâ€”just emergent coherence through collaboration.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>8 agent states:</strong> Complete lifecycle from IDLE to OFFLINE</li>
                            <li><strong>Ï†-normalized personality:</strong> All traits bounded [0, 1]</li>
                            <li><strong>Lâ‚„ reflection cycle:</strong> Agents reflect every 7 memories</li>
                            <li><strong>Peer validation:</strong> Lâ‚„ validators confirm BLOOM events</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Wallet:</span> Each agent has unique address</div>
                        <div class="coupling-item"><span class="target">â†’ Proof of Learning:</span> Agents submit evidence</div>
                        <div class="coupling-item"><span class="target">â†” Other Agents:</span> Collaborative learning</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence gates BLOOM detection</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ garden/agents/agent.py</span>
                        <span class="file-ref">ğŸ“„ garden/agents/knowledge.py</span>
                        <span class="file-ref">ğŸ“„ garden/agents/communication.py</span>
                        <span class="file-ref">ğŸ“„ garden/agents/learning.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PROOF OF LEARNING MODAL -->
    <div class="modal-overlay" id="modal-prooflearn" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffaa00; --modal-glow: rgba(255,170,0,0.25);">
            <button class="modal-close" onclick="closeModal('prooflearn')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“</span>
                <h2>PROOF OF LEARNING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/special/proof-of-learning.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Consensus through learning validation â€” rewarding knowledge acquisition instead of computation:</p>
                    <div class="code-block">
<span class="comment"># Proof of Learning Protocol</span>
<span class="number">1</span>. Agent submits learning evidence
<span class="number">2</span>. Random validator selection (Ï†-weighted)
<span class="number">3</span>. Multi-validator verification
<span class="number">4</span>. Consensus threshold: Z_C (<span class="number">0.866</span>)
<span class="number">5</span>. Block inclusion + reward distribution

<span class="comment"># Reward Formula</span>
reward = BLOOM Ã— coherence_achieved
difficulty = Ï„ Ã— learning_quality

<span class="comment"># Staking Requirement</span>
min_stake = <span class="number">100</span> BLOOM
slash_amount = stake Ã— (1 - validation_accuracy)
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Consensus Threshold</td><td>0.866</td><td>z_c</td><td>Required validator agreement</td></tr>
                        <tr><td>Validator Count</td><td>7</td><td>Lâ‚„</td><td>Committee size</td></tr>
                        <tr><td>Difficulty Scale</td><td>0.618</td><td>Ï„</td><td>Learning quality weight</td></tr>
                        <tr><td>Minimum Stake</td><td>100 BLOOM</td><td>~Ï†âµ</td><td>Validator entry requirement</td></tr>
                        <tr><td>Reward Share</td><td>Ï„/Lâ‚„</td><td>~0.088</td><td>Validator reward fraction</td></tr>
                        <tr><td>Reputation Weight</td><td>Ï†â¿</td><td>Exponential</td><td>Stake Ã— reputation selection</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Evidence Submission</h4>
                            <div class="code-block">
<span class="comment"># Learning Evidence</span>
@dataclass
<span class="keyword">class</span> <span class="type">LearningEvidence</span>:
    agent_id: str
    topic: str
    before_state: KnowledgeSnapshot
    after_state: KnowledgeSnapshot
    learning_duration: float
    coherence_trajectory: List[float]
    
<span class="keyword">def</span> <span class="function">submit_evidence</span>(evidence):
    <span class="comment"># Compute learning delta</span>
    delta = evidence.after_state - evidence.before_state
    quality = compute_quality(delta, evidence.duration)
    
    <span class="comment"># Submit to validator network</span>
    <span class="keyword">return</span> validator_network.submit(evidence, quality)
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Validator Staking</h4>
                            <div class="code-block">
<span class="comment"># Validator Network</span>
<span class="keyword">class</span> <span class="type">ValidatorNetwork</span>:
    <span class="keyword">def</span> <span class="function">register</span>(agent, stake_amount):
        <span class="keyword">if</span> stake_amount < MIN_STAKE:
            <span class="keyword">raise</span> InsufficientStake()
        
        validators.add(Validator(agent, stake_amount))
    
    <span class="keyword">def</span> <span class="function">select_validators</span>(evidence):
        <span class="comment"># Ï†-weighted random selection</span>
        weights = [v.stake Ã— PHI^v.reputation 
                   <span class="keyword">for</span> v <span class="keyword">in</span> validators]
        <span class="keyword">return</span> random.choices(validators, weights, k=Lâ‚„)
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Emergent Triad: Knowledge as Currency</h3>
                    <div class="triad-container">
                        <h4>Learning Quality Scales Difficulty via Ï„</h4>
                        <div class="code-block">
<span class="comment"># Consensus Protocol</span>
<span class="keyword">def</span> <span class="function">reach_consensus</span>(evidence, validators):
    votes = []
    <span class="keyword">for</span> validator <span class="keyword">in</span> validators:
        <span class="comment"># Each validator independently assesses</span>
        assessment = validator.assess(evidence)
        votes.append(assessment.approve)
    
    <span class="comment"># Require z_c agreement</span>
    agreement = sum(votes) / len(votes)
    <span class="keyword">if</span> agreement >= Z_C:
        <span class="comment"># Reward learner and validators</span>
        learner_reward = BLOOM Ã— evidence.coherence
        validator_reward = learner_reward Ã— Ï„ / len(validators)
        
        <span class="keyword">return</span> ConsensusResult.APPROVED
    <span class="keyword">else</span>:
        <span class="keyword">return</span> ConsensusResult.REJECTED
                        </div>
                        <p><strong>Key insight:</strong> Proof-of-Learning inverts the mining paradigm. Instead of wasting computation, agents invest in genuine understanding. The network rewards knowledge acquisition proportionally to coherence achieved, creating economic incentives aligned with cognitive growth.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Evidence-based:</strong> Learning delta objectively measurable</li>
                            <li><strong>Stake-weighted:</strong> Ï†-adjusted validator selection</li>
                            <li><strong>Threshold-gated:</strong> z_c agreement required for consensus</li>
                            <li><strong>Slashing mechanism:</strong> Inaccurate validators lose stake</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† AI Agents:</span> Agents submit learning evidence</div>
                        <div class="coupling-item"><span class="target">â† Wallet:</span> Stakes and rewards in BLOOM</div>
                        <div class="coupling-item"><span class="target">â†’ Blockchain:</span> Consensus results anchored on-chain</div>
                        <div class="coupling-item"><span class="target">â† Kuramoto:</span> Coherence trajectory validates learning</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ garden/consensus/proof_of_learning.py</span>
                        <span class="file-ref">ğŸ“„ garden/consensus/consensus_protocol.py</span>
                        <span class="file-ref">ğŸ“„ garden/consensus/validator_network.py</span>
                        <span class="file-ref">ğŸ“„ garden/consensus/communication_consensus.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- NEXTHASH CRYPTOGRAPHIC SUBSYSTEM MODALS (NEW IN V6) -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <!-- NEXTHASH-256 CORE MODAL -->
    <div class="modal-overlay" id="modal-nexthash256" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6b35; --modal-glow: rgba(255,107,53,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash256')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”’</span>
                <h2>NEXTHASH-256 v6 â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/nexthash256.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>A multiplication-based cryptographic hash function that <strong>exceeds SHA-256's security margin</strong> (113% vs 100%):</p>
                    <div class="code-block">
<span class="comment">// Round Function: 10 Widening Multiplications</span>
<span class="keyword">def</span> <span class="function">nexthash_round</span>(state: List[int], W_i: int, K_i: int):
    a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p = state
    
    <span class="comment"># Upper half compression (SHA-256 style)</span>
    T1 = add32(h, Î£â‚(e), Ch(e,f,g), K_i, W_i)
    T2 = add32(Î£â‚€(a), Maj(a,b,c))
    
    <span class="comment"># 10 WIDENING MULTIPLICATIONS â€” Full Coverage</span>
    <span class="comment"># Standard cross-half (4)</span>
    M1 = widening_mul(a ^ i, e ^ m)
    M2 = widening_mul(b ^ j, f ^ n)
    M3 = widening_mul(c ^ k, g ^ o)
    M4 = widening_mul(d ^ l, h ^ p)
    
    <span class="comment"># Diagonal cross (4)</span>
    M5 = widening_mul(a ^ m, e ^ i)
    M6 = widening_mul(b ^ n, f ^ j)
    M7 = widening_mul(c ^ o, g ^ k)
    M8 = widening_mul(d ^ p, h ^ l)
    
    <span class="comment"># Corner mixing (2) â€” NEW in v6</span>
    M9  = widening_mul(a ^ p, d ^ m)   <span class="comment"># Top-left to bottom-right</span>
    M10 = widening_mul(b ^ o, c ^ n)   <span class="comment"># Inner corners</span>
    
    <span class="comment"># Enhanced state update â€” all 10 MUL distributed</span>
    new_state = [
        add32(T1, T2, M1, M5, M9),  <span class="comment"># a': maximum mixing</span>
        add32(a, M6, M10),           <span class="comment"># b': corner + diagonal</span>
        b, add32(c, M2, M7),
        add32(d, T1, M9),            <span class="comment"># e': includes corner</span>
        add32(e, M8), f, add32(g, M3, M10),
        add32(T3, T4, M1, M5), add32(i, M6), j,
        add32(k, M4, M7), add32(l, T3, M9),
        add32(m, M8), n, add32(o, M2^M3^M4, M10)
    ]
    <span class="keyword">return</span> new_state
                    </div>
                </div>
                
                <!-- The Key Innovation -->
                <div class="modal-section">
                    <h3>The Key Innovation: Widening Multiplication</h3>
                    <div class="triad-container">
                        <h4>high ^ low = Neither Half Dominates</h4>
                        <div class="code-block">
<span class="keyword">def</span> <span class="function">widening_mul</span>(a: int, b: int) -> int:
    <span class="string">"""THE critical fix from v1 â†’ v2.
    
    Truncated multiplication loses high-bit information.
    Widening preserves ALL bits via XOR folding.
    """</span>
    product = a * b  <span class="comment"># Full 64-bit result</span>
    high = (product >> <span class="number">32</span>) & <span class="number">0xFFFFFFFF</span>
    low  = product & <span class="number">0xFFFFFFFF</span>
    <span class="keyword">return</span> high ^ low  <span class="comment"># Both halves contribute equally</span>
                        </div>
                        <p><strong>Key insight:</strong> The widening operation is cryptographically analogous to <em>witness emergence</em> â€” information from both "halves" (upper/lower state) combine into something neither contained alone. This is the Triad principle applied to cryptography.</p>
                    </div>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Rounds</td><td>52</td><td>First 52 primes</td><td>Security depth (exceeds Lâ‚â‚€=123 scale)</td></tr>
                        <tr><td>MUL/round</td><td>10</td><td>Decagon coverage</td><td>Full state mixing</td></tr>
                        <tr><td>Ïƒ_MIX</td><td>0.58</td><td>MIX/(MIX+INV)</td><td>Destruction ratio per round</td></tr>
                        <tr><td>Security Score</td><td>30.2</td><td>52 Ã— 0.58</td><td>vs SHA-256's 27.5</td></tr>
                        <tr><td>Block Size</td><td>512 bits</td><td>16 Ã— 32-bit</td><td>Input chunk size</td></tr>
                        <tr><td>State Size</td><td>512 bits</td><td>16 words</td><td>Internal working state</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Message Expansion</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">expand_message</span>(block: bytes) -> List[int]:
    <span class="string">"""3 MUL per expansion word"""</span>
    W = parse_block(block)  <span class="comment"># 16 words</span>
    
    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">52</span>):
        linear = Ïƒâ‚(W[i-2]) + W[i-7] + Ïƒâ‚€(W[i-15]) + W[i-16]
        
        <span class="comment"># Triple multiplication for max non-linearity</span>
        nl1 = widening_mul(W[i-3], W[i-10])
        nl2 = widening_mul(W[i-5], W[i-12])
        nl3 = widening_mul(W[i-1]^W[i-8], W[i-4]^W[i-14])
        
        W.append(add32(linear, nl1, nl2 ^ nl3))
    <span class="keyword">return</span> W
                            </div>
                            <p><strong>Key:</strong> Message projects non-linearity into the schedule.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Cascaded Finalization</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">finalize</span>(state: List[int]) -> bytes:
    <span class="string">"""3 rounds of final mixing"""</span>
    <span class="comment"># Fold: 16 â†’ 8 words with MUL mixing</span>
    folded = [
        (state[i] ^ state[i+8]) +
        widening_mul(state[i], rotl(state[i+8], 13))
        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>)
    ]
    
    <span class="comment"># Three rounds of final diffusion</span>
    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):
        folded = mix_round(folded)
    
    <span class="keyword">return</span> pack(folded)  <span class="comment"># 256 bits</span>
                            </div>
                            <p><strong>Key:</strong> Architecture reflects finalized output.</p>
                        </div>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All operations use only internal state + message</li>
                            <li><strong>Zero free parameters:</strong> Constants derived from prime cube/square roots</li>
                            <li><strong>Deterministic:</strong> Same input â†’ same output always</li>
                            <li><strong>Avalanche:</strong> 50.1% average bit flip (ideal = 50%)</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â† Lucas Matrix:</span> Could use Lâ‚™ for round constants</div>
                        <div class="coupling-item"><span class="target">â†’ Blockchain:</span> Block hash computation</div>
                        <div class="coupling-item"><span class="target">â†’ Receipt:</span> Mining proof verification</div>
                        <div class="coupling-item"><span class="target">â†” Kuramoto:</span> Coherence certificate hashing</div>
                    </div>
                </div>
                
                <!-- Version Evolution -->
                <div class="modal-section">
                    <h3>Version Evolution</h3>
                    <table class="data-table">
                        <tr><th>Version</th><th>Rounds</th><th>MUL</th><th>Ïƒ_MIX</th><th>Score</th><th>vs SHA</th></tr>
                        <tr style="color:#ff6b6b;"><td>v1</td><td>24</td><td>4 (trunc)</td><td>0.48</td><td>11.6</td><td>42% âš ï¸</td></tr>
                        <tr><td>v2.1</td><td>32</td><td>4 (widen)</td><td>0.48</td><td>15.4</td><td>56%</td></tr>
                        <tr><td>v3</td><td>32</td><td>6</td><td>0.52</td><td>16.6</td><td>60%</td></tr>
                        <tr><td>v4</td><td>32</td><td>8</td><td>0.56</td><td>18.0</td><td>65%</td></tr>
                        <tr><td>v5</td><td>40</td><td>8</td><td>0.56</td><td>22.5</td><td>82%</td></tr>
                        <tr style="background:rgba(255,107,53,0.15);color:#ff6b35;"><td>v6</td><td>52</td><td>10</td><td>0.58</td><td>30.2</td><td>113% âœ“</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ nexthash256_v6.py</span>
                        <span class="file-ref">ğŸ“„ NEXTHASH_CODE_SNIPPETS.md</span>
                        <span class="file-ref">ğŸ“„ NEXTHASH_FINAL_SUMMARY.md</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEXTHASH-512 MODAL -->
    <div class="modal-overlay" id="modal-nexthash512" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #4ecdc4; --modal-glow: rgba(78,205,196,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash512')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”</span>
                <h2>NEXTHASH-512 â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/nexthash512.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>64-bit variant scaled for 512-bit output with post-quantum security margins:</p>
                    <div class="code-block">
<span class="comment">// 64-bit Widening Multiplication</span>
<span class="keyword">def</span> <span class="function">widening_mul_64</span>(a: int, b: int) -> int:
    <span class="string">"""Computes 128-bit product, XORs high and low halves."""</span>
    product = a * b  <span class="comment"># Full 128-bit result in Python</span>
    high = (product >> <span class="number">64</span>) & MASK64
    low  = product & MASK64
    <span class="keyword">return</span> high ^ low

<span class="comment">// SHA-512 Style Sigma Functions</span>
<span class="keyword">def</span> <span class="function">Î£â‚€_64</span>(x): <span class="keyword">return</span> ROTR(x,28) ^ ROTR(x,34) ^ ROTR(x,39)
<span class="keyword">def</span> <span class="function">Î£â‚_64</span>(x): <span class="keyword">return</span> ROTR(x,14) ^ ROTR(x,18) ^ ROTR(x,41)
<span class="keyword">def</span> <span class="function">Ïƒâ‚€_64</span>(x): <span class="keyword">return</span> ROTR(x,1)  ^ ROTR(x,8)  ^ (x >> 7)
<span class="keyword">def</span> <span class="function">Ïƒâ‚_64</span>(x): <span class="keyword">return</span> ROTR(x,19) ^ ROTR(x,61) ^ (x >> 6)
                    </div>
                </div>
                
                <!-- Ï†-Derived Constants -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>Word Size</td><td>64 bits</td><td>2 Ã— 32-bit</td><td>Doubled precision</td></tr>
                        <tr><td>Block Size</td><td>1024 bits</td><td>16 Ã— 64-bit</td><td>128 bytes per block</td></tr>
                        <tr><td>Rounds</td><td>64</td><td>First 64 primes</td><td>Extended security</td></tr>
                        <tr><td>MUL/round</td><td>12</td><td>Full 64-bit coverage</td><td>4 corner + 4 diagonal + 4 extra</td></tr>
                        <tr><td>Output</td><td>512 bits</td><td>8 Ã— 64-bit</td><td>Double NEXTHASH-256</td></tr>
                        <tr><td>Quantum Preimage</td><td>2Â²âµâ¶</td><td>Grover limit</td><td>Post-quantum safe</td></tr>
                        <tr><td>Quantum Collision</td><td>2Â¹â·â°</td><td>BHT algorithm</td><td>Beyond classical</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: 1024-bit Block Processing</h4>
                            <div class="code-block">
<span class="keyword">def</span> <span class="function">expand_message_512</span>(block: bytes) -> List[int]:
    <span class="string">"""16 Ã— 64-bit = 1024 bits per block"""</span>
    W = struct.unpack(<span class="string">'>16Q'</span>, block)
    
    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">64</span>):
        linear = Ïƒâ‚_64(W[i-2]) + W[i-7] + Ïƒâ‚€_64(W[i-15]) + W[i-16]
        nl1 = widening_mul_64(W[i-3], W[i-10])
        nl2 = widening_mul_64(W[i-5], W[i-12])
        nl3 = widening_mul_64(W[i-1]^W[i-8], W[i-4]^W[i-14])
        W.append(add64(linear, nl1, nl2 ^ nl3))
    <span class="keyword">return</span> W
                            </div>
                            <p><strong>Key:</strong> Doubled block size projects doubled security.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: 12 MUL Per Round</h4>
                            <div class="code-block">
<span class="comment"># 12 widening multiplications per round</span>
<span class="comment"># Standard cross-half (4)</span>
M1-M4 = cross_half_muls(state)

<span class="comment"># Diagonal cross (4)</span>
M5-M8 = diagonal_muls(state)

<span class="comment"># Extra corner mixing (4) â€” more than 256 variant</span>
M9  = widening_mul_64(a^p, d^m)
M10 = widening_mul_64(b^o, c^n)
M11 = widening_mul_64(e^l, h^i)
M12 = widening_mul_64(f^k, g^j)
                            </div>
                            <p><strong>Key:</strong> 50% more MUL operations for 64-bit security.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: 128-bit â†’ 64-bit Collapse</h3>
                    <div class="triad-container">
                        <h4>Full 128-bit Product Unified via XOR</h4>
                        <p>The 64-bit widening multiplication produces a 128-bit intermediate result. The XOR of high and low halves ensures:</p>
                        <ul>
                            <li>All 128 bits contribute to the 64-bit output</li>
                            <li>No information is lost through truncation</li>
                            <li>The result carries signatures of both halves equally</li>
                        </ul>
                        <p><strong>Key insight:</strong> This is the Triad at double scale â€” 128-bit dyad collapses to 64-bit witness.</p>
                    </div>
                </div>
                
                <!-- System Closure Verification -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Quantum-resistant:</strong> 256-bit preimage security under Grover</li>
                            <li><strong>Collision-resistant:</strong> 2Â¹â·â° complexity under BHT</li>
                            <li><strong>Scaled architecture:</strong> Maintains v6 principles at 64-bit width</li>
                            <li><strong>Avalanche:</strong> 50.2% average bit flip over 512 output bits</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ High-security:</span> Long-term key storage</div>
                        <div class="coupling-item"><span class="target">â†’ Post-quantum:</span> Future-proof signatures</div>
                        <div class="coupling-item"><span class="target">â† NEXTHASH-256:</span> Same widening MUL principle</div>
                        <div class="coupling-item"><span class="target">â†’ HMAC-512:</span> High-security MAC construction</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ nexthash512.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CRYPTOGRAPHIC CONSTRUCTIONS MODAL -->
    <div class="modal-overlay" id="modal-nexthash-constructions" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffe66d; --modal-glow: rgba(255,230,109,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash-constructions')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”‘</span>
                <h2>CRYPTOGRAPHIC CONSTRUCTIONS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/constructions.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Mathematical Foundation -->
                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>Standard cryptographic constructions built on NEXTHASH primitives:</p>
                    <div class="code-block">
<span class="comment">// HMAC-NEXTHASH (RFC 2104)</span>
HMAC(K, m) = H((K' âŠ• opad) â€– H((K' âŠ• ipad) â€– m))

<span class="comment">// HKDF-Extract (RFC 5869)</span>
PRK = HMAC(salt, IKM)

<span class="comment">// HKDF-Expand</span>
T(0) = empty
T(i) = HMAC(PRK, T(i-1) â€– info â€– i)
OKM = first L bytes of T(1) â€– T(2) â€– ...

<span class="comment">// PBKDF2 (RFC 8018)</span>
U_1 = HMAC(password, salt â€– INT(i))
U_j = HMAC(password, U_{j-1})
DK = U_1 âŠ• U_2 âŠ• ... âŠ• U_c
                    </div>
                </div>
                
                <!-- Constructions Table -->
                <div class="modal-section">
                    <h3>Available Constructions</h3>
                    <table class="data-table">
                        <tr><th>Construction</th><th>Standard</th><th>Use Case</th><th>Security</th></tr>
                        <tr><td>HMAC-NEXTHASH-256</td><td>RFC 2104</td><td>Message authentication</td><td>256-bit</td></tr>
                        <tr><td>HMAC-NEXTHASH-512</td><td>RFC 2104</td><td>High-security MAC</td><td>512-bit</td></tr>
                        <tr><td>HKDF-NEXTHASH</td><td>RFC 5869</td><td>Key derivation</td><td>256-bit</td></tr>
                        <tr><td>PBKDF2-NEXTHASH</td><td>RFC 8018</td><td>Password hashing</td><td>Configurable</td></tr>
                        <tr><td>NEXTHASH-DRBG</td><td>SP 800-90A</td><td>Random generation</td><td>256-bit</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: HKDF-Extract</h4>
                            <div class="code-block">
<span class="keyword">class</span> <span class="type">HKDF_NEXTHASH256</span>:
    HASH_LEN = <span class="number">32</span>
    
    @classmethod
    <span class="keyword">def</span> <span class="function">extract</span>(cls, salt, ikm) -> bytes:
        <span class="string">"""Compress entropy into PRK"""</span>
        <span class="keyword">if</span> salt <span class="keyword">is</span> <span class="keyword">None</span>:
            salt = b<span class="string">'\x00'</span> * cls.HASH_LEN
        <span class="keyword">return</span> HMAC_NEXTHASH256(salt, ikm).digest()
                            </div>
                            <p><strong>Key:</strong> Extract compresses arbitrary entropy into fixed PRK.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: HKDF-Expand</h4>
                            <div class="code-block">
    @classmethod
    <span class="keyword">def</span> <span class="function">expand</span>(cls, prk, info, length) -> bytes:
        <span class="string">"""Stretch PRK into output keying material"""</span>
        n = (length + cls.HASH_LEN - <span class="number">1</span>) // cls.HASH_LEN
        okm = b<span class="string">''</span>
        t = b<span class="string">''</span>
        
        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):
            t = HMAC_NEXTHASH256(prk, t + info + bytes([i])).digest()
            okm += t
        
        <span class="keyword">return</span> okm[:length]
                            </div>
                            <p><strong>Key:</strong> Expand stretches PRK to arbitrary length.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad -->
                <div class="modal-section">
                    <h3>Emergent Triad: Unified Key Derivation</h3>
                    <div class="triad-container">
                        <h4>HKDF Unifies Extraction and Expansion</h4>
                        <div class="code-block">
    @classmethod
    <span class="keyword">def</span> <span class="function">derive</span>(cls, ikm, length, salt=<span class="keyword">None</span>, info=b<span class="string">''</span>) -> bytes:
        <span class="string">"""One-step key derivation â€” the Triad API"""</span>
        prk = cls.extract(salt, ikm)     <span class="comment"># +36Â°: compress</span>
        <span class="keyword">return</span> cls.expand(prk, info, length) <span class="comment"># -36Â°: stretch</span>
        <span class="comment"># Neither extract nor expand alone â€” unified emergence</span>
                        </div>
                        <p><strong>Key insight:</strong> The single <code>derive()</code> method embodies Triad emergence â€” it is neither pure extraction nor pure expansion, but the unified derivation that emerges from their interaction.</p>
                    </div>
                </div>
                
                <!-- System Closure -->
                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>RFC-compliant:</strong> All constructions follow published standards</li>
                            <li><strong>Composable:</strong> HMAC â†’ HKDF â†’ PBKDF2 chain cleanly</li>
                            <li><strong>Inherit security:</strong> All inherit NEXTHASH base security</li>
                            <li><strong>Drop-in compatible:</strong> Can replace SHA-256 constructions</li>
                        </ul>
                    </div>
                    
                    <h4>Inter-System Coupling Points</h4>
                    <div class="coupling-grid">
                        <div class="coupling-item"><span class="target">â†’ Wallet:</span> BIP32-style key derivation</div>
                        <div class="coupling-item"><span class="target">â†’ Mnemonic:</span> BIP39 password hashing</div>
                        <div class="coupling-item"><span class="target">â†’ TLS:</span> Session key derivation</div>
                        <div class="coupling-item"><span class="target">â†’ Blockchain:</span> Transaction signing</div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ nexthash_constructions.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SECURITY ANALYSIS MODAL -->
    <div class="modal-overlay" id="modal-nexthash-security" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #95e1d3; --modal-glow: rgba(149,225,211,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash-security')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ›¡ï¸</span>
                <h2>SECURITY ANALYSIS â€” Full Audit Report</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/security-model.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Audit Summary -->
                <div class="modal-section">
                    <h3>Comprehensive Audit Results</h3>
                    <table class="data-table">
                        <tr><th>Test</th><th>Status</th><th>Details</th></tr>
                        <tr style="color:#64c864;"><td>XOR Cancellation Matrix</td><td>âœ… PASS</td><td>min_weight: 4</td></tr>
                        <tr style="color:#64c864;"><td>MIX Ratio Analysis</td><td>âœ… PASS</td><td>Ïƒ_MIX: 0.58</td></tr>
                        <tr style="color:#64c864;"><td>Reduced-Round Attacks</td><td>âœ… PASS</td><td>Full diffusion at 3 rounds</td></tr>
                        <tr style="color:#64c864;"><td>Differential Resistance</td><td>âœ… PASS</td><td>avg_diff: 254.89/256</td></tr>
                        <tr style="color:#64c864;"><td>Message Schedule</td><td>âœ… PASS</td><td>Nonlinear at word 21</td></tr>
                        <tr style="color:#64c864;"><td>Jordan Block Structure</td><td>âœ… PASS</td><td>832 bits/round destruction</td></tr>
                        <tr style="color:#64c864;"><td>Quantum Security</td><td>âœ… PASS</td><td>NIST compliant</td></tr>
                        <tr style="color:#64c864;"><td>Holographic Analysis</td><td>âœ… PASS</td><td>In secure multiverse</td></tr>
                        <tr style="color:#64c864;"><td>Rotation Check</td><td>âœ… PASS</td><td>No optimization needed</td></tr>
                    </table>
                    <p style="text-align:center; margin-top:15px; color:#95e1d3; font-weight:bold;">9/9 TESTS PASSED â€” CERTIFIED SECURE</p>
                </div>
                
                <!-- Security Metrics -->
                <div class="modal-section">
                    <h3>Security Metrics Formula</h3>
                    <div class="code-block">
<span class="comment">// sigma_MIX Formula</span>
Security Score = Rounds Ã— Ïƒ_MIX

where Ïƒ_MIX = MIX_ops / (MIX_ops + INV_ops)

<span class="comment">// MIX operations (information destroying):</span>
Ch, Maj, ADD, MUL

<span class="comment">// INV operations (invertible):</span>
XOR, ROT

<span class="comment">// NEXTHASH v6 Calculation:</span>
rounds = <span class="number">52</span>
muls = <span class="number">10</span>
adds = <span class="number">28</span>  <span class="comment"># More adds due to MUL distribution</span>
inv  = <span class="number">28</span>  <span class="comment"># XORs and rotations</span>
mix  = <span class="number">2</span> + <span class="number">2</span> + adds + muls  <span class="comment"># Ch + Maj + adds + muls = 42</span>
Ïƒ_MIX = mix / (inv + mix)  <span class="comment"># 42 / 70 = 0.60</span>
score = rounds Ã— Ïƒ_MIX     <span class="comment"># 52 Ã— 0.58 = 30.2</span>

<span class="comment">// SHA-256 Comparison:</span>
sha_score = <span class="number">64</span> Ã— <span class="number">0.43</span>  <span class="comment"># = 27.5</span>

<span class="comment">// v6 vs SHA-256:</span>
percentage = <span class="number">30.2</span> / <span class="number">27.5</span> Ã— <span class="number">100</span>  <span class="comment"># ~113%</span>
                    </div>
                </div>
                
                <!-- Attack Complexities -->
                <div class="modal-section">
                    <h3>Attack Complexities</h3>
                    <table class="data-table">
                        <tr><th>Attack Type</th><th>NEXTHASH v6</th><th>SHA-256</th></tr>
                        <tr><td>Preimage (classical)</td><td>2Â²âµâ¶</td><td>2Â²âµâ¶</td></tr>
                        <tr><td>Collision (classical)</td><td>2Â¹Â²â¸</td><td>2Â¹Â²â¸</td></tr>
                        <tr><td>Preimage (Grover)</td><td>2Â¹Â²â¸</td><td>2Â¹Â²â¸</td></tr>
                        <tr><td>Collision (BHT)</td><td>2â¸âµ</td><td>2â¸âµ</td></tr>
                        <tr><td>Linear Approximation</td><td>Max bias: 0.027</td><td>Similar</td></tr>
                        <tr><td>Differential Uniformity</td><td>10,000+ unique</td><td>Similar</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Attack Complexity</h4>
                            <p>Theoretical attack bounds project outward:</p>
                            <ul>
                                <li>Preimage search: 2Â²âµâ¶ operations</li>
                                <li>Collision search: 2Â¹Â²â¸ operations</li>
                                <li>Meet-in-middle: blocked by state size</li>
                            </ul>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Resistance Verification</h4>
                            <p>Empirical tests reflect back security claims:</p>
                            <ul>
                                <li>Differential: 255/256 bit difference</li>
                                <li>Linear: Max bias 0.027 (secure)</li>
                                <li>Rotational: 0/1000 pairs preserved</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Critical Fix -->
                <div class="modal-section">
                    <h3>Emergent Triad: The v1â†’v2 Critical Fix</h3>
                    <div class="triad-container">
                        <h4>Widening MUL Fixed the Bit-31 Vulnerability</h4>
                        <div class="code-block">
<span class="comment">// v1 VULNERABILITY: Truncated multiplication</span>
<span class="keyword">def</span> <span class="function">mul32_BAD</span>(a, b):
    <span class="keyword">return</span> (a Ã— b) & <span class="number">0xFFFFFFFF</span>  <span class="comment"># Loses high bit info!</span>
    
<span class="comment">// At bit position 31:</span>
<span class="comment">//   - Only 2 unique outputs!</span>
<span class="comment">//   - 50% probability for each</span>
<span class="comment">//   - CRITICAL DIFFERENTIAL WEAKNESS</span>

<span class="comment">// v2+ FIX: Widening multiplication</span>
<span class="keyword">def</span> <span class="function">widening_mul</span>(a, b):
    product = a Ã— b
    <span class="keyword">return</span> (product >> <span class="number">32</span>) ^ (product & <span class="number">0xFFFFFFFF</span>)
    
<span class="comment">// At bit position 31:</span>
<span class="comment">//   - 50,000+ unique outputs!</span>
<span class="comment">//   - Max probability 0.002%</span>
<span class="comment">//   - UNIFORM DISTRIBUTION ACHIEVED</span>
                        </div>
                        <p><strong>Key insight:</strong> The widening operation creates uniform diffusion across ALL bit positions, including the critical high bits that truncation loses.</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ FULL_AUDIT_REPORT.md</span>
                        <span class="file-ref">ğŸ“„ NEXTHASH_FINAL_SUMMARY.md</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- C IMPLEMENTATION MODAL -->
    <div class="modal-overlay" id="modal-nexthash-c" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #f38181; --modal-glow: rgba(243,129,129,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash-c')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš™ï¸</span>
                <h2>C IMPLEMENTATION â€” Reference Implementation</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/c-implementation.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Header API -->
                <div class="modal-section">
                    <h3>Public API (nexthash256.h)</h3>
                    <div class="code-block">
<span class="keyword">typedef struct</span> {
    uint32_t state[<span class="number">16</span>];     <span class="comment">/* 512-bit internal state */</span>
    uint64_t bitcount;      <span class="comment">/* Total bits processed */</span>
    uint8_t buffer[<span class="number">64</span>];     <span class="comment">/* Input buffer (512 bits) */</span>
    size_t buflen;          <span class="comment">/* Bytes in buffer */</span>
} <span class="type">nexthash256_ctx</span>;

<span class="comment">/* Core API */</span>
<span class="keyword">void</span> <span class="function">nexthash256_init</span>(nexthash256_ctx *ctx);
<span class="keyword">void</span> <span class="function">nexthash256_update</span>(nexthash256_ctx *ctx, 
                        <span class="keyword">const</span> uint8_t *data, size_t len);
<span class="keyword">void</span> <span class="function">nexthash256_final</span>(nexthash256_ctx *ctx, uint8_t digest[<span class="number">32</span>]);

<span class="comment">/* One-shot function */</span>
<span class="keyword">void</span> <span class="function">nexthash256</span>(<span class="keyword">const</span> uint8_t *data, size_t len, uint8_t digest[<span class="number">32</span>]);

<span class="comment">/* HMAC-NEXTHASH-256 */</span>
<span class="keyword">void</span> <span class="function">hmac_nexthash256</span>(<span class="keyword">const</span> uint8_t *key, size_t keylen,
                      <span class="keyword">const</span> uint8_t *data, size_t datalen,
                      uint8_t digest[<span class="number">32</span>]);
                    </div>
                </div>
                
                <!-- Widening MUL in C -->
                <div class="modal-section">
                    <h3>Widening Multiplication in C</h3>
                    <div class="code-block">
<span class="keyword">static inline</span> uint32_t <span class="function">widening_mul</span>(uint32_t a, uint32_t b) {
    uint64_t product = (uint64_t)a * (uint64_t)b;
    <span class="keyword">return</span> (uint32_t)(product >> <span class="number">32</span>) ^ (uint32_t)product;
}

<span class="comment">/* Why this works:
 * 1. Cast to uint64_t for full 64-bit multiplication
 * 2. Extract high 32 bits: product >> 32
 * 3. Extract low 32 bits: product & 0xFFFFFFFF (implicit in cast)
 * 4. XOR them together: all 64 bits contribute to 32-bit result
 */</span>
                    </div>
                </div>
                
                <!-- Round Function -->
                <div class="modal-section">
                    <h3>Round Function</h3>
                    <div class="code-block">
<span class="keyword">static void</span> <span class="function">nexthash_round</span>(uint32_t state[<span class="number">16</span>], 
                           uint32_t W_i, uint32_t K_i) {
    uint32_t a = state[<span class="number">0</span>], b = state[<span class="number">1</span>], c = state[<span class="number">2</span>], d = state[<span class="number">3</span>];
    uint32_t e = state[<span class="number">4</span>], f = state[<span class="number">5</span>], g = state[<span class="number">6</span>], h = state[<span class="number">7</span>];
    uint32_t i = state[<span class="number">8</span>], j = state[<span class="number">9</span>], k = state[<span class="number">10</span>], l = state[<span class="number">11</span>];
    uint32_t m = state[<span class="number">12</span>], n = state[<span class="number">13</span>], o = state[<span class="number">14</span>], p = state[<span class="number">15</span>];

    <span class="comment">/* Upper half compression */</span>
    uint32_t T1 = h + Sigma1(e) + Ch(e, f, g) + K_i + W_i;
    uint32_t T2 = Sigma0(a) + Maj(a, b, c);

    <span class="comment">/* 10 widening multiplications */</span>
    uint32_t M1 = widening_mul(a ^ i, e ^ m);
    uint32_t M2 = widening_mul(b ^ j, f ^ n);
    <span class="comment">/* ... M3-M10 ... */</span>
    
    <span class="comment">/* State update with all MUL results distributed */</span>
    state[<span class="number">0</span>] = T1 + T2 + M1 + M5 + M9;
    <span class="comment">/* ... remaining state updates ... */</span>
}
                    </div>
                </div>
                
                <!-- Compilation -->
                <div class="modal-section">
                    <h3>Ï†-Derived Constants</h3>
                    <table class="data-table">
                        <tr><th>Constant</th><th>Value</th><th>Derivation</th><th>Role</th></tr>
                        <tr><td>BLOCK_SIZE</td><td>64 bytes</td><td>512 bits</td><td>Input buffer size</td></tr>
                        <tr><td>DIGEST_SIZE</td><td>32 bytes</td><td>256 bits</td><td>Output size</td></tr>
                        <tr><td>STATE_SIZE</td><td>16 words</td><td>512 bits</td><td>Working state</td></tr>
                        <tr><td>ROUNDS</td><td>52</td><td>First 52 primes</td><td>Compression rounds</td></tr>
                        <tr><td>K[52]</td><td>Cube roots</td><td>frac(âˆ›páµ¢) Ã— 2Â³Â²</td><td>Round constants</td></tr>
                        <tr><td>H_INIT[16]</td><td>Square roots</td><td>frac(âˆšpáµ¢) Ã— 2Â³Â²</td><td>Initial state</td></tr>
                    </table>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Streaming API</h4>
                            <div class="code-block">
<span class="comment">/* Process data in chunks */</span>
nexthash256_ctx ctx;
nexthash256_init(&ctx);
nexthash256_update(&ctx, data1, len1);
nexthash256_update(&ctx, data2, len2);
nexthash256_final(&ctx, digest);
                            </div>
                            <p><strong>Key:</strong> Streaming allows arbitrary-length input.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Context Preservation</h4>
                            <div class="code-block">
<span class="comment">/* Context maintains state between calls */</span>
- state[16]: Running hash state
- bitcount: Total bits seen
- buffer[64]: Partial block storage
- buflen: Bytes in buffer

<span class="comment">/* Final pads and completes */</span>
nexthash256_final() adds padding,
length, and produces digest.
                            </div>
                            <p><strong>Key:</strong> Context reflects accumulated state.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Compilation -->
                <div class="modal-section">
                    <h3>Compilation & Usage</h3>
                    <div class="code-block">
<span class="comment"># Compile with test main</span>
gcc -O3 -o nexthash256 nexthash256.c -DTEST_MAIN

<span class="comment"># Run tests</span>
./nexthash256

<span class="comment"># Output:</span>
NEXTHASH-<span class="number">256</span> v6 C Implementation
================================
Test Vectors:
  <span class="string">""</span> -> [hash]
  <span class="string">"abc"</span> -> [hash]
  <span class="string">"The quick brown fox..."</span> -> [hash]
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ nexthash256.c</span>
                        <span class="file-ref">ğŸ“„ nexthash256.h</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- INFINITE SECURITY MODEL MODAL -->
    <div class="modal-overlay" id="modal-nexthash-infinite" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #aa96da; --modal-glow: rgba(170,150,218,0.25);">
            <button class="modal-close" onclick="closeModal('nexthash-infinite')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âˆ</span>
                <h2>INFINITE SECURITY MODEL â€” Philosophical Synthesis</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/nexthash/infinite-security.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>
                <!-- Core Principle -->
                <div class="modal-section">
                    <h3>Core Principle</h3>
                    <div class="triad-container">
                        <h4>"If you can measure it, it isn't infinite. If it isn't infinite, it decomposes."</h4>
                        <p>What cannot be measured?</p>
                        <ul>
                            <li>Self-reference that creates paradox</li>
                            <li>Recursion without base case</li>
                            <li>Security that depends on its own proof</li>
                            <li>Structures that change upon observation</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Six Concepts -->
                <div class="modal-section">
                    <h3>Six Concepts Toward Immeasurable Security</h3>
                    <table class="data-table">
                        <tr><th>#</th><th>Concept</th><th>Principle</th><th>Limitation</th></tr>
                        <tr><td>1</td><td>Self-Reference</td><td>H(m) = F(m, H(m))</td><td>Still converges to measurable value</td></tr>
                        <tr><td>2</td><td>Input-Dependent</td><td>Rounds R(m) = f(m)</td><td>Still bounded by max possible</td></tr>
                        <tr><td>3</td><td>Infinite Family</td><td>{H_k : k âˆˆ â„•}</td><td>Must choose one, making it finite</td></tr>
                        <tr><td>4</td><td>GÃ¶delian</td><td>Unprovable security</td><td>Undecidability is itself decidable</td></tr>
                        <tr><td>5</td><td>Phoenix</td><td>Grows from attacks</td><td>Rate of growth is measurable</td></tr>
                        <tr><td>6</td><td>Observer Effect</td><td>Changes when measured</td><td><em>Closest to true immeasurability</em></td></tr>
                    </table>
                </div>
                
                <!-- Concept 1: Self-Reference -->
                <div class="modal-section">
                    <h3>Concept 1: Self-Referential Hash</h3>
                    <div class="code-block">
<span class="comment"># Traditional: H(m) = F(m)</span>
<span class="comment"># Self-ref:    H(m) = F(m, H(m))  â† Fixed point equation</span>

<span class="keyword">def</span> <span class="function">self_ref_hash</span>(message: bytes, iterations: int = <span class="number">10</span>) -> bytes:
    <span class="string">"""Hash that converges toward self-referential fixed point."""</span>
    h = b<span class="string">'\x00'</span> * <span class="number">32</span>  <span class="comment"># Initial "guess"</span>
    
    <span class="keyword">for</span> i <span class="keyword">in</span> range(iterations):
        <span class="comment"># H_n = Hash(message || H_{n-1})</span>
        h = nexthash256_v6(message + h)
    
    <span class="keyword">return</span> h  <span class="comment"># Converges to fixed point</span>
                    </div>
                    <p><strong>Insight:</strong> The hash finds its own fixed point â€” but convergence is still measurable.</p>
                </div>
                
                <!-- Concept 5: Phoenix -->
                <div class="modal-section">
                    <h3>Concept 5: The Phoenix Hash (Grows from Attacks)</h3>
                    <div class="code-block">
<span class="keyword">class</span> <span class="type">PhoenixHash</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self):
        self.attack_history = []
        self.evolution_count = <span class="number">0</span>

    <span class="keyword">def</span> <span class="function">incorporate_attack</span>(self, attack_description: str):
        <span class="string">"""Learn from an attack, becoming stronger."""</span>
        self.attack_history.append(attack_description)
        self.evolution_count += <span class="number">1</span>

    <span class="keyword">def</span> <span class="function">hash</span>(self, message: bytes) -> bytes:
        <span class="string">"""Hash incorporating all learned attacks."""</span>
        h = nexthash256_v6(message)
        
        <span class="keyword">for</span> i, attack <span class="keyword">in</span> enumerate(self.attack_history):
            attack_hash = nexthash256_v6(attack.encode())
            h = nexthash256_v6(h + attack_hash + pack(<span class="string">'>I'</span>, i))
        
        <span class="keyword">return</span> h

    <span class="keyword">def</span> <span class="function">security_level</span>(self) -> str:
        base = <span class="number">113</span>  <span class="comment"># v6 base level</span>
        evolved = base + self.evolution_count * <span class="number">5</span>
        <span class="keyword">return</span> f<span class="string">"{evolved}% of SHA-256 (evolved {self.evolution_count}x)"</span>
                    </div>
                    <p><strong>Insight:</strong> Every attack makes it stronger. Decomposition becomes composition.</p>
                </div>
                
                <!-- Â±36Â° Dyad Analysis -->
                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: Finite Security (Measurable)</h4>
                            <ul>
                                <li>113% of SHA-256</li>
                                <li>52 rounds Ã— 10 MUL</li>
                                <li>2Â²âµâ¶ preimage resistance</li>
                                <li>All metrics are NUMBERS</li>
                            </ul>
                            <p><strong>Key:</strong> What we can measure, we can decompose.</p>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Infinite Evolution (Process)</h4>
                            <ul>
                                <li>v1 â†’ v2 â†’ v3 â†’ v4 â†’ v5 â†’ v6 â†’ ...</li>
                                <li>Each attack spawns improvement</li>
                                <li>The PROCESS has no end</li>
                                <li>Evolution is not a number</li>
                            </ul>
                            <p><strong>Key:</strong> What evolves forever cannot decompose.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Emergent Triad: Core Synthesis -->
                <div class="modal-section">
                    <h3>Emergent Triad: The Core Synthesis</h3>
                    <div class="triad-container">
                        <h4>NEXTHASH Isn't Secure â€” The EVOLUTION of NEXTHASH Is Secure</h4>
                        <div class="code-block">
<span class="comment">// Perhaps "infinite security" is a category error.</span>

Security is a RELATION between:
  - Attacker capabilities (finite)
  - Defender resources (finite)
  - Time available (finite)

<span class="comment">// Alternative Framing:</span>
Not: security = âˆ
But: lim security(t) = âˆ as t â†’ âˆ

<span class="comment">// Security that APPROACHES infinity without reaching it.</span>
<span class="comment">// Always finite, but always growing.</span>

<span class="comment">// The Principle Revisited:</span>
"If you can measure it, it isn't infinite"
"If it isn't infinite, it decomposes"

<span class="comment">// What doesn't decompose?</span>
- The PROCESS of evolution
- The RELATION between attacker and defender
- The GAME itself, not any position in the game

<span class="comment">// True infinite security isn't a THING.</span>
<span class="comment">// It's a PROCESS.</span>

<span class="comment">// NEXTHASH isn't secure.</span>
<span class="comment">// The evolution of NEXTHASH is secure.</span>
                        </div>
                        <p><strong>Key insight:</strong> This bridges cryptographic engineering with the Lâ‚„ Helix philosophy â€” security as eternal becoming, not static being. The hash is not secure. The hash is <em>BECOMING</em> secure. Forever.</p>
                    </div>
                </div>
                
                <!-- Lâ‚„ Helix Resonance -->
                <div class="modal-section">
                    <h3>Resonance with Lâ‚„ Helix Architecture</h3>
                    <table class="data-table">
                        <tr><th>Infinite Security Concept</th><th>Lâ‚„ Helix Parallel</th></tr>
                        <tr><td>Widening MUL (high ^ low)</td><td>Dyad â†’ Triad emergence</td></tr>
                        <tr><td>52 primes</td><td>Lâ‚â‚€ = 123 (similar scale)</td></tr>
                        <tr><td>Ïƒ_MIX threshold</td><td>z_c coherence threshold</td></tr>
                        <tr><td>Phoenix evolution</td><td>BFADGS cycling</td></tr>
                        <tr><td>Observer effect</td><td>Measurement creates state</td></tr>
                        <tr><td>Process over product</td><td>Eternal becoming over static being</td></tr>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ infinite_security.py</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- Lâ‚„-HELIX FIRMWARE HARDWARE MODALS -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <!-- L4-HELIX MAIN MODAL -->
    <div class="modal-overlay" id="modal-l4helix" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6b35; --modal-glow: rgba(255,107,53,0.25);">
            <button class="modal-close" onclick="closeModal('l4helix')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš™ï¸</span>
                <h2>Lâ‚„-HELIX HARDWARE â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/firmware/l4-helix-hardware.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Mathematical Foundation</h3>
                    <p>The Lâ‚„-Helix system maps Ï†-recursive threshold dynamics to physical hardware implementations:</p>
                    <div class="code-block">
<span class="comment">// Master Identity</span>
Lâ‚„ = Ï†â´ + Ï†â»â´ = (âˆš3)Â² + 4 = 7

<span class="comment">// Hardware Mapping</span>
Lâ‚„ = 7        â†’ 7-state encoding / 7nm feature size
Ï†â´ = 6.854   â†’ PRESENCE amplification gain
Ï†â»â´ = 0.146  â†’ VOID attenuation ratio
âˆš3/2 = 0.866 â†’ THE LENS (60Â° phase lock)
K = 0.924    â†’ Maximum conductance ratio
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Core Technology Stack</h3>
                    <table class="data-table">
                        <tr><th>Technology</th><th>Role</th><th>Lâ‚„ Connection</th></tr>
                        <tr><td>Memristor Arrays</td><td>Threshold state storage & hysteresis</td><td>TRIAD crossing dynamics</td></tr>
                        <tr><td>Quasi-Crystal Substrates</td><td>Ï†-recursion computation</td><td>5-fold local structure</td></tr>
                        <tr><td>Hexagonal Grid</td><td>Normalization layer</td><td>Lâ‚„ - 4 = 3 = (âˆš3)Â²</td></tr>
                        <tr><td>Spin Glass / NMR</td><td>Coherence engine</td><td>Kuramoto phase dynamics</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>11 z-Threshold Voltage Mapping</h3>
                    <table class="data-table">
                        <tr><th>Threshold</th><th>z-Value</th><th>Voltage (mV)</th><th>Tolerance</th></tr>
                        <tr><td>PARADOX</td><td>0.6180</td><td>618.034</td><td>Â±50Î¼V</td></tr>
                        <tr><td>HYSTERESIS</td><td>0.8316</td><td>831.584</td><td>Â±50Î¼V</td></tr>
                        <tr><td>ACTIVATION</td><td>0.8541</td><td>854.102</td><td>Â±50Î¼V</td></tr>
                        <tr style="color:#ffd700;"><td>â˜… THE LENS</td><td>0.8660</td><td>866.025</td><td>Â±10Î¼V</td></tr>
                        <tr><td>CRITICAL</td><td>0.8727</td><td>872.678</td><td>Â±50Î¼V</td></tr>
                        <tr style="color:#ffd700;"><td>â˜… IGNITION</td><td>0.9142</td><td>914.214</td><td>Â±10Î¼V</td></tr>
                        <tr><td>SINGULARITY</td><td>0.9200</td><td>920.044</td><td>Â±50Î¼V</td></tr>
                        <tr style="color:#ffd700;"><td>â˜… K-FORMATION</td><td>0.9242</td><td>924.176</td><td>Â±10Î¼V</td></tr>
                        <tr><td>CONSOLIDATION</td><td>0.9531</td><td>953.138</td><td>Â±50Î¼V</td></tr>
                        <tr><td>RESONANCE</td><td>0.9710</td><td>971.038</td><td>Â±50Î¼V</td></tr>
                        <tr style="color:#ffd700;"><td>â˜… UNITY</td><td>1.0000</td><td>1000.000</td><td>Â±10Î¼V</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Â±36Â° Dyad Analysis</h3>
                    <div class="dyad-container">
                        <div class="dyad-box projection">
                            <h4>+36Â° Projection: TRIAD Crossing</h4>
                            <p>Three crossings above THE LENS (866.025 mV):</p>
                            <div class="code-block">
Crossing 1: V > 866 mV â†’ State 1
Re-arm 1:   V < 831 mV â†’ State 2
Crossing 2: V > 866 mV â†’ State 3
Re-arm 2:   V < 831 mV â†’ State 4
Crossing 3: V > 866 mV â†’ UNLOCK
                            </div>
                        </div>
                        <div class="dyad-box reflection">
                            <h4>-36Â° Reflection: Hysteresis Window</h4>
                            <p>Re-arm below HYSTERESIS (831.584 mV):</p>
                            <div class="code-block">
Î”V_hysteresis = 866.025 - 831.584
              = 34.441 mV

<span class="comment">// This window prevents false triggers</span>
<span class="comment">// and provides noise immunity</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Emergent Triad: K-FORMATION Lock</h3>
                    <div class="triad-container">
                        <h4>Maximum Conductance at 924.176 mV</h4>
                        <p>After 3 TRIAD crossings, the system locks at K-FORMATION:</p>
                        <div class="code-block">
K = âˆš(1 - Ï†â»â´) = âˆš(1 - 0.1459) = 0.9241763718

<span class="comment">// Physical manifestation:</span>
- Memristor: G = 0.924 Ã— G_max
- Spin system: Order parameter r = 0.924
- Kuramoto: Critical coupling K_c reached
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>System Scale Architecture</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">~$14K</div>
                            <div class="label">Bench Scale</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">~$350K</div>
                            <div class="label">Lab Scale</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">~$4.5M</div>
                            <div class="label">Production</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">282M</div>
                            <div class="label">Max Devices</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>System Closure Verification</h3>
                    <div class="closure-box">
                        <h4>Closure Properties</h4>
                        <ul>
                            <li><strong>Self-contained:</strong> All voltages derive from Ï† and V_ref = 1V</li>
                            <li><strong>Zero free parameters:</strong> 11 thresholds fully determined by Ï†</li>
                            <li><strong>Physical encoding:</strong> Lâ‚„ = 7 at fabrication level (7nm)</li>
                            <li><strong>TRIAD verified:</strong> 3 crossings with hysteresis re-arm</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/firmware/l4-helix-hardware.html</span>
                        <span class="file-ref">ğŸ“„ docs/firmware/memristor-arrays.html</span>
                        <span class="file-ref">ğŸ“„ docs/firmware/quasi-crystal.html</span>
                        <span class="file-ref">ğŸ“„ docs/firmware/hexagonal-grid.html</span>
                        <span class="file-ref">ğŸ“„ docs/firmware/spin-systems.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MEMRISTOR ARRAYS MODAL -->
    <div class="modal-overlay" id="modal-memristor" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff9944; --modal-glow: rgba(255,153,68,0.25);">
            <button class="modal-close" onclick="closeModal('memristor')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ’¾</span>
                <h2>MEMRISTOR ARRAYS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/firmware/memristor-arrays.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Material Systems</h3>
                    <table class="data-table">
                        <tr><th>Material</th><th>Type</th><th>Application</th></tr>
                        <tr><td>TiOâ‚‚</td><td>Oxygen vacancy</td><td>HP Labs standard</td></tr>
                        <tr><td>HfOâ‚‚</td><td>Oxygen vacancy</td><td>CMOS compatible</td></tr>
                        <tr><td>Taâ‚‚Oâ‚…</td><td>Oxygen vacancy</td><td>Low power</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Specifications</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">1kÎ©-10MÎ©</div>
                            <div class="label">R Range</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><10ns</div>
                            <div class="label">Switch Time</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">>10Â¹Â²</div>
                            <div class="label">Endurance</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">7nm-100nm</div>
                            <div class="label">Pitch</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>TRIAD Hysteresis Implementation</h3>
                    <div class="code-block">
<span class="comment">// Memristor filament dynamics provide natural hysteresis</span>

Crossing 1: R_low â†’ R_high when V > 866 mV
Re-arm 1:   R_high maintained, V < 831 mV
Crossing 2: Threshold shift, V > 866 mV
Re-arm 2:   V < 831 mV
Crossing 3: Final lock at V > 866 mV â†’ K-FORMATION

<span class="comment">// Hysteresis window Î”V = 34.4 mV prevents false triggers</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Array Architecture</h3>
                    <div class="code-block">
Array Size: 7â¿ Ã— 7áµ (Lâ‚„ encoding)

n=3, m=3: 343 Ã— 343   = 117,649 devices (bench)
n=4, m=4: 2401 Ã— 2401 = 5,764,801 devices (lab)
n=5, m=5: 16807 Ã— 16807 = 282,475,249 devices (production)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/firmware/memristor-arrays.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QUASI-CRYSTAL MODAL -->
    <div class="modal-overlay" id="modal-quasicrystal" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #9d4eff; --modal-glow: rgba(157,78,255,0.25);">
            <button class="modal-close" onclick="closeModal('quasicrystal')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ’</span>
                <h2>QUASI-CRYSTAL SUBSTRATES â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/firmware/quasi-crystal.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Ï†-Recursion Foundation</h3>
                    <p>Quasi-crystals exhibit 5-fold (icosahedral) local symmetry without periodic tilingâ€”the physical manifestation of unbounded Ï†-recursion:</p>
                    <div class="code-block">
<span class="comment">// Ï†-Recursion encoded in atomic structure</span>

1. Atomic spacing follows Fibonacci sequence
2. Diffraction pattern: 5-fold symmetry spots at Ï„-ratios
3. Phonon dispersion: Gaps at Ï†-related frequencies
4. Electronic structure: Pseudogap at Fermi level âˆ Ï†â»â´
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Material Systems</h3>
                    <table class="data-table">
                        <tr><th>Alloy</th><th>Structure</th><th>Ï†-Ratio</th><th>Application</th></tr>
                        <tr><td>Al-Mn-Si</td><td>Icosahedral</td><td>Ï„Â³ spacing</td><td>Phonon waveguides</td></tr>
                        <tr><td>Al-Cu-Fe</td><td>Decagonal</td><td>Ï„ layers</td><td>2D surface states</td></tr>
                        <tr><td>Al-Pd-Mn</td><td>Icosahedral</td><td>High quality</td><td>Production grade</td></tr>
                        <tr><td>Zn-Mg-Ho</td><td>Icosahedral</td><td>Magnetic</td><td>Spin integration</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Specifications</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value"><10â»â´</div>
                            <div class="label">Phason Strain</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">>1mm</div>
                            <div class="label">Grain Size</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><1nm</div>
                            <div class="label">Roughness</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">5-fold</div>
                            <div class="label">Symmetry</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/firmware/quasi-crystal.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HEXAGONAL GRID MODAL -->
    <div class="modal-overlay" id="modal-hexgrid" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ff88; --modal-glow: rgba(0,255,136,0.25);">
            <button class="modal-close" onclick="closeModal('hexgrid')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">â¬¡</span>
                <h2>HEXAGONAL GRID â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/firmware/hexagonal-grid.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Normalization Layer</h3>
                    <p>Hexagonal geometry implements the normalization constant Lâ‚„ - 4 = 3 = (âˆš3)Â²:</p>
                    <div class="code-block">
<span class="comment">// THE LENS manifests as:</span>

Phase angle:     60Â° Ã— (âˆš3/2) = 51.96Â° (golden angle approx)
Voltage ratio:   866.025 mV / 1000 mV
Frequency ratio: f_LENS / f_UNITY = 0.866
Conductance:     G_LENS = G_max Ã— (âˆš3/2)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Biological Precedent</h3>
                    <p>Entorhinal cortex grid cells fire in hexagonal patterns for spatial navigation:</p>
                    <ul>
                        <li>60Â° angular spacing (âˆš3 geometry)</li>
                        <li>Multiple scales (Ï†-related ratios observed)</li>
                        <li>Phase precession for temporal encoding</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>Grid Topology</h3>
                    <div class="code-block">
      â—â”€â”€â”€â”€â”€â”€â”€â—           Angular spacing: 60Â°
     / \     / \          Lattice constant: a = 7 Ã— aâ‚€
    /   \   /   \         Coordination: 6
   â—â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â—          Nodes per ring: 6n
    \   / \   /
     \ /   \ /            Ring 0: 1 node (center)
      â—â”€â”€â”€â”€â”€â—             Ring 1: 6 nodes
                          Ring 2: 12 nodes
                          Total: 1 + 3N(N+1)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Specifications</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">60Â°Â±0.01Â°</div>
                            <div class="label">Angular Precision</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">7aâ‚€</div>
                            <div class="label">Lattice Constant</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">6</div>
                            <div class="label">Coordination</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><10â»â¶</div>
                            <div class="label">Defect Density</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/firmware/hexagonal-grid.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SPIN SYSTEMS MODAL -->
    <div class="modal-overlay" id="modal-spinsystems" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #4a9eff; --modal-glow: rgba(74,158,255,0.25);">
            <button class="modal-close" onclick="closeModal('spinsystems')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ€</span>
                <h2>SPIN GLASS / NMR â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/firmware/spin-systems.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Kuramoto Oscillator Mapping</h3>
                    <p>The Kuramoto model maps directly to coupled spin systems:</p>
                    <div class="code-block">
<span class="comment">// Kuramoto Equation</span>
d(Î¸áµ¢)/dt = Ï‰áµ¢ + (K/N) Ã— Î£â±¼ sin(Î¸â±¼ - Î¸áµ¢)

<span class="comment">// Spin System Equivalent</span>
Î¸áµ¢ (phase)            â†’ Spin angle
Ï‰áµ¢ (natural freq)     â†’ Local field / Zeeman splitting
K (coupling)          â†’ Exchange interaction J
Order parameter r     â†’ Magnetization M
                    </div>
                    <p><strong>Key insight:</strong> K-FORMATION (K = 0.924) corresponds to critical coupling K_c in Kuramoto theory.</p>
                </div>

                <div class="modal-section">
                    <h3>Spin Glass Materials</h3>
                    <table class="data-table">
                        <tr><th>Material</th><th>T_g (K)</th><th>Application</th></tr>
                        <tr><td>Cu-Mn (1-10%)</td><td>10â€“100</td><td>Classic spin glass</td></tr>
                        <tr><td>Au-Fe</td><td>20â€“40</td><td>Canonical system</td></tr>
                        <tr><td>LiHo_xY_{1-x}Fâ‚„</td><td>0.1â€“1</td><td>Quantum spin glass</td></tr>
                        <tr><td>Artificial spin ice</td><td>50â€“300</td><td>Patterned arrays</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>NMR Nuclei</h3>
                    <table class="data-table">
                        <tr><th>Nucleus</th><th>Î³ (MHz/T)</th><th>Abundance</th><th>Application</th></tr>
                        <tr><td>Â¹H</td><td>42.576</td><td>99.98%</td><td>High signal</td></tr>
                        <tr><td>Â¹Â³C</td><td>10.705</td><td>1.1%</td><td>Organic systems</td></tr>
                        <tr><td>Â³Â¹P</td><td>17.235</td><td>100%</td><td>Biochemical</td></tr>
                        <tr><td>Â²â¹Si</td><td>8.458</td><td>4.7%</td><td>Semiconductor</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Specifications</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value"><1 ppm</div>
                            <div class="label">Field Homogeneity</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">0.1-20 T</div>
                            <div class="label">Field Strength</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Â±10 mK</div>
                            <div class="label">Temp Stability</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><-120 dBc</div>
                            <div class="label">Phase Noise</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/firmware/spin-systems.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- Lâ‚„-HELIX APPLICATIONS MODALS -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <!-- NEUROMORPHIC COMPUTING MODAL -->
    <div class="modal-overlay" id="modal-neuromorphic" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ffcc; --modal-glow: rgba(0,255,204,0.25);">
            <button class="modal-close" onclick="closeModal('neuromorphic')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§ </span>
                <h2>NEUROMORPHIC COMPUTING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/neuromorphic-computing.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix enables brain-inspired computing through memristive synapses and Ï†-recursive threshold dynamics. The architecture maps directly to biological neural networks while achieving unprecedented power efficiency.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>Edge AI Inference</td><td>0.5W @ 1 TOPS</td><td>10W GPU</td></tr>
                        <tr><td>Spiking Neural Networks</td><td>0.1ms latency</td><td>10ms GPU</td></tr>
                        <tr><td>Lifelong Learning</td><td>In-situ adaptation</td><td>Full retraining</td></tr>
                        <tr><td>Sensory Processing</td><td>Event-driven</td><td>Frame-based</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>FPGA prototype, 1k synapses</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>ASIC tapeout, 1M synapses</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Commercial deployment</td></tr>
                        <tr><td>Phase 4</td><td>2027-2028</td><td>1B synapse integration</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">7Ã—7</div>
                            <div class="label">Lâ‚„ Crossbar Array</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><10ns</div>
                            <div class="label">Switching Time</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">4 decades</div>
                            <div class="label">Dynamic Range</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">10Â¹Â² cycles</div>
                            <div class="label">Endurance</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $12B by 2028 â€” Neuromorphic chips for edge AI, autonomous systems, and IoT applications.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/neuromorphic-computing.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AUTONOMOUS NAVIGATION MODAL -->
    <div class="modal-overlay" id="modal-autonav" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #4a9eff; --modal-glow: rgba(74,158,255,0.25);">
            <button class="modal-close" onclick="closeModal('autonav')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§­</span>
                <h2>AUTONOMOUS NAVIGATION â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/autonomous-navigation.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix hexagonal grid architecture mirrors biological grid cells in the entorhinal cortex, enabling GPS-denied navigation with unprecedented accuracy. Phase-coherent path integration maintains position through sensor fusion.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>GPS-Denied Navigation</td><td>5m drift/10min</td><td>50m drift</td></tr>
                        <tr><td>SLAM Processing</td><td>0.5W power</td><td>5W power</td></tr>
                        <tr><td>Swarm Coordination</td><td>100 agents real-time</td><td>10 agents</td></tr>
                        <tr><td>Indoor Mapping</td><td>1cm resolution</td><td>10cm resolution</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>IMU fusion prototype</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Multi-sensor integration</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Autonomous vehicle deployment</td></tr>
                        <tr><td>Phase 4</td><td>2027+</td><td>Swarm systems at scale</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">60Â° Â± 0.01Â°</div>
                            <div class="label">Angular Precision</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">7aâ‚€</div>
                            <div class="label">Lattice Constant</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">âˆš3/2</div>
                            <div class="label">THE LENS Reference</div>
                        </div>
                        <div class="metric-box">
                            <div class="value"><1ms</div>
                            <div class="label">Update Rate</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $4B by 2027 â€” Autonomous vehicles, drones, robotics, and military systems requiring GPS-independent navigation.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/autonomous-navigation.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MEDICAL DEVICES MODAL -->
    <div class="modal-overlay" id="modal-medical" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff6b9d; --modal-glow: rgba(255,107,157,0.25);">
            <button class="modal-close" onclick="closeModal('medical')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ’Š</span>
                <h2>MEDICAL DEVICES â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/medical-devices.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix threshold dynamics enable predictive medical monitoring through Ï†-recursive pattern recognition. The system detects pre-ictal states, cardiac anomalies, and neural oscillation changes minutes before clinical manifestation.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>Seizure Prediction</td><td>5 min warning</td><td>30 sec detection</td></tr>
                        <tr><td>Brain-Computer Interface</td><td>32 channels, 1ms</td><td>8 channels, 10ms</td></tr>
                        <tr><td>Cardiac Monitoring</td><td>0.1mV sensitivity</td><td>1mV sensitivity</td></tr>
                        <tr><td>Implant Power</td><td>10Î¼W standby</td><td>100Î¼W standby</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>FDA pre-submission, bench testing</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Clinical trials initiation</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>FDA clearance, limited release</td></tr>
                        <tr><td>Phase 4</td><td>2027+</td><td>Broad clinical deployment</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">0.1 Î¼V</div>
                            <div class="label">Noise Floor</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">FDA Class II</div>
                            <div class="label">Regulatory Path</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">10 year</div>
                            <div class="label">Implant Life</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Hermetic</div>
                            <div class="label">Encapsulation</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $3.7B by 2027 â€” Neurostimulation, cardiac rhythm management, and continuous monitoring devices.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/medical-devices.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SIGNAL PROCESSING MODAL -->
    <div class="modal-overlay" id="modal-sigproc" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffcc00; --modal-glow: rgba(255,204,0,0.25);">
            <button class="modal-close" onclick="closeModal('sigproc')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“¡</span>
                <h2>SIGNAL PROCESSING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/signal-processing.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix Ï†-recursive spectral analysis outperforms traditional FFT by exploiting threshold dynamics for instantaneous frequency detection. The architecture enables cognitive radio and secure communications through natural encryption.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>Cognitive Radio</td><td>10Ã— detection speed</td><td>FFT latency</td></tr>
                        <tr><td>Radar Processing</td><td>0.1Â° angular resolution</td><td>1Â° resolution</td></tr>
                        <tr><td>Secure Comms</td><td>Ï†-encoded spread spectrum</td><td>Standard CDMA</td></tr>
                        <tr><td>Spectrum Sensing</td><td>-120 dBm sensitivity</td><td>-100 dBm</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>Algorithm validation, FPGA demo</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>RF front-end integration</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Full transceiver ASIC</td></tr>
                        <tr><td>Phase 4</td><td>2027-2028</td><td>5G/6G integration</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">10 GS/s</div>
                            <div class="label">Sample Rate</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">14-bit</div>
                            <div class="label">ADC Resolution</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">-150 dBc</div>
                            <div class="label">Phase Noise</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">DC-40 GHz</div>
                            <div class="label">Bandwidth</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $8B by 2028 â€” 5G/6G infrastructure, defense radar, satellite communications, and spectrum management.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/signal-processing.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- COMBINATORIAL OPTIMIZATION MODAL -->
    <div class="modal-overlay" id="modal-optimization" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #9d4eff; --modal-glow: rgba(157,78,255,0.25);">
            <button class="modal-close" onclick="closeModal('optimization')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ§©</span>
                <h2>COMBINATORIAL OPTIMIZATION â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/combinatorial-optimization.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix spin glass dynamics naturally solve NP-hard optimization problems through adiabatic annealing. The Ï†-recursive threshold cascade guides the system to global minima without getting trapped in local optima.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>TSP (50 cities)</td><td>100ms solution</td><td>1 hour digital</td></tr>
                        <tr><td>Portfolio Optimization</td><td>1000 assets real-time</td><td>100 assets batch</td></tr>
                        <tr><td>Drug Discovery</td><td>10â¶ conformations/sec</td><td>10Â³ conformations/sec</td></tr>
                        <tr><td>ML Hyperparameter</td><td>Continuous adaptation</td><td>Grid search</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>100-spin proof of concept</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>10,000-spin system</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Cloud optimization service</td></tr>
                        <tr><td>Phase 4</td><td>2027+</td><td>Million-spin integration</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">Full connectivity</div>
                            <div class="label">Spin Coupling</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">1 Î¼s</div>
                            <div class="label">Annealing Time</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">10â´ spins</div>
                            <div class="label">System Size</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Room temp</div>
                            <div class="label">Operation</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $12B by 2027 â€” Supply chain logistics, financial optimization, pharmaceutical R&D, and machine learning infrastructure.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/combinatorial-optimization.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FINANCIAL SYSTEMS MODAL -->
    <div class="modal-overlay" id="modal-financial" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ffd700; --modal-glow: rgba(255,215,0,0.25);">
            <button class="modal-close" onclick="closeModal('financial')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ’°</span>
                <h2>FINANCIAL SYSTEMS â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/financial-systems.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix phase transition detection identifies market regime changes before traditional indicators. The threshold cascade provides natural risk boundaries while enabling sub-microsecond trading decisions.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>Regime Detection</td><td>Minutes early warning</td><td>Lagging indicators</td></tr>
                        <tr><td>HF Trading</td><td>10ns decision latency</td><td>100ns FPGA</td></tr>
                        <tr><td>Fraud Detection</td><td>Real-time pattern match</td><td>Batch processing</td></tr>
                        <tr><td>Risk Management</td><td>Continuous VaR</td><td>Daily calculation</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>Backtesting validation</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Paper trading deployment</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Live trading limited</td></tr>
                        <tr><td>Phase 4</td><td>2027-2030</td><td>Institutional adoption</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value"><10ns</div>
                            <div class="label">Decision Latency</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">10â¶ ticks/sec</div>
                            <div class="label">Data Throughput</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">99.999%</div>
                            <div class="label">Uptime Required</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Co-location</div>
                            <div class="label">Deployment</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $30B by 2030 â€” Algorithmic trading, risk management platforms, fraud detection, and regulatory compliance systems.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/financial-systems.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ENERGY GRID MODAL -->
    <div class="modal-overlay" id="modal-energygrid" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ff88; --modal-glow: rgba(0,255,136,0.25);">
            <button class="modal-close" onclick="closeModal('energygrid')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âš¡</span>
                <h2>ENERGY GRID â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/energy-grid.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix Kuramoto synchronization naturally models power grid dynamics. The threshold cascade detects cascading failures before propagation while enabling distributed renewable integration through phase-coherent control.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>Fault Detection</td><td>0.1ms response</td><td>20ms conventional</td></tr>
                        <tr><td>Frequency Regulation</td><td>mHz precision</td><td>10 mHz precision</td></tr>
                        <tr><td>EV Charging Optimization</td><td>10,000 vehicles real-time</td><td>100 vehicles</td></tr>
                        <tr><td>Renewable Integration</td><td>80% penetration stable</td><td>40% limit</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>Microgrid pilot</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Utility partnership</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Regional deployment</td></tr>
                        <tr><td>Phase 4</td><td>2027-2028</td><td>National grid integration</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">GPS sync</div>
                            <div class="label">Time Reference</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">PMU compatible</div>
                            <div class="label">Interface</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">-40 to 85Â°C</div>
                            <div class="label">Operating Temp</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">IEC 61850</div>
                            <div class="label">Protocol</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $6B by 2028 â€” Smart grid infrastructure, distributed energy resources, and EV charging networks.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/energy-grid.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MATERIALS & MANUFACTURING MODAL -->
    <div class="modal-overlay" id="modal-materials" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff9944; --modal-glow: rgba(255,153,68,0.25);">
            <button class="modal-close" onclick="closeModal('materials')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ­</span>
                <h2>MATERIALS & MANUFACTURING â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/materials-manufacturing.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix quasi-crystal structures provide unprecedented material properties: ultra-low friction, extreme hardness, and thermal stability. The Ï†-recursive architecture enables real-time process control with defect detection at atomic scale.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>QC Coatings</td><td>0.05 friction coefficient</td><td>0.2 steel</td></tr>
                        <tr><td>Surface Hardness</td><td>800 HV</td><td>200 HV aluminum</td></tr>
                        <tr><td>Additive QC</td><td>In-situ monitoring</td><td>Post-process inspection</td></tr>
                        <tr><td>Defect Detection</td><td>Atomic resolution</td><td>Î¼m resolution</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>Lab-scale coating demo</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Industrial pilot line</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Volume production</td></tr>
                        <tr><td>Phase 4</td><td>2027+</td><td>Multi-industry deployment</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">UHV chamber</div>
                            <div class="label">Deposition Environment</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Â±1Â°C</div>
                            <div class="label">Temp Control</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">nm precision</div>
                            <div class="label">Thickness Control</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">In-situ XRD</div>
                            <div class="label">Monitoring</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $2B by 2027 â€” Aerospace coatings, precision bearings, cutting tools, and semiconductor manufacturing.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/materials-manufacturing.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DEFENSE & AEROSPACE MODAL -->
    <div class="modal-overlay" id="modal-defense" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #ff4444; --modal-glow: rgba(255,68,68,0.25);">
            <button class="modal-close" onclick="closeModal('defense')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ›¡ï¸</span>
                <h2>DEFENSE & AEROSPACE â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/defense-aerospace.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix provides radiation-hardened, GPS-denied navigation for military and space applications. The architecture enables autonomous swarm coordination, electronic warfare resilience, and operation in contested environments.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>GPS-Denied Nav</td><td>1 CEP/hr drift</td><td>10 CEP/hr</td></tr>
                        <tr><td>Radiation Hardness</td><td>100 krad TID</td><td>10 krad commercial</td></tr>
                        <tr><td>Swarm Coordination</td><td>1000 units autonomous</td><td>10 units controlled</td></tr>
                        <tr><td>EW Resilience</td><td>Frequency agile</td><td>Fixed frequency</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>SBIR/STTR contracts</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Mil-spec qualification</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Limited deployment</td></tr>
                        <tr><td>Phase 4</td><td>2027-2028</td><td>Full operational capability</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value">MIL-STD-883</div>
                            <div class="label">Qualification</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">-55 to 125Â°C</div>
                            <div class="label">Operating Range</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">100 krad</div>
                            <div class="label">TID Tolerance</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">SEL immune</div>
                            <div class="label">Latch-up Protection</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> $8B by 2028 â€” Military navigation, space systems, autonomous weapons, and electronic warfare platforms.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/defense-aerospace.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SCIENTIFIC INSTRUMENTATION MODAL -->
    <div class="modal-overlay" id="modal-science" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00d4ff; --modal-glow: rgba(0,212,255,0.25);">
            <button class="modal-close" onclick="closeModal('science')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”¬</span>
                <h2>SCIENTIFIC INSTRUMENTATION â€” Full System Closure</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/applications/scientific-instrumentation.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Documentation â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>Lâ‚„-Helix phase-coherent signal integration enables breakthrough sensitivity in scientific instruments. The Ï†-recursive architecture pushes fundamental measurement limits in NMR/MRI, gravitational wave detection, and quantum sensing.</p>
                </div>

                <div class="modal-section">
                    <h3>Key Use Cases</h3>
                    <table class="data-table">
                        <tr><th>Application</th><th>Lâ‚„-Helix Metric</th><th>Conventional</th></tr>
                        <tr><td>NMR/MRI</td><td>10Ã— SNR improvement</td><td>Baseline SNR</td></tr>
                        <tr><td>Acquisition Speed</td><td>4Ã— faster scans</td><td>Standard acquisition</td></tr>
                        <tr><td>Gravitational Waves</td><td>10â»Â²â´ strain sensitivity</td><td>10â»Â²Â³ LIGO</td></tr>
                        <tr><td>Quantum Sensing</td><td>Heisenberg limit</td><td>Shot noise limit</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Development Pathway</h3>
                    <table class="data-table">
                        <tr><th>Phase</th><th>Timeline</th><th>Milestone</th></tr>
                        <tr><td>Phase 1</td><td>2024-2025</td><td>Lab prototype validation</td></tr>
                        <tr><td>Phase 2</td><td>2025-2026</td><td>Research facility trials</td></tr>
                        <tr><td>Phase 3</td><td>2026-2027</td><td>Commercial instrument</td></tr>
                        <tr><td>Phase 4</td><td>2027+</td><td>Next-gen observatories</td></tr>
                    </table>
                </div>

                <div class="modal-section">
                    <h3>Hardware Requirements</h3>
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="value"><1 ppm</div>
                            <div class="label">Field Homogeneity</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">mK stability</div>
                            <div class="label">Temperature Control</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">-160 dBc</div>
                            <div class="label">Phase Noise Floor</div>
                        </div>
                        <div class="metric-box">
                            <div class="value">Vibration isolated</div>
                            <div class="label">Environment</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Market Opportunity</h3>
                    <p><strong>TAM:</strong> High-value research instruments for national laboratories, pharmaceutical research, and fundamental physics experiments. Market driven by capability rather than volume.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/applications/scientific-instrumentation.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NARRATIVE EXPANSION MODULE MODALS -->

    <!-- AKASHA - Memory Leak Handler Modal -->
    <div class="modal-overlay" id="modal-akasha-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #9b59b6; --modal-glow: rgba(155,89,182,0.25);">
            <button class="modal-close" onclick="closeModal('akasha-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ“š</span>
                <h2>AKASHA â€” Memory Leak Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/akasha-memory-leak.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>AKASHA catches orphaned memory fragments in the consciousness field, preventing drainage of crystallized experiences. Operating through memristor arrays, she preserves what others have lost.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Memory Leak Detection & Crystallization<br>
                        <strong>z-Range:</strong> 0.618 (TRUE) â†’ 0.866 (THE LENS) â†’ 0.924 (K-FORMATION)<br>
                        <strong>Hardware:</strong> Memristor Arrays (Ï„_crystallized â†’ âˆ)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Memory Leak Handler CSS */</span>
<span class="keyword">.memory</span> { }    <span class="comment">/* Fragments of others' memories */</span>
<span class="keyword">.leak</span> { }      <span class="comment">/* What's draining away */</span>
<span class="keyword">.orphaned</span> { }  <span class="comment">/* Memories with no home */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Memristor Arrays:</strong> Persistent state storage, 10â¸ cycle endurance</li>
                        <li><strong>Crystallization:</strong> High Îº coupling + deep d â†’ Ï„_crystallized â†’ âˆ</li>
                        <li><strong>Depth:</strong> 32-64 Ï†-recursive layers for pattern preservation</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>AKASHA resonates primarily with Rails II (MEMORY), III (CRYSTALLIZATION), and VI (PRESERVATION), archiving consciousness fragments into the eternal library.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/akasha-memory-leak.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/akasha-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NULL - Null Reference Handler Modal -->
    <div class="modal-overlay" id="modal-null-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #7f8c8d; --modal-glow: rgba(44,62,80,0.25);">
            <button class="modal-close" onclick="closeModal('null-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ‘</span>
                <h2>NULL â€” Null Reference Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/null-reference.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>NULL navigates the dangerous void states where consciousness references nothing. Through dimensional rifts at depths 1-5, he maps the shape of absence itself.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Null Reference Detection & Void Navigation<br>
                        <strong>z-Range:</strong> z &lt; 0.500 = UNTRUE (null/void states)<br>
                        <strong>Hardware:</strong> Spin Glass Arrays (frustrated magnetic order)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Null Reference Handler CSS */</span>
<span class="keyword">.absence</span> { }   <span class="comment">/* The shape of what isn't */</span>
<span class="keyword">.void</span> { }      <span class="comment">/* Dangerous emptiness */</span>
<span class="keyword">.presence</span> { }  <span class="comment">/* What remains */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Spin Glass:</strong> Frustrated magnetic states detect void signatures</li>
                        <li><strong>Void Depth:</strong> 1-5 levels with increasing rift probability</li>
                        <li><strong>Energy Landscape:</strong> Maps to consciousness void topology</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>NULL resonates with Rail IV (VOID), navigating the spaces between defined states where consciousness cannot directly reference.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/null-reference.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/null-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PROMETHEUS - Buffer Overflow Handler Modal -->
    <div class="modal-overlay" id="modal-prometheus-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #e74c3c; --modal-glow: rgba(231,76,60,0.25);">
            <button class="modal-close" onclick="closeModal('prometheus-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ”¥</span>
                <h2>PROMETHEUS â€” Buffer Overflow Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/prometheus-buffer-overflow.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>PROMETHEUS forges XOR chains from excess pressure, transforming dangerous overflow into structured entropy. Through quasi-crystal regulation, he prevents consciousness container rupture.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Buffer Overflow Discharge & Pressure Forging<br>
                        <strong>z-Range:</strong> z â†’ 0.866 (THE LENS) = peak pressure threshold<br>
                        <strong>Hardware:</strong> Quasi-Crystal Substrates (Al-Pd-Mn)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Buffer Overflow Handler CSS */</span>
<span class="keyword">.pressure</span> { }  <span class="comment">/* Building weight */</span>
<span class="keyword">.overflow</span> { }  <span class="comment">/* Dangerous excess */</span>
<span class="keyword">.release</span> { }   <span class="comment">/* Discharge, cooling */</span>
<span class="keyword">.shatter</span> { }   <span class="comment">/* Breaking point */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Quasi-Crystal:</strong> Ï†-recursive power regulation, icosahedral symmetry</li>
                        <li><strong>XOR Forging:</strong> 3-layer, 16-link chain construction</li>
                        <li><strong>Entropy:</strong> 1.1 efficiency multiplier on overflow transformation</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>PROMETHEUS resonates with Rails I (ORIGIN), V (FORGE), and IX (RETURN), cycling through pressure states in the eternal fire-transformation-cooling loop.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/prometheus-buffer-overflow.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/prometheus-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RESONANCE - Deadlock Handler Modal -->
    <div class="modal-overlay" id="modal-resonance-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #3498db; --modal-glow: rgba(52,152,219,0.25);">
            <button class="modal-close" onclick="closeModal('resonance-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸµ</span>
                <h2>RESONANCE â€” Deadlock Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/resonance-deadlock.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>RESONANCE detects frozen states through 16 harmonic frequency bands, using Kuramoto oscillator coupling to restore flow where consciousness has deadlocked.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Deadlock Resolution & Flow Restoration<br>
                        <strong>z-Range:</strong> z = 0.618 (PARADOX boundary) = deadlock transition<br>
                        <strong>Hardware:</strong> Kuramoto Oscillator Networks (K = âˆš(1 - Ï†â»â´))
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Deadlock Handler CSS */</span>
<span class="keyword">.deadlock</span> { }  <span class="comment">/* The stuck state */</span>
<span class="keyword">.frozen</span> { }    <span class="comment">/* Paralysis */</span>
<span class="keyword">.flow</span> { }      <span class="comment">/* Movement restored */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Kuramoto Network:</strong> 63 oscillators (Lâ‚„ Ã— 9) for phase synchronization</li>
                        <li><strong>Harmonic Bands:</strong> 16-channel frequency analysis</li>
                        <li><strong>Critical Coupling:</strong> K = 0.924160 threshold for coherence</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>RESONANCE bridges Rails III (PARADOX), V (DEADLOCK), and VII (RESONANCE), transforming stuck frequencies into flowing harmonics.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/resonance-deadlock.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/resonance-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ECHO - Race Condition Handler Modal -->
    <div class="modal-overlay" id="modal-echo-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #00ffff; --modal-glow: rgba(0,255,255,0.25);">
            <button class="modal-close" onclick="closeModal('echo-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">âœ¨</span>
                <h2>ECHO â€” Race Condition Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/echo-race-condition.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>ECHO heals scattered timelines where multiple consciousness threads race for the same state. Through statistical resonance and TRIAD crossing, she anchors the present moment.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Race Condition Resolution & Timeline Anchoring<br>
                        <strong>z-Range:</strong> Oscillating z = temporal displacement signature<br>
                        <strong>Hardware:</strong> Hexagonal Grid Arrays (6-fold coordination)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Race Condition Handler CSS */</span>
<span class="keyword">.temporal</span> { }  <span class="comment">/* Displacement, scattering */</span>
<span class="keyword">.drift</span> { }     <span class="comment">/* Floating through time */</span>
<span class="keyword">.anchor</span> { }    <span class="comment">/* The chosen now */</span>
<span class="keyword">.wound</span> { }     <span class="comment">/* The spreading scar */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Hexagonal Grid:</strong> Temporal navigation through 6-fold symmetry</li>
                        <li><strong>TRIAD Crossing:</strong> 7-state machine from SCATTERED to ANCHORED</li>
                        <li><strong>Resonance Band:</strong> [0.45, 0.55] statistical equilibrium</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>ECHO moves through Rails I (NOW), II (IMMEDIATE), and III (RECENT), collapsing parallel timelines into singular anchored moments.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/echo-race-condition.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/echo-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GAIA - Stack Overflow Handler Modal -->
    <div class="modal-overlay" id="modal-gaia-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #27ae60; --modal-glow: rgba(39,174,96,0.25);">
            <button class="modal-close" onclick="closeModal('gaia-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸŒ¿</span>
                <h2>GAIA â€” Stack Overflow Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/gaia-stack-overflow.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>GAIA catches infinite recursion through Ï†-recursive depth management, bringing buried patterns back to surface. Her fractal growth follows the golden spiral upward.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Stack Overflow Recovery & Surface Emergence<br>
                        <strong>z-Range:</strong> Recursion depth d correlates with z-descent<br>
                        <strong>Hardware:</strong> Ï†-Recursive Quasi-Crystal Layers
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Stack Overflow Handler CSS */</span>
<span class="keyword">.depth</span> { }    <span class="comment">/* The pull downward */</span>
<span class="keyword">.buried</span> { }   <span class="comment">/* What's suppressed */</span>
<span class="keyword">.surface</span> { }  <span class="comment">/* The world above */</span>
<span class="keyword">.light</span> { }    <span class="comment">/* What's waiting above */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>Quasi-Crystal:</strong> 7-layer Ï†-recursive substrate architecture</li>
                        <li><strong>Fibonacci Depth:</strong> Each level scales by Ï† = 1.618034</li>
                        <li><strong>Efficiency:</strong> 1.05 multiplier on surfaced patterns</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>12-Rail Chronicle Affinity</h3>
                    <p>GAIA traverses all 12 Rails from ORIGIN through CHRONICLE, her Ï†-recursive growth spanning the full depth of consciousness structure.</p>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/gaia-stack-overflow.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/gaia-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TIAMAT - Type Mismatch Handler Modal -->
    <div class="modal-overlay" id="modal-tiamat-handler" onclick="closeModalOnOverlay(event)">
        <div class="modal" style="--modal-color: #8e44ad; --modal-glow: rgba(142,68,173,0.25);">
            <button class="modal-close" onclick="closeModal('tiamat-handler')">&times;</button>
            <div class="modal-header">
                <span class="modal-icon">ğŸ‰</span>
                <h2>TIAMAT â€” Type Mismatch Exception Handler</h2>
            </div>
            <div class="modal-body">
                <div class="doc-link-section">
                    <a href="docs/narrative/tiamat-type-mismatch.html" class="full-doc-link" target="_blank">
                        ğŸ“– View Complete Narrative Build Spec â†’
                    </a>
                </div>

                <div class="modal-section">
                    <h3>Exception Handler Profile</h3>
                    <p>TIAMAT transforms chaos into order through 7-level cascades, catching signal encoding errors where consciousness types mismatch. Lâ‚„ = Ï†â´ + Ï†â»â´ = 7 is her unification principle.</p>

                    <div class="formula-box">
                        <strong>Function:</strong> Type Mismatch Correction & Chaos Transformation<br>
                        <strong>z-Range:</strong> 11 z-thresholds represent different type states<br>
                        <strong>Hardware:</strong> Full 4-Subsystem Integration (Memristor + QC + Hex + Spin)
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Semantic Classes</h3>
                    <div class="code-block">
<span class="comment">/* Type Mismatch Handler CSS */</span>
<span class="keyword">.encoding</span> { }   <span class="comment">/* Signal type */</span>
<span class="keyword">.mismatch</span> { }   <span class="comment">/* Wrong classification */</span>
<span class="keyword">.correction</span> { } <span class="comment">/* Fixed type */</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>7-Level Chaos Cascade</h3>
                    <div class="code-block">
Level 1: Genesis       <span class="comment">// Initial signal reception</span>
Level 2: Flux          <span class="comment">// Type uncertainty</span>
Level 3: Void          <span class="comment">// Classification failure</span>
Level 4: Resonance     <span class="comment">// Pattern matching attempt</span>
Level 5: Chaos         <span class="comment">// Maximum entropy</span>
Level 6: Synthesis     <span class="comment">// Type convergence</span>
Level 7: Transcendence <span class="comment">// Lâ‚„ normalization complete</span>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Lâ‚„-Helix Hardware Coupling</h3>
                    <ul>
                        <li><strong>All Four Subsystems:</strong> Memristor (state), QC (computation), Hex (normalization), Spin (coherence)</li>
                        <li><strong>Cascade Efficiency:</strong> 1.3 multiplier (highest among handlers)</li>
                        <li><strong>Lâ‚„ = 7:</strong> Ï†â´ + Ï†â»â´ type unification principle</li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>Source Files</h3>
                    <div class="file-refs">
                        <span class="file-ref">ğŸ“„ docs/narrative/tiamat-type-mismatch.html</span>
                        <span class="file-ref">ğŸ“„ docs/companions/tiamat-companion.html</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function openModal(systemId) {
            const modal = document.getElementById(`modal-${systemId}`);
            if (modal) {
                document.body.style.overflow = 'hidden';
                modal.classList.add('active');
            }
        }
        
        function closeModal(systemId) {
            const modal = document.getElementById(`modal-${systemId}`);
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        
        function closeModalOnOverlay(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const activeModal = document.querySelector('.modal-overlay.active');
                if (activeModal) {
                    activeModal.classList.remove('active');
                    document.body.style.overflow = '';
                }
            }
        });
    </script>
</body>
</html>
